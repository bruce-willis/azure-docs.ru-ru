---
title: включение файла
description: включение файла
services: virtual-machines
author: shants123
ms.service: virtual-machines
ms.topic: include
ms.date: 07/05/2018
ms.author: shants
ms.custom: include file
ms.openlocfilehash: f203e056df00fb1a9b1e7e43930955040dfce4aa
ms.sourcegitcommit: e0a678acb0dc928e5c5edde3ca04e6854eb05ea6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/13/2018
ms.locfileid: "39030036"
---
Azure периодически выполняет обновления, чтобы повысить надежность, производительность и безопасность инфраструктуры узлов, в которой работают виртуальные машины. Эти обновления бывают разные: от исправлений программных компонентов в среде размещения (например, операционной системы, гипервизора и различных агентов, развернутых на узле) и обновления сетевых компонентов до вывода оборудования из эксплуатации. Большинство этих обновлений не влияют на работу размещенных виртуальных машин. Но в некоторых случаях они все же оказывают определенное воздействие:

- Если возможно обновление без перезагрузки, Azure использует режим обслуживания с сохранением памяти, чтобы приостановить виртуальную машину во время обновления узла или ее полном перемещении на уже обновленный узел.

- Если для обслуживания требуется перезагрузка, вы получите уведомление во время планирования обслуживания. В таких случаях вам будет предоставлена возможность начать обслуживание самостоятельно в удобное для вас время.

На этой странице описано, как Microsoft Azure выполняет обслуживание обоих типов. Дополнительные сведения о внеплановых событиях (простоях) см. в статьях об управлении доступностью виртуальных машин [Windows](../articles/virtual-machines/windows/manage-availability.md) и [Linux](../articles/virtual-machines/linux/manage-availability.md).

Приложения, работающие на виртуальной машине, могут собирать сведения о предстоящих обновлениях с помощью службы метаданных Azure для [Windows](../articles/virtual-machines/windows/instance-metadata-service.md) или [Linux](../articles/virtual-machines/linux/instance-metadata-service.md).

Дополнительные сведения об управлении плановым обслуживанием см. в статье об обработке уведомлений о плановом обслуживании для [Linux](../articles/virtual-machines/linux/maintenance-notifications.md) или [Windows](../articles/virtual-machines/windows/maintenance-notifications.md).

## <a name="memory-preserving-maintenance"></a>Обслуживание с сохранением памяти

Если для обновлений не требуется полная перезагрузка, чтобы ограничить влияние на виртуальную машину, используются механизмы обслуживания с сохранением памяти. Виртуальная машина приостанавливается до 30 секунд, сохраняя память в ОЗУ, а в среде размещения применяются необходимые обновления и исправления либо виртуальная машина перемещается в уже обновленный узел. Затем работа виртуальной машины возобновляется, а ее часы автоматически синхронизируются. 

Эти операции обслуживания, не требующие перезагрузки, выполняются по доменам сбоя, и их выполнение будет прервано, если будет получено предупреждение о проблемах с работоспособностью.

Эти обновления могут влиять на некоторые приложения. Для приложений, которые выполняют обработку событий в режиме реального времени, перекодирование или потоковую передачу мультимедиа либо требуют высокой пропускной способности, 30-секундная пауза может быть недопустимой. <!-- sooooo, what should they do? --> Если виртуальная машина перемещается на другой узел, для некоторых чувствительных рабочих нагрузок может наблюдаться небольшое снижение производительности в течение нескольких минут, что приводит к приостановке работы виртуальной машины. 


## <a name="maintenance-requiring-a-reboot"></a>Обслуживание, требующее перезагрузки

Если виртуальные машины необходимо перезагрузить при плановом обслуживании, вы получите сообщение заранее. Плановое обслуживание выполняется в два этапа: период самообслуживания и период запланированного обслуживания.

**Период самообслуживания** позволяет вам инициировать обслуживание на виртуальных машинах. В течение этого времени вы можете отправить запрос на каждую виртуальную машину, чтобы оценить ее состояние и проверить результат последнего запроса на обслуживание.

При запуске самообслуживания виртуальная машина перемещается в узел, который уже обновлен, а затем снова включается. Так как виртуальная машина перезапускается, временный диск удаляется, а связанные с виртуальным сетевым интерфейсом динамические IP-адреса обновляются.

Если во время запуска самообслуживания происходит ошибка, операция приостанавливается, виртуальная машина не обновляется, а вы получаете возможность повторить попытку самообслуживания. 

Когда заканчивается период самообслуживания, начинается **запланированный период обслуживания**. В течение этого времени вы все еще можете запрашивать период обслуживания, но вы не сможете инициировать обслуживание самостоятельно.

Сведения об управлении обслуживанием, которое требует перезагрузки, см. в статье об обработке уведомлений о плановом обслуживании для [Linux](../articles/virtual-machines/linux/maintenance-notifications.md) или [Windows](../articles/virtual-machines/windows/maintenance-notifications.md). 

### <a name="availability-considerations-during-scheduled-maintenance"></a>Рекомендации по обеспечению доступности во время запланированного обслуживания 

Если вы решили дождаться запланированного периода обслуживания, чтобы обеспечить наивысшую доступность своих виртуальных машин, нужно учесть несколько факторов. 

#### <a name="paired-regions"></a>Пары регионов

Каждый регион Azure связывается с другим регионом в пределах той же географической территории, формируя пару регионов. Во время запланированного обслуживания Azure обновляет виртуальные машины только в одном регионе из пары. Например, при обновлении виртуальных машин в центрально-северной части США Azure не будет одновременно обновлять виртуальные машины в центрально-южной части США. Однако в других регионах, например в Северной Европе, обслуживание может происходить одновременно с обслуживанием в восточной части США. Чтобы лучше распределить виртуальные машины по регионам, ознакомьтесь с принципами работы пар регионов. Дополнительные сведения см. в статье [Непрерывность бизнес-процессов и аварийное восстановление в службах BizTalk: пары регионов Azure](https://docs.microsoft.com/azure/best-practices-availability-paired-regions).

#### <a name="availability-sets-and-scale-sets"></a>Группы доступности и масштабируемые наборы

При развертывании рабочей нагрузки на виртуальных машинах Azure вы можете создать виртуальные машины в группе доступности, чтобы обеспечить высокую доступность приложения. Это обеспечит доступность по крайней мере одной виртуальной машины во время обслуживания с перезагрузкой или при сбое.

Отдельные виртуальные машины в группе доступности могут быть распределены максимум между 20 доменами обновления. Во время запланированного обслуживания в конкретный момент времени всегда затрагивается только один домен обновления. Обратите внимание, что изменения в доменах обновления не всегда происходят последовательно. 

Масштабируемые наборы виртуальных машин относятся к вычислительным ресурсам Azure, которые позволяют развертывать и администрировать идентичные виртуальные машины как единый ресурс. Масштабируемый набор автоматически развертывается в доменах обновления, как и виртуальные машины в группе доступности. Как и группа доступности, в конкретный момент времени в процессе запланированного обслуживания масштабируемый набор развертывается только в одном домене обновления.

Дополнительные сведения о настройке виртуальных машин для обеспечения высокой доступности см. в соответсвующих статьях для [Windows](../articles/virtual-machines/windows/manage-availability.md) и [Linux](../articles/virtual-machines/linux/manage-availability.md).
