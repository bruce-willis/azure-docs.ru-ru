---
title: включение файла
description: включение файла
services: virtual-machines
author: roygara
ms.service: virtual-machines
ms.topic: include
ms.date: 06/03/2018
ms.author: rogarana
ms.custom: include file
ms.openlocfilehash: 617f60345fb2a349eddb0db697604ba383794591
ms.sourcegitcommit: 715813af8cde40407bd3332dd922a918de46a91a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2018
ms.locfileid: "47060669"
---
# <a name="azure-managed-disks-overview"></a>Обзор компонента "Управляемые диски" Azure

Компонент "Управляемые диски" Azure упрощает управление дисками виртуальных машин Azure IaaS. Он управляет [учетными записями хранения](../articles/storage/common/storage-introduction.md), связанными с этими дисками. Вам нужно лишь выбрать тип диска, то есть [HDD (цен. категория "Стандартный")](../articles/virtual-machines/windows/standard-storage.md), [SSD (цен. категория "Стандартный")](../articles/virtual-machines/windows/disks-standard-ssd.md) или [SSD (цен. категория "Премиум")](../articles/virtual-machines/windows/premium-storage.md), указать его размер, а затем Azure автоматически создаст диск и возьмет на себя управление им.

## <a name="benefits-of-managed-disks"></a>Преимущества управляемых дисков

Давайте рассмотрим некоторые преимущества, которые можно получить с помощью управляемых дисков. Начнем с видео Channel 9 [Better Azure VM Resiliency with Managed Disks](https://channel9.msdn.com/Blogs/Azure/Managed-Disks-for-Azure-Resiliency) (Улучшение устойчивости виртуальных машин Azure с помощью Управляемых дисков).
<br/>
> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Managed-Disks-for-Azure-Resiliency/player]

### <a name="simple-and-scalable-vm-deployment"></a>Простое и масштабируемое развертывание виртуальной машины

Компонент "Управляемые диски" управляет хранилищем в фоновом режиме. Чтобы хранить диски (VHD-файлы) для виртуальных машин Azure, раньше приходилось создавать учетные записи хранения. При выполнении масштабирования нужно было создавать дополнительные учетные записи хранения, чтобы не превысить предел операций ввода-вывода в секунду для дисков. При использовании хранилища, которое управляется с помощью компонента "Управляемые диски", ограничения для учетной записи хранения (например, 20 000 операций ввода-вывода в секунду на учетную запись) отсутствуют. Больше не требуется копировать пользовательские образы (VHD-файлы) в несколько учетных записей хранения. Вы можете управлять ими в одной учетной записи хранения на каждый регион Azure и использовать их для создания сотен виртуальных машин в одной подписке.

При использовании компонента "Управляемые диски" можно создавать до 50 000 **дисков** виртуальных машин определенного типа в подписке на регион, что дает возможность создавать тысячи **виртуальных машин** в пределах одной подписки. Этот компонент также повышает масштабируемость [масштабируемых наборов виртуальных машин](../articles/virtual-machine-scale-sets/virtual-machine-scale-sets-overview.md), позволяя создавать до тысячи виртуальных машин в масштабируемом наборе виртуальных машин с помощью образа Marketplace.

### <a name="better-reliability-for-availability-sets"></a>Повышенная надежность групп доступности

Компонент "Управляемые диски" обеспечивает более высокую надежность групп доступности. При его использовании диски разных [виртуальных машин в группе доступности](../articles/virtual-machines/windows/manage-availability.md#use-managed-disks-for-vms-in-an-availability-set) достаточно изолированы друг от друга, что позволяет избежать одиночных точек сбоя. Диски автоматически размещаются в разных единицах масштабирования хранилища (метках). В случае сбоя стека из-за проблем с оборудованием или программным обеспечением выйдет из строя только тот экземпляр виртуальной машины, диски которой расположены в этом стеке. Предположим, есть приложение, запущенное на пяти виртуальных машинах, расположенных в одной группе доступности. Диски этих виртуальных машин не хранятся в одном стеке, поэтому если один стек выйдет из строя, другие экземпляры приложения продолжат работу.

### <a name="highly-durable-and-available"></a>Высокая устойчивость и доступность

Диски Azure обеспечивают доступность на уровне 99,999 %. Благодаря наличию трех реплик, обеспечивающих надежность, ваши данные всегда в безопасности. При сбое одной реплики можно задействовать остальные, что гарантирует длительное хранение данных и высокую устойчивость к сбоям. Эта архитектура позволила Azure гарантировать надежность дисков IaaS корпоративного уровня с ведущим в отрасли нулевым показателем процента брака по итогам продаж в течение одного года. 

### <a name="granular-access-control"></a>Детальный контроль доступа

Вы можете использовать [управление доступом на основе ролей в Azure](../articles/role-based-access-control/overview.md), чтобы назначить определенные разрешения на управляемые диски одному или нескольким пользователям. Компонент "Управляемые диски" позволяет выполнять различные операции, в том числе чтение, запись (создание или обновление), удаление и извлечение [универсального кода ресурса (URI) подписанного URL-адреса (SAS) ](../articles/storage/common/storage-dotnet-shared-access-signature-part-1.md) для диска. Вы можете предоставить пользователям доступ только к тем операциям, которые необходимы им для выполнения определенного задания. Если вы не хотите, чтобы пользователь имел возможность копировать управляемые диски в учетную запись хранения, можно не предоставлять ему доступ к действию экспорта для этого управляемого диска. Если вы не хотите, чтобы пользователь использовал URI SAS для копирования управляемого диска, можно не предоставлять ему такое разрешение для этого диска.

### <a name="azure-backup-service-support"></a>Поддержка службы архивации Azure

Используйте службу Azure Backup для компонента "Управляемые диски", чтобы создать задание резервного копирования с учетом времени, политики хранения резервных копий и выполнять быстрое восстановление виртуальной машины. Компонент "Управляемые диски" в качестве средства репликации поддерживает только локально избыточное хранилище (LRS). В одном регионе хранятся три копии данных. Для регионального аварийного восстановления необходимо создать резервную копию дисков виртуальной машины в другом регионе с использованием [службы Azure Backup](../articles/backup/backup-introduction-to-azure-backup.md) и учетной записи хранения GRS в качестве резервного хранилища. Служба Azure Backup сейчас поддерживает диски размером до 4 ТБ. Вам нужно [обновить стек резервного копирования виртуальных машин до версии 2](../articles/backup/backup-upgrade-to-vm-backup-stack-v2.md), чтобы обеспечить поддержку дисков емкостью 4 ТБ. Дополнительные сведения см. в разделе [Использование службы архивации Azure для виртуальных машин, запущенных на управляемых дисках](../articles/backup/backup-introduction-to-azure-backup.md#using-managed-disk-vms-with-azure-backup).

## <a name="pricing-and-billing"></a>Цены и выставление счетов

При использовании компонента "Управляемые диски" счета выставляются за следующее:

* тип хранилища;

* Размер диска

* количество транзакций;

* Передача исходящих данных

* моментальные снимки управляемого диска (полная копия диска).

Рассмотрим эти пункты подробнее.

**Тип хранилища.** Управляемые диски сейчас поддерживают три уровня производительности: [HDD (цен. категория "Стандартный")](../articles/virtual-machines/windows/standard-storage.md), [SSD (цен. категория "Стандартный")](../articles/virtual-machines/windows/disks-standard-ssd.md) и [ценовую категорию "Премиум"](../articles/virtual-machines/windows/premium-storage.md). Плата, взимаемая за использование управляемых дисков, зависит от того, какой тип хранилища выбран для диска.

**Размер диска.** Выставление счета за использование управляемых дисков зависит от размера подготовленного диска. Служба Azure сопоставляет размер подготовленного диска (округленный) с ближайшим вариантом управляемого диска, как указано в таблице ниже. Каждый диск сопоставляется с одним из поддерживаемых подготовленных размеров, и за него выставляются соответствующие счета. Например, если создать управляемый диск класса Standard и указать подготавливаемый размер 200 ГБ, будет выставлен счет согласно цене диска типа S15.

Ниже приведены размеры для управляемых дисков класса Premium.

| **Управляемые диски HDD (цен. категория "Премиум") <br>Тип диска** | **P4** | **P6** | **P10** | **P15** | **P20** | **P30** | **P40** | **P50** | **P60** | **P70** | **P80** |
|------------------|---------|---------|--------|--------|--------|----------------|----------------|----------------|----------------|----------------|----------------|
| Размер диска        | 32 Гиб  | 64 Гиб  | 128 ГБ | 256 Гиб | 512 ГБ | 1024 Гиб (1 ТиБ) | 2048 Гиб (2 ТиБ) | 4095 Гиб (4 ТиБ) | 8192 Гиб (8 ТиБ) | 16 384 ГиБ (16 ТиБ) | 32 767 Гиб (32 Тиб) |

Ниже приведены размеры для управляемых дисков SSD уровня "Стандартный".

| **Тип управляемого диска SSD <br>уровня "Стандартный"** | **E10** | **E15** | **E20** | **E30** | **E40** | **E50** | **E60** | **E70** | **E80** |
|------------------|--------|--------|--------|----------------|----------------|----------------|----------------|----------------|----------------|
| Размер диска        | 128 ГБ | 256 Гиб | 512 ГБ | 1024 Гиб (1 ТиБ) | 2048 Гиб (2 ТиБ) | 4095 Гиб (4 ТиБ) | 8192 Гиб (8 ТиБ) | 16 384 ГиБ (16 ТиБ) | 32 767 Гиб (32 Тиб) |

Ниже приведены размеры для управляемых дисков HDD уровня "Стандартный".

| **Тип управляемых дисков HDD <br>уровня "Стандартный"** | **S4** | **S6** | **S10** | **S15** | **S20** | **S30** | **S40** | **S50** | **S60** | **S70** | **S80** |
|------------------|---------|---------|--------|--------|--------|----------------|----------------|----------------|----------------|----------------|----------------|
| Размер диска        | 32 Гиб  | 64 Гиб  | 128 ГБ | 256 Гиб | 512 ГБ | 1024 Гиб (1 ТиБ) | 2048 Гиб (2 ТиБ) | 4095 Гиб (4 ТиБ) | 8192 Гиб (8 ТиБ) | 16 384 ГиБ (16 ТиБ) | 32 767 Гиб (32 Тиб) |

**Число транзакций.** Счет выставляется за количество транзакций, выполняемых на управляемом диске класса Standard.

Диски SSD уровня "Стандартный" используют размер блока ввода-вывода, равный 256 КБ. Если размер передаваемых данных меньше 256 КБ, они считаются одной единицей операции ввода-вывода. Данные большего размера подсчитываются путем сложения размеров нескольких единиц операций ввода-вывода по 256 КБ. Например, данные операции ввода-вывода размером 1100 КБ считаются пятью единицами операций ввода-вывода.

Плата за транзакции, выполняемые на управляемых дисках класса Premium, не взимается.

**Передача исходящих данных.** [Передача исходящих данных](https://azure.microsoft.com/pricing/details/data-transfers/) (данные, передаваемые из центров обработки данных Azure) учитывается при определении платы за используемую пропускную способность.

Дополнительные сведения о ценах на компонент "Управляемые диски" см. на [этой странице](https://azure.microsoft.com/pricing/details/managed-disks).


## <a name="managed-disk-snapshots"></a>Моментальные снимки управляемых дисков

Управляемый моментальный снимок — это полная копия управляемого диска, предназначенная только для чтения и по умолчанию хранимая в качестве управляемого диска уровня "Стандартный". С помощью моментальных снимков можно архивировать управляемые диски на любой момент времени. Эти моментальные снимки могут существовать независимо от исходного диска и использоваться для создания других управляемых дисков. Плата за них взимается в зависимости от используемого размера. Например, если создается моментальный снимок управляемого диска с подготовленной емкостью 64 Гиб и фактическим объемом используемых данных 10 Гиб, оплачиваются только используемые данные (10 Гиб).  

В настоящее время [добавочные моментальные снимки](../articles/virtual-machines/windows/incremental-snapshots.md) для управляемых дисков не поддерживаются.

Дополнительные сведения о создании моментальных снимков с помощью компонента "Управляемые диски" см. в следующих статьях:

* [Создание копии диска VHD, хранящегося в виде управляемого диска, с использованием моментальных снимков в Windows](../articles/virtual-machines/windows/snapshot-copy-managed-disk.md)
* [Создание копии диска VHD, хранящегося в виде управляемого диска, с использованием моментальных снимков в Linux](../articles/virtual-machines/linux/snapshot-copy-managed-disk.md)

## <a name="images"></a>Образы

Компонент "Управляемые диски" также поддерживает создание управляемых пользовательских образов. Вы можете создать образ из пользовательского VHD-файла в учетной записи хранения или непосредственно из обобщенной (подготовленной с помощью программы sysprep) виртуальной машины. В одном образе сохраняются все управляемые диски, связанные с виртуальной машиной, включая диски операционной системы и диски данных. Таким образом, вы можете создавать сотни виртуальных машин с помощью пользовательского образа без необходимости копировать все учетные записи хранения или управлять ими.

Дополнительные сведения о создании образов см. в следующих статьях:

* [How to capture a managed image of a generalized VM in Azure](../articles/virtual-machines/windows/capture-image-resource.md) (Как создать управляемый образ обобщенной виртуальной машины в Azure)
* [Как генерализовать и создать образ виртуальной машины Linux при помощи Azure CLI](../articles/virtual-machines/linux/capture-image.md)

## <a name="images-versus-snapshots"></a>Образы и моментальные снимки

Часто вместе со словом "виртуальная машина" используется слово "образ". Далее в тексте также будет использоваться термин "моментальный снимок". Важно понять разницу между этими терминами. При использовании компонента "Управляемые диски" можно создать образ освобожденной обобщенной виртуальной машины. Этот образ будет содержать все диски, присоединенные к виртуальной машине. Его можно использовать для создания новой виртуальной машины, которая также будет содержать все диски.

Моментальный снимок — это копия диска на определенный момент времени. Он применяется только к одному диску. При наличии виртуальной машины, которая имеет только один диск (диск операционной системы), можно создать моментальный снимок или образ, а затем на основе одного из них создать виртуальную машину.

Что делать, если есть виртуальная машина с пятью дисками, которые чередуются? Вы можете создать моментальный снимок каждого диска, но виртуальная машина не будет осведомлена о состоянии других дисков. Для моментальных снимков доступны сведения только об одном диске. В этом случае моментальным снимкам потребуется взаимная координация, что в настоящее время не поддерживается.

## <a name="managed-disks-and-encryption"></a>Компонент "Управляемые диски" и шифрование

Управляемые диски предусматривают два вида шифрования. Первый из них — это шифрование службы хранилища (SSE), которое выполняет служба хранилища, второй — шифрование дисков Azure, которые можно включить на дисках операционной системы и данных для виртуальных машин.

### <a name="storage-service-encryption-sse"></a>шифрования службы хранилища (SSE)

[Шифрование службы хранилища Azure](../articles/storage/common/storage-service-encryption.md) предоставляет возможность шифрования неактивных данных и защищает данные в соответствии с предложениями по безопасности и соответствию вашей организации. Шифрование службы хранилища включено по умолчанию для всех управляемых дисков, моментальных снимков и образов во всех регионах, где доступны управляемые диски. Начиная с 10 июня 2017 года для всех новых управляемых дисков, моментальных снимков, образов и данных, записываемых на имеющиеся управляемые диски, автоматически выполняется шифрование неактивных данных с помощью ключей, управляемых корпорацией Майкрософт по умолчанию. Дополнительные сведения см. в статье [Часто задаваемые вопросы о дисках виртуальных машин Azure IaaS, а также об управляемых и неуправляемых дисках класса "Премиум"](../articles/virtual-machines/windows/faq-for-disks.md#managed-disks-and-storage-service-encryption).

### <a name="azure-disk-encryption-ade"></a>Шифрование дисков Azure

Шифрование дисков Azure позволяет шифровать диски ОС и диски данных, используемые виртуальными машинами IaaS. Шифрование включает в себя управляемые диски. Для Windows диски шифруются с помощью стандартной отраслевой технологии шифрования BitLocker. Для Linux диски шифруются с помощью технологии DM-Crypt. Процесс шифрования интегрируется с Azure Key Vault, что позволяет управлять ключами шифрования дисков. Дополнительные сведения см. в статье [Дисковое шифрование Azure для виртуальных машин IaaS под управлением Windows и Linux](../articles/security/azure-security-disk-encryption.md).

## <a name="next-steps"></a>Дополнительная информация

Дополнительные сведения о компоненте "Управляемые диски" см. в приведенных ниже статьях.

### <a name="get-started-with-managed-disks"></a>Начало работы с компонентом "Управляемые диски"

* [Создание виртуальной машины с помощью Resource Manager и PowerShell](../articles/virtual-machines/scripts/virtual-machines-windows-powershell-sample-create-vm.md)

* [Создание виртуальной машины Linux с нуля с помощью Azure CLI.](../articles/virtual-machines/linux/quick-create-cli.md)

* [Attach a managed data disk to a Windows VM using PowerShell](../articles/virtual-machines/windows/attach-disk-ps.md) (Присоединение управляемого диска данных к виртуальной машине Windows с помощью PowerShell)

* [Добавление управляемого диска к виртуальной машине Linux](../articles/virtual-machines/linux/add-disk.md)

* [Примеры сценариев PowerShell для компонента "Управляемые диски"](https://github.com/Azure-Samples/managed-disks-powershell-getting-started)

* [Using Managed Disks in Azure Resource Manager Templates](../articles/virtual-machines/windows/using-managed-disks-template-deployments.md) (Использование Управляемых дисков в шаблонах Resource Manager).

### <a name="compare-managed-disks-storage-options"></a>Сравнение вариантов хранилищ компонента "Управляемые диски"

* [Диски SSD уровня "Премиум"](../articles/virtual-machines/windows/premium-storage.md)

* [Диски SSD и HDD уровня "Стандартный"](../articles/virtual-machines/windows/standard-storage.md)

### <a name="operational-guidance"></a>Операционное руководство

* [Миграция из AWS и других платформ на управляемые диски Azure](../articles/virtual-machines/windows/on-prem-to-azure.md)

* [Migrate Azure VMs to Managed Disks in Azure](../articles/virtual-machines/windows/migrate-to-managed-disks.md) (Перенос виртуальных машин Azure на управляемые диски Azure)
