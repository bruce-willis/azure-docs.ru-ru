---
title: Сведения о том, как подключить решения для управления обновлениями, отслеживания изменений и инвентаризации в службе автоматизации Azure
description: Сведения о том, как на виртуальной машине Azure подключить решения для управления обновлениями, отслеживания изменений и инвентаризации, входящие в состав службы автоматизации Azure
services: automation
ms.service: automation
author: georgewallace
ms.author: gwallace
ms.date: 06/06/2018
ms.topic: conceptual
manager: carmonm
ms.custom: mvc
ms.openlocfilehash: 5b906b4a90dbceb62c6f2381d0ffa8bc1bee7ef1
ms.sourcegitcommit: 4ecc62198f299fc215c49e38bca81f7eb62cdef3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2018
ms.locfileid: "47033827"
---
# <a name="onboard-update-management-change-tracking-and-inventory-solutions"></a>Подключение решений для управления обновлениями, отслеживания изменений и инвентаризации

Служба автоматизации Azure предоставляет решения для управления обновлениями безопасности операционной системы, отслеживания изменений и инвентаризации компонентов, установленных на компьютерах. Существует несколько способов подключения решений на виртуальных машинах: подключить решение [на одной виртуальной машине](automation-onboard-solutions-from-vm.md), [на нескольких виртуальных машинах](automation-onboard-solutions-from-browse.md) в учетной записи Службы автоматизации или с помощью модуля [runbook](automation-onboard-solutions.md). В этой статье рассматривается подключение таких решений из учетной записи службы автоматизации.

## <a name="log-in-to-azure"></a>Вход в Azure

Войдите в Azure: https://portal.azure.com

## <a name="enable-solutions"></a>включение решений;

Перейдите к своей учетной записи службы автоматизации и в разделе **Управление конфигурацией** выберите элемент **Инвентаризация** или **Отслеживание изменений**.

Чтобы включить решение, выберите рабочую область Log Analytics и учетную запись службы автоматизации, а затем щелкните **Включить**. Процесс включения решения может занять до 15 минут.

![Подключение решения для инвентаризации](media/automation-onboard-solutions-from-automation-account/onboardsolutions.png)

Решение для отслеживания изменений и инвентаризации позволяет [отслеживать изменения](automation-vm-change-tracking.md) и [выполнять инвентаризацию](automation-vm-inventory.md) на виртуальных машинах. На этом этапе нужно включить решение на виртуальной машине.

Когда завершится подключение решений по отслеживанию изменений и инвентаризации, щелкните **Управление обновлениями** в области **Управление конфигурацией**.

Решение по управлению обновлениями позволяет управлять обновлениями и исправлениями виртуальных машин Azure под управлением Windows. Можно оценить состояние доступных обновлений, назначить время установки необходимых обновлений и проверить результаты развертывания, чтобы убедиться, что обновления на виртуальной машине были успешно применены. С помощью этого действия было включено решение для виртуальной машины.

В области **Управление обновлениями** выберите **Управление обновлениями**. Выбранная рабочая область Log Analytics является той же рабочей областью, которая использовалась на предыдущем шаге. Нажмите кнопку **Включить**, чтобы подключить решение для управления обновлениями. Процесс включения решения может занять до 15 минут.

![Подключение решения по обновлению](media/automation-onboard-solutions-from-automation-account/onboardsolutions2.png)

## <a name="scope-configuration"></a>Конфигурация области

В каждом решении используется конфигурация области в пределах рабочей области для определения целевых компьютеров, на которых будет внедрено решение. Конфигурация области представляет собой группу из одного или нескольких сохраненных поисковых запросов, которая используется для ограничения области применения решения к конкретным компьютерам. Чтобы получить доступ к конфигурациям области, в учетной записи службы автоматизации в разделе **Связанные ресурсы** выберите **Рабочая область**. Затем в рабочей области в разделе **Источники данных рабочей области** выберите **Конфигурации области**.

Если в выбранной рабочей области еще нет решений "Управление обновлениями" или "Отслеживание изменений", создаются следующие конфигурации области:

* **MicrosoftDefaultScopeConfig-ChangeTracking**;

* **MicrosoftDefaultScopeConfig-Updates**.

Если выбранная рабочая область уже имеет решение, решение повторно не развертывается и к нему не добавляется конфигурация области.

## <a name="saved-searches"></a>Сохраненные поисковые запросы

При добавлении компьютера в решениях "Управление обновлениями" или "Отслеживание изменений" и "Инвентаризация" он добавляется в один из двух сохраненных поисковых запросов в рабочей области. Эти сохраненные поисковые запросы содержат компьютеры, которым будут назначены соответствующие решения.

Перейдите к учетной записи службы автоматизации и выберите **Сохраненные поисковые запросы** в разделе **Общие**. Два сохраненных поисковых запроса, используемые в этих решениях, показаны в следующей таблице:

|ИМЯ     |Категория  |Alias  |
|---------|---------|---------|
|MicrosoftDefaultComputerGroup     |  ChangeTracking       | ChangeTracking__MicrosoftDefaultComputerGroup        |
|MicrosoftDefaultComputerGroup     | Обновления        | Updates__MicrosoftDefaultComputerGroup         |

Выберите один из сохраненных поисковых запросов, чтобы просмотреть запрос, используемый для заполнения группы. На следующем рисунке показан запрос и его результаты:

![Сохраненные поисковые запросы](media/automation-onboard-solutions-from-automation-account/savedsearch.png)

## <a name="onboard-azure-vms"></a>Подключение виртуальных машин Azure

В учетной записи службы автоматизации в разделе **Управление конфигурацией** выберите **Инвентаризация** или **Отслеживание изменений**, или же выберите **Управление обновлениями** в разделе **Управление обновлениями**.

Щелкните **+ Добавить виртуальные машины Azure**, выберите одну или несколько виртуальных машин из списка. Виртуальные машины, которые нельзя включить, обозначаются серым цветом и становятся недоступными. На странице **Включение управления обновлениями** щелкните **Включить**. Выбранные виртуальные машины будут добавлены в сохраненный запрос поиска группы компьютеров для этого решения.

![Включение виртуальных машин Azure](media/automation-onboard-solutions-from-automation-account/enable-azure-vms.png)

## <a name="onboard-a-non-azure-machine"></a>Подключение компьютера, не относящегося к Azure

Компьютеры, не зарегистрированные в Azure, необходимо добавлять вручную. В учетной записи службы автоматизации в разделе **Управление конфигурацией** выберите **Инвентаризация** или **Отслеживание изменений**, или же выберите **Управление обновлениями** в разделе **Управление обновлениями**.

Щелкните **Добавить компьютер, не связанный с Azure**. Откроется новое окно браузера с [инструкциями о том, как установить и настроить Microsoft Monitoring Agent на компьютере](../log-analytics/log-analytics-concept-hybrid.md), чтобы этот компьютер начал отправлять отчеты в решение. При подключении виртуальной машины, управляемой с помощью System Center Operations Manager, новый агент не требуется. Сведения о рабочей области указываются в существующем агенте.

## <a name="onboard-machines-in-the-workspace"></a>Подключение компьютеров в рабочей области

Чтобы включить решения, установленные вручную или уже отправляющие отчеты в рабочую область компьютеры необходимо добавить в службу автоматизации Azure. В учетной записи службы автоматизации в разделе **Управление конфигурацией** выберите **Инвентаризация** или **Отслеживание изменений**, или же выберите **Управление обновлениями** в разделе **Управление обновлениями**.

Выберите **Управление компьютерами**. Откроется страница **Управление компьютерами**. На этой странице можно включить решение на выбранном наборе компьютеров, на всех доступных компьютерах, или же включить его как для всех текущих компьютеров, так и для всех будущих.

![Сохраненные поисковые запросы](media/automation-onboard-solutions-from-automation-account/managemachines.png)

### <a name="all-available-machines"></a>Все доступные компьютеры

Чтобы включить решение для всех доступных компьютеров, выберите **Включить для всех доступных компьютеров**. В результате будет отключено управление добавлением компьютеров по отдельности. Эта задача добавляет все имена компьютеров, отправляющих отчеты в рабочую область, в сохраненный запрос поиска группы компьютеров.

### <a name="all-available-and-future-machines"></a>Все доступные и будущие компьютеры

Чтобы включить решение для всех доступных и всех будущих компьютеров, выберите **Включить для всех доступных и будущих компьютеров**. Этот параметр удаляет сохраненные поисковые запросы и конфигурации области из рабочей области. Это открывает решение для всех компьютеров, относящихся и не относящихся к Azure, которые отправляют отчеты в рабочую область.

### <a name="selected-machines"></a>Выбранные компьютеры

Чтобы включить решение для одного или нескольких компьютеров, выберите **Включить для выбранных компьютеров** и нажмите кнопку **Добавить** рядом с каждым компьютером, который нужно добавить в решение. Эта задача добавляет выбранные имена компьютеров в сохраненный запрос поиска группы компьютеров для решения.

## <a name="unlink-workspace"></a>Удаление связи с рабочей областью

Следующие решения зависят от рабочей области Log Analytics:

* [Управление обновлениями](automation-update-management.md)
* [Отслеживание изменений](automation-change-tracking.md)
* [Запуск и остановка виртуальных машин в нерабочее время](automation-solution-vm-management.md)

Если вам больше не требуется интеграция учетной записи службы автоматизации с Log Analytics, вы можете отменить привязку учетной записи непосредственно на портале Azure.  Прежде чем продолжить, необходимо удалить решения, которые упоминались ранее. Иначе вы не сможете выполнить эту процедуру. Найдите в статье решение, которое вы импортировали, чтобы узнать, как его удалить.

Удалив эти решения, выполните следующие действия, чтобы отменить привязку учетной записи службы автоматизации.

> [!NOTE]
> Некоторые решения, в том числе решения по мониторингу Azure SQL более ранних версий, могли создать ресурсы службы автоматизации. Их также потребуется удалить, прежде чем удалить связь с рабочей областью.

1. На портале Azure откройте свою учетную запись службы автоматизации и на странице этой учетной записи выберите **Связанная рабочая область** в разделе **Связанные ресурсы** слева.

1. На странице "Отмена связи с рабочей областью" нажмите кнопку **Отменить связь с рабочей областью**.

   ![Страница "Отмена связи с рабочей областью"](media/automation-onboard-solutions-from-automation-account/automation-unlink-workspace-blade.png).

   Появится запрос на подтверждение удаления.

1. Пока служба автоматизации Azure пытается отменить привязку учетной записи к рабочей области Log Analytics, вы можете отслеживать ход выполнения этой задачи в меню **Уведомления**.

Если вы используете решение управления обновлениями, при необходимости можно удалить следующие элементы, которые больше не нужны после удаления решения.

* Обновление расписаний. Каждый элемент имеет имя, которое соответствует созданному вами развертыванию обновления.

* Группы гибридных рабочих ролей, созданные для решения. Каждая группа будет иметь приблизительно такое имя: machine1.contoso.com_9ceb8108-26c9-4051-b6b3-227600d715c8.

Если вы используете решение запуска и остановки виртуальных машин в нерабочее время, при необходимости можно удалить следующие элементы, которые больше не нужны после удаления решения.

* Расписание запуска и остановки виртуальной машины.
* Рабочие роли Runbook запуска и остановки виртуальной машины.
* Переменные

## <a name="next-steps"></a>Дополнительная информация

Чтобы узнать, как использовать то или иное решение, ознакомьтесь с соответствующими руководствами.

* [Управление обновлениями Windows в службе автоматизации Azure](automation-tutorial-update-management.md)

* [Получение данных об установленном программном обеспечении на виртуальных машинах Azure и других компьютерах](automation-tutorial-installed-software.md)

* [Устранение неполадок при изменениях в среде](automation-tutorial-troubleshoot-changes.md)