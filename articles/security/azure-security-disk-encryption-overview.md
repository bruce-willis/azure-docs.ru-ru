---
title: Общие сведения о шифровании дисков Azure для виртуальных машин IaaS под управлением Linux | Документация Майкрософт
description: В этой статье приведен обзор шифрования дисков Microsoft Azure для виртуальных машин IaaS.
author: mestew
ms.service: security
ms.subservice: Azure Disk Encryption
ms.topic: article
ms.author: mstewart
ms.date: 09/10/2018
ms.openlocfilehash: ea72e4ac778e52d4f6e4f5597d38a1de59ba43fc
ms.sourcegitcommit: af9cb4c4d9aaa1fbe4901af4fc3e49ef2c4e8d5e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/11/2018
ms.locfileid: "44348945"
---
# <a name="azure-disk-encryption-for-iaas-vms"></a>Шифрование дисков Azure для виртуальных машин IaaS 
Microsoft Azure обеспечивает конфиденциальность и независимость ваших данных всеми возможными способами. К данным, размещенным в Azure, можно применять целый ряд современных технологий для шифрования данных, контроля ключей шифрования и управления ими, а также контроля и аудита доступа к данным. Благодаря этому клиенты Azure получают гибкость в выборе решения, которое лучше всего соответствует потребностям их компании. В этой статье описывается технологическое решение "Шифрование дисков Azure для виртуальных машин IaaS под управлением Windows и Linux", которое защитит ваши данные в соответствии с корпоративными критериями безопасности и соответствия. 

[!INCLUDE [GDPR-related guidance](../../includes/gdpr-dsr-and-stp-note.md)]


## <a name="overview"></a>Обзор
Шифрование дисков Azure (ADE) — это возможность, которая помогает зашифровать диски виртуальных машин IaaS под управлением Windows и Linux. Она использует стандартные для отрасли функции ([BitLocker](https://docs.microsoft.com/windows/security/information-protection/bitlocker/bitlocker-overview) в Windows и [DM-Crypt](https://en.wikipedia.org/wiki/Dm-crypt) в Linux), которые обеспечивают шифрование томов дисков ОС и дисков данных. Решение интегрируется с [Azure Key Vault](https://azure.microsoft.com/documentation/services/key-vault/), помогая управлять ключами шифрования дисков и секретами. Данное решение обеспечивает шифрование всех неактивных данных на дисках виртуальной машины в службе хранилища Azure.

**Общедоступная версия** шифрования дисков Azure представлена во всех общедоступных регионах Azure и регионах AzureGov для виртуальных машин IaaS с ОС Windows и Linux уровня "Стандартный" или c хранилищем класса Premium. Применяя решение для управления шифрованием дисков Azure, можно удовлетворять приведенные ниже потребности организации.

* При хранении виртуальные машины IaaS защищаются с помощью стандартных отраслевых технологий шифрования, которые отвечают корпоративным требованиям безопасности и соответствия.
* Загрузка виртуальных машин IaaS выполняется в соответствии с ключами и политиками, которыми управляет клиент. Можно также проводить аудит их использования в хранилище ключей.


Если вы используете центр безопасности Azure, он оповестит вас при наличии незашифрованных виртуальных машин. Вы получите оповещение высокого уровня серьезности вместе рекомендацией о шифровании таких виртуальных машин.
![Оповещение о шифровании диска в центре безопасности Azure](media/azure-security-disk-encryption/security-center-disk-encryption-fig1.png)

> [!NOTE]
> Выполнение некоторых приведенных рекомендаций может привести к более интенсивному использованию данных, сети или вычислительных ресурсов, а следовательно к дополнительным затратам на лицензии или подписки.


## <a name="encryption-scenarios"></a>Сценарии шифрования
Шифрование дисков Azure поддерживает следующие сценарии взаимодействия с клиентом:

* включение шифрования для новых виртуальных машин IaaS с Windows, для создания которых используются предварительно зашифрованные виртуальные жесткие диски и ключи шифрования; 
* включение шифрования для новых виртуальных машин IaaS, созданных из поддерживаемых образов коллекции Azure;
* включение шифрования в имеющихся виртуальных машинах IaaS, запущенных в Azure;
* включение шифрования в масштабируемых наборах виртуальных машин Windows;
* включение шифрования на дисках данных для масштабируемых наборов виртуальных машин Linux;
* отключение шифрования на виртуальных машинах IaaS под управлением Windows;
* отключение шифрования на дисках данных виртуальных машин IaaS под управлением Linux;
* отключение шифрования в масштабируемых наборах виртуальных машин Windows;
* отключение шифрования на дисках данных для масштабируемых наборов виртуальных машин Linux;
* включение шифрования виртуальных машин с управляемыми дисками;
* обновление параметров шифрования существующей зашифрованной виртуальной машины с хранилищем класса "Премиум" и не из этого класса;
* резервное копирование и восстановление зашифрованных виртуальных машин.

В решениях, которые появляются в Microsoft Azure, реализована поддержка следующих сценариев для виртуальных машин IaaS:

* интеграция с хранилищем ключей Azure;
* виртуальные машины IaaS серий [A, D, DS, G, GS, F и т. д.](https://azure.microsoft.com/pricing/details/virtual-machines/) уровня "Стандартный";
    * [(Виртуальные машины Linux](azure-security-disk-encryption-faq.md#bkmk_LinuxOSSupport) этого уровня должны соответствовать минимальным требованиям к объему памяти в 7 ГБ.)
* включение шифрования для новых виртуальных машин IaaS под управлением Windows и Linux, виртуальных машин с управляемыми дисками и ВМ масштабируемого набора, созданных из поддерживаемых образов коллекции Azure;
* отключение шифрования на дисках данных и в операционной системе виртуальных машин IaaS с ОС Windows, виртуальных машин с управляемыми дисками и ВМ масштабируемого набора;
* отключение шифрования на дисках данных виртуальных машин IaaS с ОС Linux, с управляемыми дисками и ВМ масштабируемого набора;
* включение шифрования на виртуальных машинах IaaS под управлением клиентской ОС Windows;
* включение шифрования для томов с путями подключения.
* включение шифрования на виртуальных машинах Linux с чередованием дисков RAID с помощью программы mdadm;
* включение шифрования на виртуальных машинах Linux с использованием диспетчера логических томов для дисков данных;
* включение шифрования на виртуальных машинах Linux для дисков ОС и данных; 
* включение шифрования на виртуальных машинах Windows с дисковыми пространствами;
* обновление параметров шифрования существующей зашифрованной виртуальной машины с хранилищем класса "Премиум" и не из этого класса;
* резервное копирование и восстановление зашифрованных виртуальных машин для сценариев с ключом шифрования ключей и без него;
* поддерживаются все общедоступные регионы Azure и регионы AzureGov.

В этом решении не поддерживаются следующие сценарии, возможности и технологии:

* виртуальные машины уровня "Базовый";
* отключение шифрования диска ОС виртуальных машин IaaS под управлением Linux;
* отключение шифрования на диске с данными, если диск ОС зашифрован, для виртуальных машин Iaas под управлением Linux;
* виртуальные машины IaaS, созданные с помощью классической модели развертывания;
* включение шифрования для виртуальных машин IaaS под управлением Linux, созданных из пользовательских образов;
* интеграция с локальной службой управления ключами;
* служба файлов Azure (общая файловая система), NFS, динамические тома, виртуальные машины Windows с программными системами RAID.

## <a name="encryption-features"></a>Функции шифрования
Когда вы включите и развернете шифрование дисков Azure для виртуальных машин IaaS в Azure, в зависимости от конфигурации решения будут доступны следующие возможности:

* шифрование тома операционной системы для защиты загрузочного тома, размещенного в вашем хранилище;
* шифрование томов данных для защиты неактивных томов данных, размещенных в вашем хранилище;
* отключение шифрования дисков данных и дисков ОС виртуальных машин IaaS под управлением Windows;
* отключение шифрования дисков данных виртуальных машин IaaS под управлением Linux (только в тех случаях, когда диск ОС не зашифрован);
* защита ключей шифрования и секретов в вашей подписке хранилища ключей;
* информирование о состоянии шифрования зашифрованных виртуальных машин IaaS;
* удаление настроек шифрования дисков из виртуальной машины IaaS;
* архивация и восстановление зашифрованных виртуальных машин с помощью службы архивации Azure.

Решения для шифрования дисков Azure для виртуальных машин IaaS под управлением Windows и Linux включает в себя следующее:

* расширение шифрования дисков для Windows;
* расширение шифрования дисков для Linux;
* командлеты PowerShell для шифрования дисков;
* командлеты интерфейса командной строки Azure (Azure CLI) для шифрования дисков;
* шаблоны Azure Resource Manager для шифрования дисков.

Решение для шифрования дисков Azure поддерживается на виртуальных машинах IaaS под управлением ОС Windows или Linux. Дополнительные сведения о поддерживаемых операционных системах см. в статье [Предварительные требования для шифрования дисков Azure](azure-security-disk-encryption-prerequisites.md).

> [!NOTE]
> Дополнительная плата за шифрование дисков Azure для виртуальных машин не взимается. К хранилищу ключей, используемому для хранения ключей шифрования, применяются [цены на Key Vault](https://azure.microsoft.com/pricing/details/key-vault/) ценовой категории "Стандартный". 


## <a name="encryption-workflow"></a>Рабочий процесс шифрования

 Чтобы включить шифрование дисков для виртуальных машин Windows и Linux, выполните следующие шаги.

1. Выберите сценарий шифрования из перечисленных выше.
2. Дайте согласие на включение шифрования дисков с помощью шаблона Resource Manager, командлетов PowerShell или команды интерфейса командной строки для шифрования дисков Azure, а также укажите конфигурацию шифрования.

   * В случае использования зашифрованного клиентом виртуального жесткого диска передайте этот диск в свою учетную запись хранения, а ключевой материал шифрования — в хранилище ключей. Затем укажите конфигурацию шифрования, чтобы включить шифрование для новой виртуальной машины IaaS.
   * Чтобы включить шифрование для виртуальных машин IaaS, создаваемых из образов Marketplace, и для существующих виртуальных машин, которые уже работают в Azure, укажите конфигурацию шифрования.

3. Предоставьте платформе Azure доступ на чтение ключевого материала (ключи шифрования BitLocker для систем Windows или парольная фраза для Linux) из хранилища ключей, чтобы включить шифрование для виртуальной машины IaaS.

4. Azure вносит изменения в модель службы виртуальной машины на основе конфигурации шифрования и хранилища ключей, а затем настраивает вашу зашифрованную виртуальную машину.

 ![Антивредоносное ПО Майкрософт в Azure](./media/azure-security-disk-encryption/disk-encryption-fig1.png)

## <a name="decryption-workflow"></a>Рабочий процесс расшифровки
Далее описаны общие действия, которые нужно выполнить, чтобы отключить шифрование дисков виртуальной машины IaaS.

1. Отключите шифрование (расшифровку) на работающей виртуальной машине IaaS в Azure и задайте конфигурацию расшифровки. Отключить шифрование можно с помощью шаблона Resource Manager, командлетов PowerShell или интерфейса командной строки Azure для шифрования дисков Azure.

 На этом этапе для работающей виртуальной машины IaaS под управлением Windows отключается шифрование тома операционной системы и (или) тома данных. Но, как отмечено в предыдущем разделе, отключение шифрования диска ОС Linux не поддерживается. Расшифровать диски данных можно только на виртуальных машинах Linux и только в тех случаях, когда диск ОС не зашифрован.
2. Azure обновляет модель службы виртуальной машины, и виртуальная машина IaaS помечается как расшифрованная. Неактивное содержимое виртуальной машины больше не шифруется.

> [!NOTE]
> При операции отключения шифрования хранилище ключей и ключевой материал шифрования (ключи шифрования BitLocker для Windows или парольная фраза для Linux) не удаляются.
 > Отключение шифрования диска операционной системы для Linux не поддерживается. Расшифровать можно только диски данных на виртуальных машинах Linux.
Отключение шифрования диска данных для Linux не поддерживается, если диск ОС зашифрован.


## <a name="encryption-workflow-previous-release"></a>Рабочий процесс шифрования (предыдущий выпуск)

В новом выпуске шифрования дисков Azure устранена необходимость предоставлять параметр приложения Azure AD для включения шифрования дисков виртуальной машины. В новом выпуске больше не требуется вводить учетные данные Azure AD на этапе включения шифрования. При использовании нового выпуска все новые виртуальные машины должны быть зашифрованы без параметров приложения Azure AD. Виртуальные машины, которые уже были зашифрованы с помощью параметров приложения Azure AD, по-прежнему поддерживаются. Их следует и дальше обслуживать с использованием синтаксиса AAD. Чтобы включить шифрование дисков для виртуальных машин Windows и Linux (предыдущий выпуск), выполните следующие шаги.

1. Выберите сценарий шифрования из перечисленных выше.
2. Дайте согласие на включение шифрования дисков с помощью шаблона Resource Manager, командлетов PowerShell или команды интерфейса командной строки для шифрования дисков Azure, а также укажите конфигурацию шифрования.

   * В случае использования зашифрованного клиентом виртуального жесткого диска передайте этот диск в свою учетную запись хранения, а ключевой материал шифрования — в хранилище ключей. Затем укажите конфигурацию шифрования, чтобы включить шифрование для новой виртуальной машины IaaS.
   * Чтобы включить шифрование для виртуальных машин IaaS, создаваемых из образов Marketplace, и для существующих виртуальных машин, которые уже работают в Azure, укажите конфигурацию шифрования.

3. Предоставьте платформе Azure доступ на чтение ключевого материала (ключи шифрования BitLocker для систем Windows или парольная фраза для Linux) из хранилища ключей, чтобы включить шифрование для виртуальной машины IaaS.

4. Укажите идентификатор приложения Azure Active Directory (Azure AD) для записи ключевого материала шифрования в хранилище ключей. Таким образом включается шифрование для виртуальной машины IaaS в сценариях, упомянутых на шаге 2.

5. Azure вносит изменения в модель службы виртуальной машины на основе конфигурации шифрования и хранилища ключей, а затем подготавливает вашу зашифрованную виртуальную машину.


## <a name="terminology"></a>Терминология
Приведенная ниже таблица терминов позволит вам понять некоторые общие термины, которые применяются в этой технологии.

| Терминология | Определение |
| --- | --- |
| Azure AD | Azure AD — это сокращенное обозначение [Azure Active Directory](https://azure.microsoft.com/documentation/services/active-directory/). Учетная запись Azure AD используется для аутентификации, хранения секретов в хранилище ключей и извлечения их из него. |
| Хранилище ключей Azure | Key Vault представляет собой службу управления криптографическими ключами. Она основана на аппаратных модулях безопасности, соответствующих Федеральному стандарту обработки информации (FIPS), и позволяет надежно хранить криптографические ключи и конфиденциальные данные. Дополнительные сведения см. в документации по [Key Vault](https://azure.microsoft.com/services/key-vault/). |
| BitLocker |[BitLocker](https://technet.microsoft.com/library/hh831713.aspx) является общепризнанной отраслевой технологией шифрования томов Windows, используемой при шифровании дисков на виртуальных машинах IaaS под управлением Windows. |
| BEK | Ключи шифрования BitLocker (BEK) используются для шифрования загрузочного тома ОС и томов данных. Ключи BitLocker хранятся в хранилище ключей в виде секретов. |
| Интерфейс командной строки | Ознакомьтесь с разделом [Интерфейс командной строки Azure](/cli/azure/install-azure-cli).|
| DM-Crypt |[DM-Crypt](https://en.wikipedia.org/wiki/Dm-crypt) — прозрачная подсистема шифрования дисков на платформе Linux, используемая для шифрования дисков виртуальных машин IaaS под управлением Linux. |
| KEK | Ключ шифрования ключей представляет собой асимметричный ключ (RSA 2048), который применяется для защиты секрета или помещения его в оболочку. Вы можете использовать защищенный HSM ключ или ключ с программной защитой. Дополнительные сведения см. в документации по [Azure Key Vault](https://azure.microsoft.com/services/key-vault/). |
| Командлеты PS | Ознакомьтесь с [командлетами Azure PowerShell](/powershell/azure/overview). |

## <a name="next-steps"></a>Дополнительная информация
> [!div class="nextstepaction"]
> [Предварительные требования для шифрования дисков Azure](azure-security-disk-encryption-prerequisites.md)
