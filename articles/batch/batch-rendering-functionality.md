---
title: Возможности рендеринга в пакетной службе
description: Определенные возможности рендеринга в пакетной службе Azure
services: batch
author: mscurrell
ms.author: markscu
ms.date: 08/02/2018
ms.topic: conceptual
ms.openlocfilehash: 3f2fa055af63ab3920fec79ad93c25b8ea7e5ed9
ms.sourcegitcommit: 17fe5fe119bdd82e011f8235283e599931fa671a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2018
ms.locfileid: "42140110"
---
# <a name="azure-batch-rendering-capabilities"></a>Возможности рендеринга в пакетной службе Azure

Стандартные возможности пакетной службы Azure используются для запуска рабочих нагрузок рендеринга и приложений. Пакетная служба также включает в себя определенные компоненты для поддержки рабочих нагрузок рендеринга.

Общие сведения о понятиях пакетной службы, включая пулы, задания и задачи, см. в [этой статье](https://docs.microsoft.com/azure/batch/batch-api-basics).

## <a name="batch-pools"></a>Пулы пакетной службы

### <a name="rendering-application-installation"></a>Установка приложения для рендеринга

Образ виртуальной машины для рендеринга из Azure Marketplace можно указать в конфигурации пула, если необходимо использовать только предварительно установленные приложения.

Имеется образ Windows 2016 и CentOS.  Образы виртуальных машин можно найти в [Azure Marketplace](https://azuremarketplace.microsoft.com), задав в окне поиска "рендеринг в пакетной службе".

Пример конфигурации пула см. в [руководстве по отрисовке с использованием Azure CLI](https://docs.microsoft.com/azure/batch/tutorial-rendering-cli).  Портал Azure и Batch Explorer предоставляют средства графического пользовательского интерфейса для выбора образа виртуальной машины для рендеринга при создании пула.  В случае использования API пакетной службы при создании пула укажите следующие значения свойств для [ImageReference](https://docs.microsoft.com/rest/api/batchservice/pool/add#imagereference):

| ИЗДАТЕЛЬ | ПРЕДЛОЖЕНИЕ | Sku | Version (версия) |
|---------|---------|---------|--------|
| или пакетный | rendering-centos73 | rendering | последняя |
| или пакетный | rendering-windows2016 | rendering | последняя |

Если на виртуальных машинах пула необходимы дополнительные приложения, то доступны другие варианты:

* Пользовательский образ на основе стандартного образа Marketplace:
  * Этот параметр позволяет настроить виртуальную машину с нужными приложениями и конкретными версиями. Дополнительные сведения см. в статье [Использование управляемого пользовательского образа для создания пула виртуальных машин](https://docs.microsoft.com/azure/batch/batch-custom-images). Autodesk и Chaos Group изменили Arnold и V-Ray соответственно, чтобы проверить соответствие службе лицензирования пакетной службы Azure. Убедитесь, что у вас установлены версии приложений, для которых предоставляется эта поддержка. В противном случае вы не сможете использовать лицензирование с оплатой по мере использования. Текущим версиям Maya или 3ds Max не требуется сервер лицензирования при автономном запуске (в пакетном режиме или в режиме командной строки). Если вы не знаете, как использовать эту возможность, обратитесь в службу поддержки Azure.
* [Пакеты приложений](https://docs.microsoft.com/azure/batch/batch-application-packages):
  * Упакуйте файлы приложения, используя один или несколько ZIP-файлов, отправьте через портал Azure и укажите пакет в конфигурации пула. При создании виртуальных машин пула можно загрузить ZIP-архивы, а затем извлечь из них файлы.
* Файлы ресурсов:
  * Файлы приложения передаются в хранилище BLOB-объектов Azure, а вы указываете ссылки на файлы в [задаче запуска пула](https://docs.microsoft.com/rest/api/batchservice/pool/add#starttask). После создания виртуальных машин пула файлы ресурсов загружаются на каждую виртуальную машину.

### <a name="pay-for-use-licensing-for-pre-installed-applications"></a>Предварительно установленные приложения с лицензиями, предусматривающими оплату по мере использования

Приложения со стоимостью лицензирования, которые будут использоваться, должны быть заданы в конфигурации пула.

* Укажите свойство `applicationLicenses` при [создании пула](https://docs.microsoft.com/rest/api/batchservice/pool/add#request-body).  В массиве строк можно указать следующие значения: "vray", "arnold", "3dsmax", "maya".
* При указании одного или нескольких приложений стоимость этих приложений добавляется к стоимости виртуальных машин.  Цены на приложения цены указаны на [странице с ценами на пакетную службу Azure](https://azure.microsoft.com/pricing/details/batch/#graphic-rendering).

Вы можете использовать портал Azure или Batch Explorer для выбора приложений и отображения цен на них.

Если предпринята попытка использовать приложение, но оно еще не было указано в свойстве `applicationLicenses` конфигурации пула, тогда выполнение приложения завершится сбоем с ошибкой лицензирования и ненулевым кодом завершения.

### <a name="environment-variables-for-pre-installed-applications"></a>Переменные среды для предварительно установленных приложений

Чтобы иметь возможность создать командную строку для задач рендеринга, необходимо указать расположение установки исполняемых файлов приложений для рендеринга.  В образах виртуальных машин, включенных в Azure Marketplace, созданы системные переменные среды, которые можно использовать вместо того, чтобы указывать фактические пути.  Эти переменные среды являются дополнением к [стандартным переменным среды пакетной службы](https://docs.microsoft.com/azure/batch/batch-compute-node-environment-variables), созданным для каждой задачи.

|Приложение|Исполняемый файл приложения|Переменная среды|
|---------|---------|---------|
|Autodesk 3ds Max 2018|3dsmaxcmdio.exe|3DSMAX_2018_EXEC|
|Autodesk 3ds Max 2019|3dsmaxcmdio.exe|3DSMAX_2019_EXEC|
|Autodesk Maya 2017|render.exe|MAYA_2017_EXEC|
|Autodesk Maya 2018|render.exe|MAYA_2018_EXEC|
|Chaos Group V-Ray Standalone|vray.exe|VRAY_3.60.4_EXEC|
Командная строка Arnold 2017|kick.exe|ARNOLD_2017_EXEC|
|Командная строка Arnold 2018|kick.exe|ARNOLD_2018_EXEC|
|Blender|blender.exe|BLENDER_2018_EXEC|

### <a name="azure-vm-families"></a>Семейства виртуальных машин Azure

Как в других рабочих нагрузках, требования к системе приложений для рендеринга различаются, как и требования к производительности для заданий и проектов.  В Azure доступны разнообразные семейства виртуальных машин для удовлетворения любых требований — наименьшие затраты, лучшее соотношение цены и производительности и т. д.
Некоторые приложения для рендеринга, например Arnold, основаны на использовании ресурсов ЦП. Другие, такие как V-Ray и Blender Cycles, могут использовать ЦП и (или) GPU.
Описание доступных семейств виртуальных машин и их размеры см. [здесь](https://docs.microsoft.com/azure/virtual-machines/windows/sizes).

### <a name="low-priority-vms"></a>Виртуальные машины с низким приоритетом

Как и в других рабочих нагрузках, низкоприоритетные виртуальные машины могут использоваться в пулах пакетной службы для рендеринга.  Низкоприоритетные виртуальные машины выполняют то же, что и обычные выделенные виртуальные машины, но используют избыточные ресурсы Azure и доступны со значительной скидкой.  Недостатком использования виртуальных машин с низким приоритетом является то, что эти виртуальные машины могут быть недоступны для выделения или могут быть замещены в любое время, в зависимости от доступной емкости. По этой причине низкоприоритетные виртуальные машины не вполне подходят для всех заданий рендеринга. Например, если для рендеринга образов требуется много часов, скорее всего, прерывание и перезапуск рендеринга этих образов из-за замещения виртуальных машин будет неприемлемым.

Дополнительные сведения о характеристиках низкоприоритетных виртуальных машин и способах их настройки с помощью пакетной службы см. [здесь](https://docs.microsoft.com/azure/batch/batch-low-pri-vms).

## <a name="jobs-and-tasks"></a>Задания и задачи

Для заданий и задач не требуется специальная поддержка для рендеринга.  Основной элемент конфигурации — это командная строка задачи, которая должна ссылаться на нужное приложение.
При использовании образов виртуальных машин, включенных в Azure Marketplace, рекомендуется указать путь и исполняемый файл приложения с помощью переменных среды.

## <a name="next-steps"></a>Дополнительная информация

Примеры с применением рендеринга пакетной службы вы найдете в следующих руководствах:

* [Рендеринг с использованием Azure CLI](https://docs.microsoft.com/azure/batch/tutorial-rendering-cli);
* [Рендеринг с использованием Batch Explorer](https://docs.microsoft.com/azure/batch/tutorial-rendering-batchexplorer-blender).
