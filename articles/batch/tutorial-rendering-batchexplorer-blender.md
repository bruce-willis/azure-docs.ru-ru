---
title: Преобразование для просмотра сцены Blender с помощью пакетной службы Azure и Batch Explorer
description: Руководство. Преобразование для просмотра нескольких кадров из сцены Blender с помощью пакетной службы Azure и клиентского приложения Batch Explorer
services: batch
author: mscurrell
ms.author: markscu
ms.date: 08/02/2018
ms.topic: tutorial
ms.openlocfilehash: 8df9054e069540398c137290e682bb4160b4a799
ms.sourcegitcommit: 387d7edd387a478db181ca639db8a8e43d0d75f7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/10/2018
ms.locfileid: "40036639"
---
# <a name="tutorial-render-a-blender-scene-using-batch-explorer"></a>Руководство. Преобразование для просмотра сцены Blender с помощью Batch Explorer

В этом руководстве показано, как преобразовать для просмотра нескольких кадров из демонстрационной сцены в Blender. Для работы с руководством используется приложение Blender. Оно предоставляется бесплатно для клиентов и виртуальных машин, на которых выполняется преобразование для просмотра. Этот процесс будет похожим и при использовании других приложений, например Maya или 3ds Max.

Из этого руководства вы узнаете, как выполнять следующие задачи:
> [!div class="checklist"]
> * Отправка сцены Blender в службу хранилища Azure
> * Создание пула пакетной службы с несколькими узлами для преобразования для просмотра
> * Преобразование нескольких кадров для просмотра
> * Просмотр и скачивание файлов с кадрами, полученными в результате преобразования для просмотра

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/), прежде чем начинать работу.

## <a name="prerequisites"></a>Предварительные требования

Учетная запись пакетной службы Azure и связанная с ней учетная запись хранения.  Чтобы создать учетную запись пакетной службы, см. любую из статей документации по пакетной службе, например статью [Краткое руководство по выполнению первого пакетного задания с помощью Azure CLII](https://docs.microsoft.com/azure/batch/quick-create-cli).

Для размера и числа виртуальных машин, указанных в этом руководстве, требуется, чтобы минимальная квота низкоприоритетных ядер составляла не меньше 50. Можно применять квоту по умолчанию, но тогда придется использовать виртуальные машины меньшего размера, в результате чего преобразование изображений для просмотра будет занимать больше времени. См. дополнительные сведения о [создании запроса на увеличение квоты на ядра](https://docs.microsoft.com/azure/batch/batch-quota-limit).

Наконец, необходимо установить служебную программу [Batch Explorer](https://azure.github.io/BatchExplorer/), она доступна для ОС Windows, OSX и Linux. Это необязательно, но если приложение [Blender](https://www.blender.org/download/) установлено, можно просмотреть файл примера модели.

## <a name="download-the-demo-scene"></a>Скачивание сцены из демоверсии

Скачайте демонстрационный ZIP-файл Class room для Blender на [веб-странице демонстрационных файлов для Blender](https://www.blender.org/download/demo-files/) и распакуйте его на жесткий диск локального компьютера.

## <a name="upload-a-scene-to-azure-storage"></a>Отправка данных в хранилище Azure.

Создайте контейнер учетной записи хранения для файлов с демонстрационными сценами:

* Запустите Batch Explorer
* В главном меню в левой части окна выберите Data (Данные).
* В раскрывающемся списке выберите File groups (Группы файлов).
* Нажмите кнопку с плюсом и создайте пустую группу файлов с именем blender-classroom.
  * Группа файлов — это контейнер BLOB-объектов службы хранилища Azure с префиксом fgrp-. Это правило, используемое для фильтрации других контейнеров в учетной записи хранения.

![Группа файлов для файлов сцены](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_scene_filegroup.png)

Отправьте файлы сцены:

* Выберите новый контейнер и перетащите содержимое папки classroom в контейнер в Batch Explorer.

![Отправка файлов сцены](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_scene_filegroup_uploaded.png)

## <a name="create-azure-storage-container-for-output-images"></a>Создание контейнера службы хранилища Azure для выходных изображений

Создайте контейнер учетной записи хранения для выходных файлов с демонстрационными сценами:

* В главном меню в левой части окна выберите Data (Данные).
* Нажмите кнопку с плюсом и создайте пустую группу файлов с именем render-output.

![Группа файлов для выходных файлов](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_output_filegroup.png)

## <a name="create-a-pool-of-vms-for-rendering"></a>Создание пула виртуальных машин и выполнение преобразования для просмотра

Создайте пул пакетной службы с помощью преобразования для просмотра образа виртуальной машины Azure Marketplace, на которой установлено приложение Blender:

* В главном меню в левой части окна выберите Gallery (Коллекция).
* В списке приложений выберите Blender.
* Выберите элементы, которые будут преобразованы в кадры для просмотра, в Windows Server.
* Значок ссылки справа от элемента можно выбрать при необходимости, чтобы просмотреть файлы шаблонов, которые будут использоваться для создания пула и задания.

![Элементы коллекции Blender](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_gallery_item.png)

* Нажмите кнопку Create pool for later use (Создать пул для последующего использования).
  * В качестве имени пула оставьте blender-windows.
  * В поле Dedicated vm count (Число выделенных виртуальных машин) задайте значение 0.
  * В поле Low priority vm count (Число низкоприоритетных виртуальных машин) задайте значение 3.
  * В поле Node size (Размер узла) выберите значение Standard_F16. Можно выбрать другой размер виртуальной машины, но время, которое потребуется на преобразование кадра для просмотра, будет зависеть главным образом от числа ядер.
* Нажмите зеленую кнопку, чтобы создать пул.
  * Пул создается практически сразу же, но для выделения и запуска виртуальной машины потребуется несколько минут.

![Шаблон пула для Blender](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_pool_template.png)

> [!WARNING]
> Учтите, если в пуле имеются виртуальные машины, затраты на них взимаются в соответствии с вашей подпиской Azure. Во избежание расходов необходимо удалить пул или виртуальные машины. В конце этого руководства мы расскажем, как удалить пул, чтобы не платить за его использование.

Состояние пула и виртуальных машин можно отслеживать в представлении Pools (Пулы). В следующем примере все три виртуальные машины выделены, две из них запущены, но при этом бездействуют, а третья по-прежнему запускается: ![Тепловая карта пула](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_pool_heatmap.png)

## <a name="create-a-rendering-job"></a>Создание задания преобразования для просмотра

Создайте задание, чтобы с помощью созданного пула преобразовать несколько кадров для просмотра:
* В главном меню в левой части окна выберите Gallery (Коллекция).
* В списке приложений выберите Blender.
* Выберите элементы, которые будут преобразованы в кадры для просмотра, в Windows Server.
* Нажмите кнопку Run job with existing pool (Выполнить задание с помощью существующего пула).
* Выберите пул blender-windows.
* В поле Job name (Имя задания) введите blender-render-tutorial1.
* В поле Input data (Входные данные) введите fgrp-blender-classroom.
* В поле Blend file (Файл Blend) выберите значок файла и укажите имя файла classroom.blend.
* В поле Frame start (Начало кадра) укажите значение 1, а в поле Frame end (Конец кадра) укажите значение 5.
* В поле Outputs (Выходные данные) задайте значение fgrp-render-output.
* Нажмите зеленую кнопку, чтобы создать задание с пятью задачами, по одной для каждого кадра:

![Шаблон задания для Blender](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_job_template.png)

После создания задание будет отображаться вместе с задачами: ![Список задач задания](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_task_list.png)

При первом запуске задачи на виртуальной машине в пуле выполняется задача подготовки задания пакетной службы, в рамках которой файлы сцены копируются из группы файлов хранения на виртуальную машину, чтобы обеспечить доступ к ним для Blender.
Состояние преобразования для просмотра можно определить, просмотрев файл журнала stdout.txt, созданный приложением Blender.  Выберите задачу. По умолчанию отобразится вкладка Task Outputs (Выходные данные задачи), и вы сможете выбрать и просмотреть файл stdout.txt.
![Файл stdout](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_stdout.png)

Если выбран пул blender-windows, виртуальные машины из этого пула будут отображаться в состоянии выполнения: ![Тепловая карта пула с работающими узлами](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_pool_heatmap_running.png)

Изображения, готовые для просмотра, будут созданы через несколько минут, в зависимости от размера выбранной виртуальной машины.  При использовании указанной ранее виртуальной машины F16 преобразование кадров для просмотра занимает около 16 минут.

## <a name="view-the-rendering-output"></a>Просмотр выходных данных преобразования для просмотра

По завершении преобразования для просмотра кадров эти задачи будут отображаться как выполненные: ![Завершение задачи](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_tasks_complete.png)

Подготовленное изображение сначала записывается на виртуальную машину, а затем его можно просмотреть, выбрав папку wd: ![Готовое к просмотру изображение на узле пула](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_output_image.png)

В шаблоне задания также указывается, что выходные файлы кадров и файлы журнала записываются обратно в группу файлов учетной записи хранения Azure, которая была указана при создании задания.  Пользовательский интерфейс Data (Данные) можно использовать для просмотра выходных файлов и журналов, а также скачивания файлов: ![Готовое к просмотру изображение в группе файлов хранилища](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_output_image_storage.png)

После завершения всех задач задание будет помечено как выполненное: ![Задание и все задачи выполнены](./media/tutorial-rendering-batchexplorer-blender/batch_explorer_job_alltasks_complete.png)

## <a name="clean-up-resources"></a>Очистка ресурсов

> [!WARNING]
> Пул следует удалить (также можно уменьшить его размер до нуля узлов), чтобы не платить за приобретение виртуальных машин в рамках подписки Azure.

* В меню слева выберите Pools (Пулы).
* Выберите пул blender-windows.
* Щелкните правой кнопкой мыши и выберите Delete (Удалить) либо щелкните значок корзины над пулом.

## <a name="next-steps"></a>Дополнительная информация
* В разделе Gallery (Коллекция) просмотрите приложения для преобразования для просмотра, доступные в Batch Explorer.
* Для каждого приложения доступно несколько шаблонов, но их число со временем увеличится.  К примеру, для Blender существуют шаблоны, с помощью которых можно разделить изображение на фрагменты. Это позволяет преобразовать части изображения для просмотра в параллельном режиме.
* См. дополнительные сведения о [возможностях преобразования для просмотра](https://docs.microsoft.com/azure/batch/batch-rendering-service).
