---
title: Подробный обзор самостоятельного сброса пароля в Azure Active Directory
description: Как работает самостоятельный сброс пароля.
services: active-directory
ms.service: active-directory
ms.component: authentication
ms.topic: conceptual
ms.date: 07/11/2018
ms.author: joflore
author: MicrosoftGuyJFlo
manager: mtillman
ms.reviewer: sahenry
ms.openlocfilehash: 54e6b4f5804e7390b7574aa60b4d3a76df15da11
ms.sourcegitcommit: 17fe5fe119bdd82e011f8235283e599931fa671a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2018
ms.locfileid: "42144534"
---
# <a name="how-it-works-azure-ad-self-service-password-reset"></a>Как это работает: самостоятельный сброс пароля в Azure AD

Как работает самостоятельный сброс паролей? Что означает этот элемент интерфейса? Прочтите эту статью и расширьте свои знания о самостоятельном сбросе паролей в Azure Active Directory (Azure AD).

|     |
| --- |
| Такие методы самостоятельного сброса пароля в Azure AD, как уведомление мобильного приложения и код мобильного приложения, являются общедоступными предварительными версиями функций Azure Active Directory. См. дополнительные сведения о [дополнительных условиях использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).|
|     |

## <a name="how-does-the-password-reset-portal-work"></a>Как работает портал для сброса паролей

При переходе пользователя на портал сброса паролей запускается рабочий процесс, определяющий следующее:

   * язык страницы;
   * допустимость учетной записи;
   * организация, к которой принадлежит пользователь;
   * параметры управления паролем пользователя;
   * наличие лицензии на использование функции.

Прочитайте описанные ниже шаги, чтобы узнать о логике страницы сброса пароля.

1. Пользователь открывает ссылку **Не удается получить доступ к своей учетной записи** или переходит непосредственно по адресу [https://aka.ms/sspr](https://passwordreset.microsoftonline.com).
   * Язык интерфейса функции сброса паролей зависит от языка браузера. Эта функция переведена на все языки, поддерживаемые Office 365.
   * Чтобы отобразить портал сброса паролей на другом языке локализации, добавьте "?mkt=" в конец URL-адреса сброса пароля в примере ниже, в котором используется локализация на испанский язык [https://passwordreset.microsoftonline.com/?mkt=es-us](https://passwordreset.microsoftonline.com/?mkt=es-us).
2. Пользователь вводит идентификатор пользователя и проходит тест CAPTCHA.
3. Azure AD проверяет, может ли пользователь использовать эту функцию, с помощью следующих проверок:
   * Проверяет, включена ли данная функция у пользователя и назначена ли ему лицензия Azure AD.
     * Если у пользователя эта функция не включена или ему не назначена лицензия, то для сброса пароля ему предлагается обратиться к администратору.
   * Проверяет наличие у пользователя соответствующих методов проверки подлинности, определенных в его учетной записи в соответствии с политикой администратора.
     * Если политика требует только один метод, то проверяется, определены ли у пользователя соответствующие данные по крайней мере для одного из методов проверки подлинности, разрешенных политикой администратора.
       * Если методы проверки подлинности для пользователя не настроены, то для сброса пароля пользователю предлагается обратиться к администратору.
     * Если политика требует два метода, то проверяется, определены ли у пользователя соответствующие данные по крайней мере для двух методов проверки подлинности, разрешенных политикой администратора.
       * Если методы проверки подлинности для пользователя не настроены, то для сброса пароля пользователю предлагается обратиться к администратору.
     * Если пользователю назначается роль администратора Azure, применяется строгая двухфакторная политика паролей. См. дополнительные сведения о [различиях в политиках сброса паролей для роли администратора](concept-sspr-policy.md#administrator-reset-policy-differences).
   * Проверяет, управляется ли пароль пользователя локально (является ли он федеративным, используется ли он при сквозной аутентификации, или для него включена синхронизация хэшей паролей).
     * Если обратная запись развернута, а управление паролем пользователя осуществляется локально, то пользователю разрешается продолжить проверку подлинности и сбросить свой пароль.
     * Если обратная запись не развернута, а управление паролем пользователя осуществляется локально, то пользователю предлагается обратиться к администратору для сброса своего пароля.
4. Если выяснилось, что пользователь может сбросить свой пароль, ему выдаются указания по ходу процесса сброса.

## <a name="authentication-methods"></a>Методы проверки подлинности

Если функция самостоятельного сброса паролей включена, необходимо выбрать один из приведенных ниже методов проверки подлинности. Иногда эти методы называют шлюзами. Мы настоятельно рекомендуем **выбрать два или больше методов проверки подлинности**, чтобы у пользователей было больше возможностей на случай, если они не смогут получить доступ к одному из методов.

* Уведомление мобильного приложения (предварительная версия)
* Код мобильного приложения (предварительная версия)
* Email
* Мобильный телефон
* Рабочий телефон
* Контрольные вопросы

Пользователи смогут сбросить пароль, только если у них есть необходимые данные для методов проверки подлинности, которые включил администратор.

> [!WARNING]
> Для учетных записей, назначенных ролям администратора Azure, необходимо использовать методы, описанные в разделе о [различиях в политиках сброса паролей для роли администратора](concept-sspr-policy.md#administrator-reset-policy-differences).

![Аутентификация][Authentication]

### <a name="number-of-authentication-methods-required"></a>Необходимое количество методов проверки подлинности

Этот параметр определяет минимальное количество методов (шлюзов) проверки подлинности, необходимых пользователю, чтобы сбросить или разблокировать пароль. Для этого параметра можно задать значение 1 или 2.

Пользователи могут указать дополнительные методы проверки подлинности, если они включены администратором.

Если количество методов проверки подлинности не соответствует минимально установленному значению, отобразится страница ошибки со ссылкой, по которой можно отправить запрос администратору на сброс пароля.

#### <a name="mobile-app-and-sspr-preview"></a>Мобильное приложение и SSPR (предварительная версия)

При использовании мобильного приложения, например приложения Microsoft Authenticator, для сброса пароля нужно учитывать следующее:

* Когда администраторы требуют использовать один метод для сброса пароля, применение кода проверки является единственным доступным вариантом.
* Если администраторам требуются два метода, пользователи смогут сбросить пароль **ИЛИ** с помощью уведомления, **ИЛИ** с помощью кода проверки в дополнение к любым другим включенным методам.

| Число требуемых способов сброса | Один | Два |
| :---: | :---: | :---: |
| Доступные функции мобильного приложения | Код | Код или уведомление |

Пользователи не смогут зарегистрировать свое мобильное приложение при регистрации для самостоятельного сброса пароля по адресу [https://aka.ms/ssprsetup](https://aka.ms/ssprsetup). Вместо этого они смогут зарегистрировать мобильное приложение в службе по адресу [https://aka.ms/mfasetup](https://aka.ms/mfasetup) или в предварительной версии службы регистрации сведений о безопасности по адресу [https://aka.ms/setupsecurityinfo](https://aka.ms/setupsecurityinfo).

> [!WARNING]
> Вы должны включить [конвергентную регистрацию для самостоятельного сброса пароля и многофакторную идентификацию Azure (общедоступную предварительную версию)](concept-registration-mfa-sspr-converged.md), прежде чем пользователи смогут получить новые возможности в [https://aka.ms/setupsecurityinfo](https://aka.ms/setupsecurityinfo).

### <a name="change-authentication-methods"></a>Изменение методов проверки подлинности

Что случится, если начать с политики, в которой зарегистрирован только один обязательный метод проверки подлинности для сброса или разблокировки, а затем изменить его на два?

| Число зарегистрированных методов | Число обязательных методов | Результат |
| :---: | :---: | :---: |
| 1 или более | 1 | **Есть возможность** сброса или разблокировки |
| 1 | 2 | **Нет возможности** сброса или разблокировки |
| минимум 2 | 2 | **Есть возможность** сброса или разблокировки |

Если изменить типы методов проверки подлинности, которые доступны пользователю, то можно непреднамеренно заблокировать ему возможность использовать SSPR. Это произойдет, если у пользователя не будет минимального объема доступных данных.

Пример:
1. Настроена исходная политика с двумя методами проверки подлинности. Она использует только номер рабочего телефона и контрольные вопросы. 
2. Администратор изменяет политику таким образом, чтобы больше не использовались контрольные вопросы, а использовались номер мобильного телефона и запасной адрес электронной почты.
3. Пользователи, у которых не заполнены поля мобильного телефона или запасного адреса электронной почты, не могут сбрасывать свои пароли.

## <a name="registration"></a>Регистрация

### <a name="require-users-to-register-when-they-sign-in"></a>Запрос регистрации пользователей при входе

Включение этого параметра позволяет требовать, чтобы пользователь завершил регистрацию для сброса пароля, если для входа в приложения он использует Azure AD. В таким приложениям относятся следующие:

* Office 365
* Портал Azure
* Панель доступа
* федеративные приложения;
* пользовательские приложения, использующие Azure AD.

Если обязательная регистрация отключена, пользователи могут выполнить регистрацию вручную. Они могут открыть страницу [https://aka.ms/ssprsetup](https://aka.ms/ssprsetup) или перейти по ссылке **Регистрация для сброса пароля** на вкладке **Профиль** на панели доступа.

> [!NOTE]
> Пользователи могут закрыть портал регистрации для сброса паролей, выбрав **Отмена** или закрыв окно. Но каждый раз при входе они будут получать запрос на регистрацию, пока не выполнят ее.
>
> Если они уже выполнили вход, то это не нарушает подключение пользователей.

### <a name="set-the-number-of-days-before-users-are-asked-to-reconfirm-their-authentication-information"></a>Указание количества дней, по истечении которых пользователям будет предложено повторно подтвердить данные проверки подлинности

Этот параметр определяет период времени между указанием и повторным подтверждением данных проверки подлинности. Он доступен, только если включен параметр **Требовать регистрацию пользователей при входе**.

Допустимые значения: от 0 до 730 дней. Значение 0 означает, что запрос на повторное подтверждение данных проверки подлинности не появляется.

## <a name="notifications"></a>Уведомления

### <a name="notify-users-on-password-resets"></a>"Уведомлять пользователей о сбросе пароля"

Если для этого параметра задать значение **Да**, пользователи, сбрасывающие пароль, получат письмо, в котором указано, что пароль изменен. Электронное письмо отправляется через портал SSPR на основной и запасной адрес электронной почты, указанные в Azure AD. Больше это уведомление никому не отправляется.

### <a name="notify-all-admins-when-other-admins-reset-their-passwords"></a>"Уведомлять всех администраторов, если другие администраторы сбрасывают свои пароли"

Если для этого параметра задать значение **Да**, *всем администраторам* на основной и запасной адрес электронной почты, указанный в Azure AD, будет отправлено письмо. В сообщении будет указано, что другой администратор изменил пароль с помощью SSPR.

Пример. В среде есть 4 администратора. Администратор А сбрасывает их пароли с помощью SSPR. Администраторы Б, В и Г получат письмо с уведомлением о сбросе пароля.

## <a name="on-premises-integration"></a>Интеграция с локальной средой

Установив, настроив и включив Azure AD Connect, вы получите приведенные ниже дополнительные параметры интеграции с локальной средой. Они будут недоступны, если обратная запись настроена неправильно. Дополнительные сведения см. в разделе [Настройка компонента обратной записи паролей](howto-sspr-writeback.md).

![Обратная запись][Writeback]

На этой странице приводится краткая информация о состоянии локального клиента обратной записи. На ней отображается одно из приведенных ниже сообщений, в зависимости от текущей конфигурации.

* "Локальный клиент обратной записи запущен и работает".
* "Служба Azure AD Connect работает и подключена к локальному клиенту обратной записи. Похоже, однако, что установленная версия Azure AD Connect устарела. [Обновите Azure AD Connect](./../connect/active-directory-aadconnect-upgrade-previous-version.md), чтобы использовать новые функции подключения и получить важные исправления ошибок".
* "Не удается проверить состояние локального клиента обратной записи, так как установленная версия Azure AD Connect устарела. [Обновите Azure AD Connect](./../connect/active-directory-aadconnect-upgrade-previous-version.md), чтобы проверить состояние подключения".
* "Сейчас не удается подключиться к локальному клиенту обратной записи. [Устраните неполадки с Azure AD Connect](active-directory-passwords-troubleshoot.md#troubleshoot-password-writeback-connectivity), чтобы восстановить подключение".
* "Не удается подключиться к локальному клиенту обратной записи, так как обратная запись пароля не настроена. [Настройте обратную запись пароля](howto-sspr-writeback.md), чтобы восстановить подключение".
* "Сейчас не удается подключиться к локальному клиенту обратной записи. Возможно, дело во временных проблемах с нашей стороны. Если ошибка сохраняется, [устраните неполадки с Azure AD Connect](active-directory-passwords-troubleshoot.md#troubleshoot-password-writeback-connectivity), чтобы восстановить подключение".

### <a name="write-back-passwords-to-your-on-premises-directory"></a>"Включить обратную запись паролей в локальный каталог"

Этот элемент управления определяет, включена ли обратная запись паролей для этого каталога. Если обратная запись включена, он показывает состояние локальной службы обратной записи. Этот параметр удобен, если требуется временно отключить компонент обратной записи паролей без повторной настройки Azure AD Connect.

* Если задано значение **Да**, обратная запись включена и федеративные пользователи и пользователи, применяющие сквозную аутентификацию или синхронизацию хэшей паролей, могут сбрасывать свои пароли.
* Если задано значение **Нет**, обратная запись отключена и федеративные пользователи и пользователи, применяющие сквозную аутентификацию или синхронизацию хэшей паролей, не могут сбрасывать свои пароли.

### <a name="allow-users-to-unlock-accounts-without-resetting-their-password"></a>Разрешить пользователям разблокировать учетные записи без сброса пароля

Этот элемент управления указывает, следует ли предоставить пользователям, посещающим портал сброса паролей, возможность разблокировать свои локальные учетные записи Active Directory без сброса пароля. По умолчанию Azure AD разблокирует учетные записи при выполнении сброса пароля. Используйте данный параметр, чтобы разделить эти две операции. 

* Если выбрано значение **Да**, пользователи могут сбросить пароль и разблокировать учетную запись или разблокировать учетную запись без сброса пароля.
* Если значение — **Нет**, пользователи могут разблокировать учетную запись только после сброса пароля.

## <a name="password-reset-for-b2b-users"></a>Сброс пароля для пользователей B2B

Сброс и изменение пароля полностью поддерживается во всех конфигурациях B2B. Сброс паролей для пользователей B2B поддерживается в трех случаях:

   * **Пользователи из партнерской организации с существующим клиентом Azure AD.** Если организация, с которой вы вступили в партнерские отношения, имеет клиент Azure AD, мы *учитываем политики сброса пароля, включенные в этом клиенте*. Для работы сброса паролей партнерская организация должна убедиться в том, что SSPR включен в Azure AD. Для пользователей Office 365 дополнительная плата не требуется. Самостоятельный сброс паролей можно включить, выполнив действия, описанные в руководстве [Быстрое развертывание самостоятельного сброса пароля в Azure AD](https://azure.microsoft.com/documentation/articles/active-directory-passwords-getting-started/#enable-users-to-reset-or-change-their-aad-passwords).
   * **Пользователи, зарегистрировавшиеся с помощью** функции самостоятельной регистрации. Если организация, с которой вы вступили в партнерские отношения, использует функцию [самостоятельной регистрации](../users-groups-roles/directory-self-service-signup.md) для входа в клиент, мы позволим ее пользователям сбросить пароль, указав зарегистрированный адрес электронной почты.
   * **Пользователи B2B.** Все новые пользователи B2B, созданные с помощью новых [возможностей Azure AD B2B](../active-directory-b2b-what-is-azure-ad-b2b.md), также смогут сбросить пароль, указав адрес электронной почты, зарегистрированный в процессе приглашения.

Чтобы протестировать данный сценарий, перейдите на сайт http://passwordreset.microsoftonline.com под одним из этих пользователей-партнеров. Если они определили дополнительный адрес электронной почты или адрес электронной почты для проверки подлинности, сброс паролей будет работать должным образом.

> [!NOTE]
> Учетные записи Майкрософт, которым предоставлен гостевой доступ к вашему клиенту Azure AD, например адреса из Hotmail.com, Outlook.com или другие личные адреса электронной почты, не могут использовать SSPR в Azure AD. Им потребуется сбросить свой пароль, как описано в статье [Не удается войти в учетную запись Майкрософт](https://support.microsoft.com/help/12429/microsoft-account-sign-in-cant).

## <a name="next-steps"></a>Дополнительная информация

Дополнительные сведения о сбросе пароля с помощью Azure AD см. в следующих статьях:

* [Как развернуть самостоятельный сброс пароля?](howto-sspr-deployment.md)
* [Сброс или изменение пароля](../user-help/active-directory-passwords-update-your-own-password.md)
* [Регистрация для самостоятельного сброса пароля](../user-help/active-directory-passwords-reset-register.md)
* [Требования к лицензированию самостоятельного сброса пароля в Azure AD](concept-sspr-licensing.md)
* [Какие данные используются для SSPR и какие сведения нужно указывать для пользователей](howto-sspr-authenticationdata.md)
* [Доступные пользователям методы проверки подлинности](concept-sspr-howitworks.md#authentication-methods)
* [Параметры политики для SSPR](concept-sspr-policy.md)
* [Что такое обратная запись паролей и каково ее назначение](howto-sspr-writeback.md)
* [Как сообщать о действиях в SSPR](howto-sspr-reporting.md)
* [Обзор всех параметров SSPR и их значение](concept-sspr-howitworks.md)
* [Как устранить неполадки самостоятельного сброса пароля](active-directory-passwords-troubleshoot.md)
* [Вопросы, не вошедшие в другие статьи](active-directory-passwords-faq.md)

[Authentication]: ./media/concept-sspr-howitworks/sspr-authentication-methods.png "Доступные методы проверки подлинности Azure AD и требуемое число методов"
[Writeback]: ./media/concept-sspr-howitworks/troubleshoot-writeback-running.png "Настройка локальной интеграции компонента обратной записи паролей и сведения об устранении неполадок"
