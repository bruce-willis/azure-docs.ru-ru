---
title: Обзор версий среды выполнения для решения "Функции Azure"
description: Решение "Функции Azure" поддерживает разные версии среды выполнения. В этой статье приводятся различия между ними и рекомендации по выбору подходящей для вас версии.
services: functions
documentationcenter: ''
author: ggailey777
manager: jeconnoc
ms.service: azure-functions
ms.topic: conceptual
ms.date: 09/14/2018
ms.author: glenga
ms.openlocfilehash: a601ea42549abad84d6cab5c429cf94147776436
ms.sourcegitcommit: 32d218f5bd74f1cd106f4248115985df631d0a8c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2018
ms.locfileid: "46978630"
---
# <a name="azure-functions-runtime-versions-overview"></a>Обзор версий среды выполнения для решения "Функции Azure"

 Есть две основные версии среды выполнения Функций Azure: 1.x и 2.x. Текущая версия, где работают новые функции и создаются улучшения, — это 2.x, хотя обе они поддерживаются для производственной эксплуатации.  Ниже подробно рассматриваются некоторые различия между ними, а именно создание каждой версии и обновление версии 1.x до версии 2.x.

> [!NOTE] 
> Содержимое в этой статье относится к облачной службе "Функции Azure". Сведения о выполнении Функций Azure в локальной среде см. в статье [Обзор среды выполнения Функций Azure (предварительная версия)](functions-runtime-overview.md).

## <a name="creating-1x-apps"></a>Создание приложений 1.x

Для новых приложений, создаваемых на портале Azure, по умолчанию задается версия 2.x, так как это самая последняя версия, в которую будут вноситься новые функции.  Тем не менее по-прежнему можно создать приложения версии 1.х следующим образом.

1. Создайте Функцию Azure на портале Azure.
1. Откройте созданное приложение и, пока оно пустое, откройте **Параметры функций**.
1. Измените версию "~2" на "~1".  *При наличии функций в приложении этот переключатель будет отключен*.
1. Нажмите кнопку "Сохранить" и перезапустите приложение.  Теперь все шаблоны будут создаваться и запускаться в версии 1.x.

## <a name="cross-platform-development"></a>Кроссплатформенная разработка

Для среды выполнения 1.x разработка и размещение поддерживаются только на портале или в Windows. Среда выполнения 2.x выполняется на .NET Core 2. Это означает, что она может выполняться на всех платформах, поддерживаемых .NET Core, включая macOS и Linux. Это позволяет реализовать сценарии кроссплатформенной разработки и размещения.

## <a name="languages"></a>Языки

В среде выполнения 2.x используется новая модель расширяемости языка. Кроме того, для улучшения средств и производительности каждое приложение в версии 2.x может содержать функции только на одном языке. В настоящее время в версии 2.x поддерживаются языки: C#, F#, JavaScript и Java. Языки, используемые в качестве экспериментальных, в решении "Функции Azure" 1.x не обновлены для применения новой модели, поэтому они не поддерживаются в версии 2.x. В следующей таблице указаны поддерживаемые языки для каждой версии среды выполнения:

[!INCLUDE [functions-supported-languages](../../includes/functions-supported-languages.md)]

Дополнительные сведения см. в [списке поддерживаемых языков](supported-languages.md).

## <a name="migrating-from-1x-to-2x"></a>Миграция с версии 1.x на 2.x

Вы можете перенести существующее приложение, написанное в версии 1.x, в версию 2.x.  Большинство рекомендаций, касающихся перехода между версиями, связаны с перечисленными выше изменениями языковых сред выполнения (например, C# переходит с .NET Framework 4.7 на .NET Core 2).  Вам нужно убедиться, что код и библиотеки совместимы с используемыми языковыми средами выполнения.  Кроме того, обязательно обратите внимание на все изменения в триггерах, привязках и функциях, указанные ниже.

### <a name="changes-in-triggers-and-bindings"></a>Изменения в триггерах и привязках

Хотя большинство свойств и конфигураций триггера и привязки остаются теми же при смене версий, для версии 2.x нужно будет установить триггер или привязку к приложению. Единственное исключение — триггеры HTTP и таймера.  Ознакомьтесь с разделом [Регистрация расширений привязки](./functions-triggers-bindings.md#register-binding-extensions).  Обратите внимание, что также при смене версий возможны изменения в файле `function.json` или атрибутах функции (например, свойство CosmosDB `connection` теперь является свойством `ConnectionStringSetting`).  Для получения ссылок на документацию для каждой привязки см. [таблицу существующих привязок](#bindings).

### <a name="changes-in-features-available"></a>Изменения в функциях

Помимо изменений в языках и привязках, существуют некоторые функции, которые были удалены, обновлены или заменены в следующей версии.  Ниже приведены некоторые основные рекомендации, которые необходимо учесть, приступая к работе с версией 2.x после использования 1.x.  В версии 2.x внесены следующие изменения.

* Ключи для вызова функции всегда будут храниться в зашифрованном хранилище BLOB-объектов. В версии 1.x по умолчанию они были в хранилище файлов, и их также можно было переместить в хранилище BLOB-объектов при включении такой функции, как слоты.  Если выполняется обновление приложения 1.x до 2.x и секреты находятся в хранилище файлов, в настоящее время они будут восстановлены.
* Чтобы повысить производительность, триггеры типа webhook будут удалены и заменены на триггеры HTTP.
* Конфигурация узла (`host.json`) должна быть либо пустой, либо содержать свойство `version` со значением `2.0` для одного из свойств.
* Для улучшения мониторинга и видимости панель мониторинга веб-заданий (`AzureWebJobsDashboard`) заменяется на панель [Azure Application Insights](functions-monitoring.md) (`APPINSIGHTS_INSTRUMENTATIONKEY`)
* Параметрам приложения (`local.settings.json`) требуется значение для свойства `FUNCTIONS_WORKER_RUNTIME`, сопоставляемое с языком приложения `dotnet | node | java | python`.
    * Чтобы сократить занимаемую память и время запуска, приложения предназначены для одного языка. Вы можете опубликовать несколько приложений, содержащих функции на различных языках, для одного решения.
* Время ожидания по умолчанию для функций по плану обслуживания приложений равно 30 минутам.  Его по-прежнему можно установить вручную как неограниченное.
* [Из-за ограничений .NET Core](https://github.com/Azure/azure-functions-host/issues/3414) `.fsx` сценарии для функций F# были удалены. Скомпилированные функции F# по-прежнему поддерживаются.
* Формат триггеров на основе веб-перехватчика (например, Сетка событий) изменился на `https://{app}/runtime/webhooks/{triggerName}`

### <a name="upgrading-a-locally-developed-application"></a>Обновление локально разработанного приложения

Если приложение версии 1.х было разработано локально, можно внести изменения в приложение или проект, чтобы обеспечить совместимость с версией 2.  Рекомендуется создать приложение и порт для него с помощью кода.  Несмотря на наличие изменений, которые можно внести в существующее приложение для выполнения обновления на месте, существует ряд других улучшений между версиями 1 и 2, которые недоступны с устаревшим кодом (например, в C#, `TraceWriter` изменяется на `ILogger`).  

Рекомендуется начать с одного из шаблонов версии 2 и перемещаться по коду в новый проект или приложение.

#### <a name="visual-studio-runtime-versions"></a>Версии среды выполнения Visual Studio

В Visual Studio вы выбираете версию среды выполнения при создании проекта.  В Visual Studio есть биты для обеих основных версий и динамически может использоваться подходящая из них для проекта.  Эти параметры являются производными из файла `.csproj`.  Для приложений 1.x свойства проекта такие:

```xml
<TargetFramework>net461</TargetFramework>
<AzureFunctionsVersion>v1</AzureFunctionsVersion>
```

Для приложений версии 2 свойства проекта такие:

```xml
<TargetFramework>netstandard2.0</TargetFramework>
<AzureFunctionsVersion>v2</AzureFunctionsVersion>
```

Если щелкнуть команду отладки или публикации, будет установлена правильная версия для параметров проекта.

#### <a name="vs-code-and-azure-functions-core-tools"></a>Основные инструменты VS Code и Функций Azure

Другие локальные инструменты используют основные инструменты Функций Azure.  Эти инструменты устанавливаются на компьютере, и обычно только одна версия устанавливается на компьютере разработки за один раз.  См. [инструкции по установке определенных версий основных инструментов](./functions-run-local.md).

Для VS Code может также потребоваться обновить пользовательский параметр для `azureFunctions.projectRuntime`, чтобы он соответствовал версии установленных инструментов.  Во время создания приложений также обновляются представленные шаблоны и языки.

### <a name="changing-version-of-apps-in-azure"></a>Изменение версии приложений в Azure

Версии опубликованных приложений задаются с помощью параметра приложения `FUNCTIONS_RUNTIME_VERSION`.  Для этого параметра устанавливается значение `~2` для приложений версии 2 и `~1` для приложений версии 1.  Настоятельно не рекомендуется изменять версию среды выполнения приложения, в которой есть опубликованные функции, не изменяя при этом код этих функций.  Рекомендуется создать приложение-функцию, установить соответствующую версию, протестировать изменения, а затем отключить или удалить предыдущее приложение.

## <a name="bindings"></a>Привязки 

В среде выполнения 2.x используется новая [модель расширяемости привязок](https://github.com/Azure/azure-webjobs-sdk-extensions/wiki/Binding-Extensions-Overview), которая обеспечивает следующие преимущества:

* Поддержка сторонних расширений привязок.
* Разделение среды выполнения и привязок. Это позволяет отдельно управлять версиями расширений привязок и выпускать эти расширения. Например, можно выполнить обновление до версии расширения на основе более новой версии базового пакета SDK.
* Менее ресурсоемкая среда выполнения, где в среде выполнения известны только используемые привязки и только они загружаются в нее.

В решении "Функции Azure" для всех встроенных привязок применяется эта модель. Привязки больше не включены по умолчанию, кроме триггера таймера и триггера HTTP. Эти расширения устанавливаются автоматически при создании функций с помощью средств, например Visual Studio или с помощью портала.

В следующей таблице указаны поддерживаемые привязки для каждой версии среды выполнения.

[!INCLUDE [Full bindings table](../../includes/functions-bindings.md)]

## <a name="next-steps"></a>Дополнительная информация

Для получения дополнительных сведений см. следующие ресурсы:

* [Как программировать и тестировать функции Azure в локальной среде](functions-run-local.md)
* [Выбор целевых версий среды выполнения Функций Azure](set-runtime-version.md)
* [Заметки о выпуске](https://github.com/Azure/azure-functions-host/releases)
