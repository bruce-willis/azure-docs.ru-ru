---
title: IP-адреса в Функциях Azure
description: Узнайте, как найти входящий и исходящие IP-адреса для приложений-функций, и по каким причинам они изменяются.
services: functions
documentationcenter: ''
author: ggailey777
manager: jeconnoc
ms.service: azure-functions
ms.topic: conceptual
ms.date: 07/18/2018
ms.author: glenga
ms.openlocfilehash: 0fcda59add346d60f37273625fbbcf41faab0e15
ms.sourcegitcommit: af60bd400e18fd4cf4965f90094e2411a22e1e77
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/07/2018
ms.locfileid: "44091209"
---
# <a name="ip-addresses-in-azure-functions"></a>IP-адреса в Функциях Azure

В этой статье объясняются следующие темы, связанные с IP-адресами приложений-функций.

* Как найти IP-адреса, в настоящее время используемые приложением-функцией.
* Что вызывает изменение IP-адресов приложения-функции.
* Как ограничить IP-адреса, к которым может получить доступ приложение-функция.
* Как получить выделенные IP-адреса для приложения-функции.

IP-адреса связаны с приложениями-функциями, а не с отдельным функциями. Входящие HTTP-запросы не могут использовать входящий IP-адрес для вызова отдельных функций. В них должно использоваться доменное имя по умолчанию (functionappname.azurewebsites.net) или имя личного домена.

## <a name="function-app-inbound-ip-address"></a>Входящий IP-адрес приложения-функции

У каждого приложения-функции имеется отдельный входящий IP-адрес. Вот как можно найти этот IP-адрес.

1. Войдите на [портале Azure](https://portal.azure.com).
2. Перейдите к приложению-функции.
3. Выберите **Функции платформы**.
4. Выберите **Свойства**, и входящий IP-адрес отобразится в разделе **Виртуальный IP-адрес**.

## <a name="find-outbound-ip-addresses"></a>IP-адреса для исходящего трафика приложения-функции

У каждого приложения-функции имеется набор доступных исходящих IP-адресов. Любое исходящее подключение из функции, например к внутренней базе данных, использует один из доступных исходящих IP-адресов в качестве IP-адреса источника. Невозможно заранее знать, какой IP-адрес будет использован для подключения. По этой причине внутренней службе необходимо разрешить в брандмауэре все исходящие IP-адреса приложения-функции.

Вот как можно найти исходящие IP-адреса, доступные для приложения-функции.

1. Войдите в [обозреватель ресурсов Azure](https://resources.azure.com).
2. Выберите **Подписки > {ваша подписка} > Поставщики > Microsoft.Web > Сайты**.
3. На панели "JSON" найдите сайт со свойством `id`, которое заканчивается именем вашего приложения-функции.
4. Ознакомьтесь с разделами `outboundIpAddresses` и `possibleOutboundIpAddresses`. 

Для приложения-функции в настоящее время доступен набор адресов `outboundIpAddresses`. Набор `possibleOutboundIpAddresses` включает в себя IP-адреса, которые будут доступны, только когда приложение-функция будет [переведено на другую ценовую категорию](#outbound-ip-address-changes).

Альтернативный способ найти доступные исходящие IP-адреса — воспользоваться [Cloud Shell](../cloud-shell/quickstart.md).

```azurecli-interactive
az webapp show --resource-group <group_name> --name <app_name> --query outboundIpAddresses --output tsv
az webapp show --resource-group <group_name> --name <app_name> --query possibleOutboundIpAddresses --output tsv
```

## <a name="data-center-outbound-ip-addresses"></a>Исходящие IP-адреса центра обработки данных

Если вам нужно добавить в список разрешений исходящие IP-адреса, используемые приложением-функцией, можно также добавить в список разрешений центр обработки данных (регион Azure) этого приложения-функции. Вы можете [скачать XML-файл со списком IP-адресов всех центров обработки данных Azure](https://www.microsoft.com/en-us/download/details.aspx?id=41653). Затем найдите XML-элемент, который относится к региону, в котором выполняется приложение-функция.

Например, XML-элемент для региона "Западная Европа" выглядит следующим образом.

```
  <Region Name="europewest">
    <IpRange Subnet="13.69.0.0/17" />
    <IpRange Subnet="13.73.128.0/18" />
    <!-- Some IP addresses not shown here -->
    <IpRange Subnet="213.199.180.192/27" />
    <IpRange Subnet="213.199.183.0/24" />
  </Region>
```

 Чтобы получить сведения о том, когда этот файл обновляется и изменяются IP-адреса, разверните раздел **Сведения** на [странице Центра загрузки](https://www.microsoft.com/en-us/download/details.aspx?id=41653).

## <a name="inbound-ip-address-changes"></a>Изменения входящего IP-адреса

 Входящий IP-адрес **может** измениться, если вы:

- удалите приложение-функцию и создадите его заново в другой группе ресурсов;
- удалите последнее приложение-функцию с некоторым сочетанием группы ресурсов и региона и создадите его заново;
- удалите привязку SSL, например, во время [обновления сертификата](../app-service/app-service-web-tutorial-custom-ssl.md#renew-certificates).

Входящий IP-адрес также может измениться, если вы не выполнили какие-либо действия, например, из перечисленных.

## <a name="outbound-ip-address-changes"></a>Изменения исходящих IP-адресов

Набор доступных исходящих IP-адресов для приложения-функции может измениться, если вы:

* выполните какое-либо действие, которое может изменить входящий IP-адрес;
* измените ценовую категорию для плана служб приложений. Список всех возможных исходящих IP-адресов приложения для всех ценовых категорий указан в свойстве `possibleOutboundIPAddresses`. См. также раздел [Поиск исходящих IP-адресов](#find-outbound-ip-addresses).

Входящий IP-адрес также может измениться, если вы не выполнили какие-либо действия, например, из перечисленных.

Чтобы принудительно изменить исходящий IP-адрес, сделайте следующее.

1. Изменить масштаб плана службы приложений, перейдя с ценовой категории "Стандартный" на "Премиум V2" (или наоборот).
2. Подождите 10 минут.
3. Вернитесь на исходную ценовую категорию.

## <a name="ip-address-restrictions"></a>Ограничения IP-адресов

Можно настроить список IP-адресов, доступ к которым разрешен или запрещен приложению-функции. Дополнительные сведения см. в статье [Ограничения статических IP-адресов в Службе приложений Azure](../app-service/app-service-ip-restrictions.md).

## <a name="dedicated-ip-addresses"></a>Выделенные IP-адреса

Если требуется статический выделенный IP-адрес, мы рекомендуем использовать [среды службы приложений](../app-service/environment/intro.md) (категория [Изолированный](https://azure.microsoft.com/pricing/details/app-service/) планов службы приложений). Дополнительные сведения см. в разделах [IP-адреса ASE](../app-service/environment/network-info.md#ase-ip-addresses) и [Как управлять входящим трафиком в среде службы приложений](../app-service/environment/app-service-app-service-environment-control-inbound-traffic.md).

Вот как можно узнать, работает ли ваше приложение-функция в среде службы приложений.

1. Войдите на [портале Azure](https://portal.azure.com).
2. Перейдите к приложению-функции.
3. Выберите вкладку **Обзор**.
4. Категория плана службы приложений отображена в разделе **План служб приложений или ценовая категория**. Ценовая категория среды службы приложений — **Изолированный**.
 
Кроме того, можно использовать [Cloud Shell](../cloud-shell/quickstart.md).

```azurecli-interactive
az webapp show --resource-group <group_name> --name <app_name> --query sku --output tsv
```

Номер `sku` среды службы приложений — `Isolated`.

## <a name="next-steps"></a>Дополнительная информация

Распространенная причина изменения IP-адреса — изменение масштаба приложения-функции. [Узнайте больше о масштабировании приложений-функций](functions-scale.md).
