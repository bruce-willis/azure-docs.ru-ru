---
title: Упорядочение ресурсов с помощью групп управления Azure
description: Дополнительные сведения о группах управления и способах их использования.
author: rthorn17
manager: rithorn
ms.assetid: 482191ac-147e-4eb6-9655-c40c13846672
ms.service: azure-resource-manager
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 9/28/2018
ms.author: rithorn
ms.openlocfilehash: 6b369c8209e62ff3c98b3fdf78378b403b0a0d2d
ms.sourcegitcommit: 7bc4a872c170e3416052c87287391bc7adbf84ff
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/02/2018
ms.locfileid: "48017659"
---
# <a name="organize-your-resources-with-azure-management-groups"></a>Упорядочение ресурсов с помощью групп управления Azure

Если в вашей организации оформлено много подписок, возможно, потребуется повысить эффективность управления доступом, политиками и соответствием требованиям для этих подписок. Группы управления Azure обеспечивают высокий уровень охвата подписок. Подписки упорядочиваются в контейнеры, которые называются группами управления. К ним применяются условия системы управления. Все подписки в группе управления автоматически наследуют условия, применяемые к группе управления. Группы управления обеспечивают корпоративное управление в больших масштабах независимо от типа подписки.

Например, вы можете применить политики к группе управления, которая ограничивает регионы, где можно создать виртуальную машину. Эта политика будет применяться ко всем группам управления, подпискам и ресурсам в этой группе управления, разрешая создавать виртуальные машины только в этом регионе.

## <a name="hierarchy-of-management-groups-and-subscriptions"></a>Иерархия групп управления и подписок

Вы можете создать гибкую структуру групп управления и подписок для упорядочения  своих ресурсов в иерархию для унифицированного управления политикой и доступом. На следующей схеме показано, как создать иерархию управления с использованием групп управления.

![дерево](./media/MG_overview.png)

Создав иерархию, как в примере выше, вы сможете применять политики, например разрешить группе управления "Группа обслуживания инфраструктуры" создавать виртуальные машины только в регионе "Западная часть США", чтобы обеспечить соблюдение внутренних требований и политик безопасности. Эта политика будет наследоваться в обеих подписках EA в этой группе управления и применяться ко всем виртуальным машинам в этих подписках. Так как подписки наследуют эту политику безопасности от группы управления, владелец ресурса или подписки не может изменить эту политику, что позволяет улучшить управление.

Еще один сценарий, в котором можно использовать группы управления, — предоставление пользователю доступа к нескольким подпискам. Перемещая несколько подписок в одной группе управления, вы можете создать одно назначение [RBAC](../../role-based-access-control/overview.md) (управление доступом на основе ролей) в этой группе управления, которая унаследует доступ ко всем нужным подпискам.
Не нужно создавать скрипты назначений RBAC для большого количества подписок. Вы можете разрешить пользователям доступ к необходимым ресурсам с помощью одного назначения в группе управления.

### <a name="important-facts-about-management-groups"></a>Важные сведения о группах управления

- Один каталог может поддерживать 10 000 групп управления.
- Дерево группы управления может поддерживать до шести уровней глубины.
  - Это ограничение не включает уровень корня или подписки.
- Каждая группа управления и подписка может поддерживать только одну родительскую группу.
- Каждая группа управления может содержать несколько дочерних групп.
- Все группы управления и подписки хранятся в одной иерархии в каждом каталоге. Сведения об исключениях в предварительной версии см. в разделе [Важные сведения о корневой группе управления](#important-facts-about-the-root-management-group).

## <a name="root-management-group-for-each-directory"></a>Корневая группа управления для каждого каталога

Каждому каталогу присваивается одна группа управления верхнего уровня, которая называется корневой группой управления.
Эта группа встроена в иерархию, чтобы в нее входили все группы управления и подписки. Она позволяет применять глобальные политики и назначения ролей RBAC на уровне каталогов. [Администратору каталога нужно повысить привилегии](../../role-based-access-control/elevate-access-global-admin.md), чтобы он изначально был владельцем этой корневой группы управления. Когда администратор станет владельцем группы, он сможет назначить любую роль RBAC другим пользователям или группам в каталоге для управления иерархией.

### <a name="important-facts-about-the-root-management-group"></a>Важные сведения о корневой группе управления

- Имя и идентификатор корневой группы управления присваиваются по умолчанию. Отображаемое имя можно обновить в любое время для отображения другого имени на портале Azure.
  - Группа будет называться "Корневая группа клиента".
  - В качестве идентификатора будет использоваться идентификатор Azure Active Directory.
- Корневую группу управления нельзя переместить или удалить, в отличие от других групп управления.  
- Все группы управления и подписки добавляются в единую корневую группу управления в каталоге.
  - Все ресурсы в каталоге добавляются в корневую группу управления для глобального управления.
  - Новые подписки автоматически попадают в корневую группу управления при создании.
- Все клиенты Azure могут видеть корневую группу управления, но не у всех клиентов есть доступ к управлению этой корневой группой управления.
  - Все, кто имеет доступ к подписке, могут видеть контекст расположения подписки в иерархии.  
  - Никто не получает доступ к корневой группе управления по умолчанию. Глобальные администраторы каталога — это единственные пользователи, которые могут повысить свои права для получения доступа.  Получив доступ, администраторы каталога могут назначить любую роль RBAC другим пользователям для управления.  

> [!IMPORTANT]
> Любое назначение доступа или политики в корневой группе управления **применяется ко всем ресурсам в каталоге**.
> Поэтому все клиенты должны оценивать необходимость определения элементов в этой области.
> Доступ для пользователей или назначения политики должны быть обязательными только в этой области.  

## <a name="initial-setup-of-management-groups"></a>Начальная настройка групп управления

Когда любой пользователь начинает использовать группы управления, выполняется начальная настройка. Сначала в каталоге создается корневая группа управления. После создания этой группы все существующие подписки из каталога становятся дочерними элементами корневой группы управления. Это делается для того, чтобы в каталоге существовала только одна иерархия групп управления. Одна иерархия в каталоге позволяет административным клиентам применять глобальный доступ и политики, которые другие клиенты в каталоге не могут обойти. Все назначенные в корневой группе элементы будут распространяться на все группы управления, подписки, группы ресурсов и ресурсы в каталоге благодаря наличию одной иерархии в каталоге.

## <a name="trouble-seeing-all-subscriptions"></a>Проблемы с отображением всех подписок

В некоторых каталогах, для которых группы управления использовались на раннем этапе предварительной версии (до 25 июня 2018 г.), может возникнуть проблема, из-за которой все подписки не будут принудительно перемещаться в иерархию.  Это связано с тем, что процессы для принудительного перемещения подписки в иерархию были реализованы после назначения роли или политики в корневой группе управления в каталоге.

### <a name="how-to-resolve-the-issue"></a>Способы устранения проблемы

Существует два способа самостоятельного решения этой проблемы.

1. Удалить все назначения ролей и политик из корневой группы управления.
    1. Если удалить все назначения политик и ролей из корневой группы управления, служба снова заполнит все подписки в иерархии в следующем цикле.  Такая проверка позволяет проверить, не был ли случайно предоставлен доступ ко всем подпискам клиентов или назначена политика всем подпискам клиентов.
    1. Чтобы выполнить эту проверку без влияния на работу служб, лучше всего применить назначения ролей или политик на один уровень ниже корневой группы управления. После этого можно удалить все назначения из корневой области.
1. Вызвать API напрямую, чтобы начать процесс обратного заполнения.
    1. Любой авторизованный клиент в каталоге может вызвать API-интерфейсы *TenantBackfillStatusRequest* или *StartTenantBackfillRequest*. Если вызвать API StartTenantBackfillRequest, запустится процесс начальной настройки для перемещения всех подписок в иерархию. В рамках этого процесса также все новые подписки принудительно назначаются в качестве дочерних для корневой группы управления. Этот процесс можно выполнить без изменения назначений на корневом уровне, если вполне допустимо, чтобы любое назначение политики или доступа применялось ко всем подпискам.

Если у вас есть вопросы о процессе обратного заполнения, свяжитесь с нами: managementgroups@microsoft.com  
  
## <a name="management-group-access"></a>Доступ к группе управления

Группы управления Azure поддерживают [управление доступом на основе ролей в Azure (RBAC)](../../role-based-access-control/overview.md) для любого доступа к ресурсам и определения ролей.
Эти разрешения наследуются дочерними ресурсами, которые есть в иерархии. Любую встроенную роль RBAC можно назначить группе управления, которая будет наследовать вниз по иерархии к ресурсам.
Например, группе управления можно назначить роль RBAC участника виртуальной машины. Эта роль не имеет действий в группе управления, но будет наследоваться для всех виртуальных машин в этой группе управления.

В следующей таблице приводится список ролей и доступных действий в группах управления.

| Роль RBAC             | Создание | Переименование | Move | Delete | Назначение доступа | Назначение политики | чтение  |
|:-------------------------- |:------:|:------:|:----:|:------:|:-------------:| :------------:|:-----:|
|Владелец.                       | X      | X      | X    | X      | X             | X             | X     |
|участник;                 | X      | X      | X    | X      |               |               | X     |
|Участник группы управления*             | X      | X      | X    | X      |               |               | X     |
|читатель.                      |        |        |      |        |               |               | X     |
|Читатель группы управления*                  |        |        |      |        |               |               | X     |
|Участник политики ресурсов |        |        |      |        |               | X             |       |
|Администратор доступа пользователей   |        |        |      |        | X             |               |       |

*Роли участника и читателя группы управления позволяют выполнять указанные выше действия только в области действия группы управления.  

### <a name="custom-rbac-role-definition-and-assignment"></a>Пользовательское определение и назначение роли RBAC

В настоящее время настраиваемые роли RBAC не поддерживаются в группах управления. Состояние этого элемента можно отслеживать на [форуме обратной связи по группам управления](https://aka.ms/mgfeedback).

## <a name="next-steps"></a>Дополнительная информация

Дополнительные сведения о группах управления:

- [Создание групп управления для организации ресурсов Azure](create.md)
- [Изменение, удаление групп управления и управление ими](manage.md)
- [Страница для установки модуля Azure PowerShell](https://www.powershellgallery.com/packages/AzureRM.ManagementGroups)
- [Просмотр спецификации REST API](https://github.com/Azure/azure-rest-api-specs/tree/master/specification/managementgroups/resource-manager/Microsoft.Management/preview)
- [Установка расширения Azure CLI](/cli/azure/extension?view=azure-cli-latest#az-extension-list-available)