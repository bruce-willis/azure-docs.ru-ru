---
title: Руководство по добавлению личного домена к конфигурации Azure Front Door | Документация Майкрософт
description: В этом руководстве вы узнаете, как подключить личный домен к службе Azure Front Door.
services: frontdoor
documentationcenter: ''
author: sharad4u
editor: ''
ms.service: frontdoor
ms.workload: infrastructure-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: tutorial
ms.date: 09/10/2018
ms.author: sharadag
ms.openlocfilehash: 8106c68397dea8d52c6d2daa2d09dfbc72c2a4c8
ms.sourcegitcommit: 32d218f5bd74f1cd106f4248115985df631d0a8c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2018
ms.locfileid: "46995064"
---
# <a name="tutorial-add-a-custom-domain-to-your-front-door"></a>Руководство по добавлению личного домена в службу Front Door
В этом руководстве показано, как добавить личный домен в службу Front Door. При использовании службы Azure Front Door Service для доставки приложения, если вы хотите обеспечить видимость своего доменного имени в запросе пользователя, требуется личный домен. Видимое доменное имя удобно для клиентов и эффективно используется для популяризации бренда.

После создания Front Door стандартный узел внешнего интерфейса, который является поддоменом `azurefd.net`, по умолчанию включается в URL-адрес для доставки содержимого Front Door из серверной части (например, https:\//contoso.azurefd.net/activeusers.htm). Для удобства Azure Front Door предоставляет возможность связать личный домен с узлом по умолчанию. Благодаря этой возможности можно отправить содержимое с личным доменом в URL-адресе, а не именем домена владельца Front Door (например, https:\//www.contoso.com/photo.png). 

Из этого руководства вы узнаете, как выполнять следующие задачи:
> [!div class="checklist"]
> - создание записи CNAME DNS;
> - связывание личного домена с Front Door.
> - проверка личного домена.

[!INCLUDE [quickstarts-free-trial-note](../../includes/quickstarts-free-trial-note.md)]

## <a name="prerequisites"></a>Предварительные требования

Прежде чем перейти к выполнению шагов в этом руководстве, создайте службу Front Door. Дополнительные сведения см. в [этом кратком руководстве](quickstart-create-front-door.md).

Если у вас еще нет личного домена, сначала нужно приобрести его у поставщика доменов. Например, ознакомьтесь с руководством [Приобретение имени личного домена для веб-приложений Azure](https://docs.microsoft.com/azure/app-service/custom-dns-web-site-buydomains-web-app).

Если вы используете Azure для размещения [доменов DNS](https://docs.microsoft.com/azure/dns/dns-overview), вам следует делегировать систему доменного имени поставщика домена (DNS) в Azure DNS. Дополнительные сведения см. в статье [Делегирование домена в Azure DNS](https://docs.microsoft.com/azure/dns/dns-delegate-domain-azure-dns). В противном случае при использовании поставщика доменов для обработки домена DNS перейдите к разделу [создания записей CNAME DNS](#create-a-cname-dns-record).


## <a name="create-a-cname-dns-record"></a>Создание записи CNAME DNS

Перед использованием личного домена с Front Door сначала необходимо создать запись канонического имени (CNAME) поставщика домена для указания узла внешнего интерфейса Front Door по умолчанию (например, contose.azurefd.net). Запись CNAME — это тип записи DNS, позволяющий сопоставить имена исходного и конечного доменов. Для Azure Front Door Service исходное доменное имя является именем вашего личного домена, а имя домена назначения представляет собой имя узла Azure Front Door Service по умолчанию. После того как Front Door проверит созданную запись CNAME, трафик, адресованный исходному личному домену (например, www.contoso.com), будет направлен к указанному узлу внешнего интерфейса Front Door по умолчанию (например, contoso.azurefd.net). 

Личный домен и его поддомен можно связать только с одной службой Front Door за раз. Однако можно использовать разные поддомены одного и того же личного домена для разных служб Front Door с помощью нескольких записей CNAME. Кроме того, можно сопоставить личный домен с разными поддоменами с одной службой Front Door.


## <a name="map-the-temporary-afdverify-sub-domain"></a>Сопоставление временного поддомена afdverify

При сопоставлении имеющегося в рабочей среде домена стоит обратить внимание на следующее. При регистрации личного домена на портале Azure может возникнуть короткий период простоя домена. Чтобы избежать прерывания веб-трафика, сначала сопоставьте личный домен с именем узла внешнего интерфейса Front Door по умолчанию с поддоменом afdverify Azure, чтобы создать временное сопоставление CNAME. С помощью этого метода пользователи могут беспрепятственно получить доступ к вашему домену во время сопоставления DNS.

В противном случае, если вы впервые используете свой личный домен и у него нет рабочего трафика, его можно напрямую сопоставить с Front Door. Ознакомьтесь с разделом о [сопоставлении постоянного личного домена](#map-the-permanent-custom-domain).

Чтобы создать запись CNAME с поддоменом afdverify, сделайте следующее:

1. Войдите на веб-сайт поставщика своего личного домена.

2. Найдите страницу для управления записями DNS. Для этого ознакомьтесь с документацией поставщика или поищите области веб-сайта, обозначенные как **Доменное имя**, **DNS** или **Name Server Management** (Управление сервером доменных имен). 

3. Создайте запись CNAME для своего личного домена и заполните поля, как показано в таблице ниже (имена полей могут отличаться):

    | Источник                    | type  | Место назначения                     |
    |---------------------------|-------|---------------------------------|
    | afdverify.www.contoso.com | CNAME | afdverify.contoso.azurefd.net |

    - Источник. Введите имя своего личного домена, включая поддомен afdverify, в следующем формате: afdverify._&lt;имя личного домена&gt;_. Например, afdverify.www.contoso.com.

    - Тип. Введите *CNAME*.

    - Назначение. Введите узел внешнего интерфейса Front Door по умолчанию, включая поддомен afdverify, в следующем формате: afdverify._&lt;имя конечной точки&gt;_.azurefd.net. Например, afdverify.contoso.azurefd.net.

4. Сохраните изменения.

Например, процедура для регистратора домена GoDaddy выглядит следующим образом:

1. Войдите в систему и выберите личный домен, который нужно использовать.

2. В разделе доменов выберите **Управление**, а затем — **DNS** | **Manage Zones** (Управление зонами).

3. Для **доменного имени** введите свой личный домен, а затем выберите **Поиск**.

4. На странице **управления DNS** выберите **Добавить**, а затем в списке **типа** выберите **CNAME**.

5. Заполните следующие поля записи CNAME:

    - Тип. Оставьте выбранное значение *CNAME*.

    - "Узел". Введите поддомен своего личного домена, в том числе имя поддомена afdverify. Например, afdverify.www.

    - Points to (Указывает на). Введите имя узла внешнего интерфейса Front Door по умолчанию, включая имя поддомена afdverify. Например, afdverify.contoso.azurefd.net. 

    - Срок жизни. Оставьте выбранное значение *1 час*.

6. Щелкните **Сохранить**.
 
    Запись CNAME добавится к таблице записей DNS.


## <a name="associate-the-custom-domain-with-your-front-door"></a>Связывание личного домена с Front Door

После регистрации личного домена его можно добавить в службу Front Door.

1. Войдите на [портал Azure](https://portal.azure.com/) и перейдите к службе Front Door, в которой содержится узел внешнего интерфейса, который нужно сопоставить с личным доменом.
    
2. На странице **Front Door designer** (Конструктор Front Door) щелкните "+", чтобы добавить личный домен.
    
3. Укажите **личный домен**. 

4. **Узел внешнего интерфейса**, используемый в качестве целевого домена записи CNAME, предварительно заполняется и выводится из службы Front Door: *&lt;имя узла по умолчанию&gt;*.azurefd.net. Их невозможно изменить.

5. Для параметра **Пользовательское имя узла** укажите личный домен (включая дочерний домен), который будет использоваться в качестве исходного домена записи CNAME. Например, www.contoso.com или cdn.contoso.com. Не используйте имя поддомена afdverify.

6. Выберите **Добавить**.

   Azure проверит наличие записи CNAME для введенного имени личного домена. Если запись CNAME правильна, пользовательский домен пройдет проверку.

>[!WARNING]
> Вы **должны** убедиться, что каждый из узлов внешнего интерфейса (включая личные домены) в службе Front Door имеет правило маршрутизации со связанным с ним путем по умолчанию ("/\*"). То есть среди всех правил маршрутизации должно быть по крайней мере одно правило для каждого из узлов внешнего интерфейса, определенных в пути по умолчанию ("/\*"). В противном случае это может привести к неправильной маршрутизации трафика пользователя.

## <a name="verify-the-custom-domain"></a>Проверка личного домена.

После завершения регистрации личного домена убедитесь, что он ссылается на узел внешнего интерфейса Front Door по умолчанию.
 
В браузере перейдите по адресу файла с помощью личного домена. Например, если вашим личным доменом является robotics.contoso.com, URL-адрес кэшированного файла будет похож на следующий URL-адрес: http:\//robotics.contoso.com/my-public-container/my-file.jpg. Убедитесь, что результат такой же, как при доступе к Front Door непосредственно по адресу *&lt;Узел Front Door&gt;*.azurefd.net.


## <a name="map-the-permanent-custom-domain"></a>Сопоставление постоянного личного домена

После проверки успешного сопоставления поддомена afdverify с Front Door (или при использовании нового личного домена, который размещается не в рабочей среде) можно затем сопоставить личный домен напрямую с узлом внешнего интерфейса Front Door по умолчанию.

Чтобы создать запись CNAME для личного домена, сделайте следующее.

1. Войдите на веб-сайт поставщика своего личного домена.

2. Найдите страницу для управления записями DNS. Для этого ознакомьтесь с документацией поставщика или поищите области веб-сайта, обозначенные как **Доменное имя**, **DNS** или **Name Server Management** (Управление сервером доменных имен). 

3. Создайте запись CNAME для своего личного домена и заполните поля, как показано в таблице ниже (имена полей могут отличаться):

    | Источник          | type  | Место назначения           |
    |-----------------|-------|-----------------------|
    | www.contoso.com; | CNAME | contoso.azurefd.net |

    - Источник. Введите имя пользовательского домена (например, www.contoso.com).

    - Тип. Введите *CNAME*.

    - Назначение. Введите узел внешнего интерфейса Front Door по умолчанию. Должен использоваться следующий формат: _&lt;имя узла&gt;_.azurefd.net. Например, contoso.azurefd.net.

4. Сохраните изменения.

5. Если вы ранее создали временную запись CNAME поддомена afdverify, удалите ее. 

6. Если вы используете этот личный домен в рабочей среде впервые, выполните действия для [связывания личного домена с Front Door](#associate-the-custom-domain-with-your-front-door) и [проверки этого личного домена](#verify-the-custom-domain).

Например, процедура для регистратора домена GoDaddy выглядит следующим образом:

1. Войдите в систему и выберите личный домен, который нужно использовать.

2. В разделе доменов выберите **Управление**, а затем — **DNS** | **Manage Zones** (Управление зонами).

3. Для **доменного имени** введите свой личный домен, а затем выберите **Поиск**.

4. На странице **управления DNS** выберите **Добавить**, а затем в списке **типа** выберите **CNAME**.

5. Заполните следующие поля записи CNAME:

    - Тип. Оставьте выбранное значение *CNAME*.

    - Узел. Введите поддомен личного домена. Например, www или профиль.

    - Примечания. Введите имя узла Front Door по умолчанию. Например, contoso.azurefd.net. 

    - Срок жизни. Оставьте выбранное значение *1 час*.

6. Щелкните **Сохранить**.
 
    Запись CNAME добавится к таблице записей DNS.

7. Если у вас есть запись CNAME afdverify, нажмите значок карандаша рядом с ней, а затем выберите значок урны.

8. Выберите **Удалить**, чтобы удалить запись CNAME.


## <a name="clean-up-resources"></a>Очистка ресурсов

Ранее вы добавили личный домен к Front Door. Если вы больше не хотите связывать Front Door с личным доменом, этот домен можно удалить, выполнив действия ниже:
 
1. В конструкторе Front Door выберите личный домен, который нужно удалить.

2. Нажмите кнопку "Удалить" в контекстном меню для личного домена.  

   Личный домен отсоединится от конечной точки.


## <a name="next-steps"></a>Дополнительная информация

Из этого руководства вы узнали, как выполнить следующие задачи:

> [!div class="checklist"]
> - создание записи CNAME DNS;
> - связывание личного домена с Front Door.
> - проверка личного домена.