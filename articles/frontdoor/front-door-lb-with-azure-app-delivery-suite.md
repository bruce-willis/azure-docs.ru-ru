---
title: Azure Front Door Service. Балансировка нагрузки с помощью набора служб Azure для предоставления приложения | Документация Майкрософт
description: Эта статья поможет вам узнать о том, как Azure рекомендует выполнять балансировку нагрузки с использованием набора служб для предоставления приложения.
services: frontdoor
documentationcenter: ''
author: sharad4u
ms.service: frontdoor
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/10/2018
ms.author: sharadag
ms.openlocfilehash: 253ec8c0d1d6725e6ae5c47c79882284c633d6e9
ms.sourcegitcommit: 32d218f5bd74f1cd106f4248115985df631d0a8c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2018
ms.locfileid: "46984472"
---
# <a name="load-balancing-with-azures-application-delivery-suite"></a>Балансировка нагрузки с помощью набора служб Azure для предоставления приложения

## <a name="introduction"></a>Введение
Microsoft Azure предоставляет множество глобальных и региональных служб для управления распределением и балансировкой нагрузки трафика: диспетчер трафика, Front Door Service, Шлюз приложений и Load Balancer.  Совместное использование этих служб в множестве регионов Azure и разных зональных архитектурах позволяет создавать надежные, масштабируемые, высокопроизводительные приложения.

![Набор служб для предоставления приложений ][1]
 
Эти службы разбиваются на две категории.
1. **Глобальные службы балансировки нагрузки**, такие как диспетчер трафика и Front Door, распределяют трафик от пользователей на региональные серверные части, облака или даже на гибридные локальные службы. Глобальная балансировка нагрузки направляет трафик на ближайшую серверную часть службы и реагирует на изменения в надежности или производительности службы, чтобы поддерживать постоянную работу и максимальную производительность для ваших пользователей. 
2. **Региональные службы балансировки нагрузки**, такие как Load Balancer (цен. категория "Стандартный") или Шлюз приложений, предоставляют возможность распределения трафика в рамках виртуальных сетей для всех виртуальных машин или зональных конечных точек службы в пределах региона.

Объединение глобальных и региональных служб в вашем приложении обеспечивает комплексный, надежный, эффективный и безопасный способ маршрутизации трафика от ваших пользователей к IaaS, PaaS или локальным службам и наоборот. В следующем разделе описывается каждая из этих служб.

## <a name="global-load-balancing"></a>глобальная балансировка нагрузки.
**Диспетчер трафика** выполняет глобальную балансировку нагрузки на уровне DNS. Он изучает входящие запросы DNS и возвращает адрес работоспособной серверной части в соответствии с политикой маршрутизации, выбранной клиентом. Используются следующие методы маршрутизации:
- маршрутизация для повышения производительности, которая направляет пользователя к ближайшей (с минимальной задержкой) серверной части;
- маршрутизация по приоритетам, которая направляет весь трафик к одной серверной части, тогда как остальные выполняют роль резервных;
- маршрутизация со взвешенным циклическим перебором, которая распределяет трафик в соответствии с весовыми коэффициентами, присвоенными каждой серверной части;
- географическая маршрутизация, обеспечивающая, что запрашиваемые стороны, расположенные в определенных географических регионах, направляются в серверную часть, сопоставленную с этими регионами (например, все запросы от Испании должны быть направлены в регион Azure "Восточная часть США");
- маршрутизация подсети, которая позволяет сопоставлять диапазоны IP-адресов с серверными частями таким образом, чтобы запросы, поступающие от них, отправлялись в указанную серверную часть (например, все пользователи, подключающиеся из диапазона IP-адресов главного офиса, должны получать отличное от обычных пользователей веб-содержимое).

Клиент подключается напрямую к указанной серверной части. Если серверная часть неработоспособна, диспетчер трафика Azure обнаружит это и перенаправит клиентов на другой работающий экземпляр. Подробнее эта служба описана в статье [Что такое диспетчер трафика](../traffic-manager/traffic-manager-overview.md).

**Azure Front Door Service** предоставляет динамическое ускорение веб-сайта, включая глобальную балансировку нагрузки HTTP.  Она просматривает входящие HTTP-запросы, направленные в ближайшую серверную часть или регион для указанного имени узла, URL-адреса и настроенных правил.  
Front Door завершает HTTP-запросы на границе сети Майкрософт и активно проверяет приложения или инфраструктуры на наличие изменений работоспособности или задержки.  Затем служба Front Door направляет трафик в наиболее быструю и доступную серверную часть (работоспособную). Дополнительные сведения о службе см. в статьях, посвященных [архитектуре маршрутизации](front-door-routing-architecture.md) и [методам маршрутизации Front Door](front-door-routing-methods.md).

## <a name="regional-load-balancing"></a>Региональная балансировка нагрузки
Шлюз приложений предоставляет контроллер доставки приложений (ADC) как услугу, предлагая для приложения разные функции балансировки нагрузки уровня 7. Таким образом, пользователи могут оптимизировать производительность веб-фермы за счет выполнения операции завершения SSL-запросов, требующей интенсивного использования ЦП, на шлюзе приложений. Кроме того, пользователи получают другие возможности маршрутизации уровня 7, включая циклическое распределение входящего трафика, соответствие сеансу на основе файлов cookie, маршрутизацию на основе URL-путей и возможность размещения нескольких веб-сайтов за одним шлюзом приложений. Шлюз приложений можно настроить как шлюз с доступом в Интернет, внутренний шлюз или же как сочетание этих вариантов. Шлюз приложений полностью управляется Azure. Он является масштабируемым и обладает высоким уровнем доступности. Для более эффективного управления предоставляется широкий набор возможностей ведения журнала и диагностики.
Load Balancer — это неотъемлемая часть стека SDN Azure, которая обеспечивает высокую производительность и балансировку нагрузки уровня 4 с низкой задержкой для всех протоколов UDP и TCP. Она управляет и входящими, и исходящими подключениями. Вы можете настроить общедоступные и внутренние конечные точки с балансировкой нагрузки, а также определить правила для сопоставления входящих подключений к узлам серверной части, используя параметры проверки состояний по TCP и HTTP, чтобы управлять доступностью служб.


## <a name="choosing-a-global-load-balancer"></a>Выбор глобальной подсистемы балансировки нагрузки
При выборе глобальной подсистемы балансировки нагрузки для глобальной маршрутизации между диспетчером трафика и Azure Front Door следует учитывать сходства и отличия между двумя службами.   Обе службы обеспечивают:
- **Высокую геоизбыточность.** Когда один регион выходит из строя, трафик незамедлительно перенаправляется в следующий ближайший регион без каких-либо действий со стороны владельца приложения.
- **Маршрутизацию в ближайший регион.** Трафик автоматически направляется в ближайший регион.

</br>В следующей таблице описаны различия между диспетчером трафика и Azure Front Door Service:</br>

| Диспетчер трафика | Azure Front Door Service |
| --------------- | ------------------------ |
|**Любой протокол.** Так как диспетчер трафика работает на уровне DNS, вы можете передавать любой тип трафика: HTTP, TCP, UDP и т. д. | **Ускорение HTTP.** При использовании Front Door трафик передается на границу сети Майкрософт.  По этой причине запросы HTTP(S) сопровождаются улучшением задержки и пропускной способности благодаря уменьшению задержки при согласовании SSL и использовании горячего подключения из AFD к приложению.|
|**Локальная маршрутизация.** При маршрутизации на уровне DNS трафик всегда идет от точки к точке.  Маршрутизации из филиала в локальный центр обработки данных может потребоваться прямой путь, даже в вашей собственной сети, где используется диспетчер трафика. | **Независимое масштабирование.** Так как Front Door работает с HTTP-запросами, запросы к разным URL-адресам могут быть перенаправлены в другую серверную часть или пул региональных служб (микрослужб) на основе правил и работоспособности каждой микрослужбы приложения.|
|**Формат выставления счетов.** Выставление счетов на основе DNS, которое масштабируется в соответствии с числом пользователей и для служб с большим количеством пользователей, может помочь сократить затраты при высоком использовании. |**Встроенная безопасность.** Front Door включает правила, например ограничение частоты и применение списка управления доступом для IP-адресов, позволяя защитить серверные части перед тем, как трафик достигнет приложения. 

</br>Мы рекомендуем клиентам использовать Front Door для рабочих нагрузок HTTP в связи с преимуществами производительности, работоспособности и безопасности.    Диспетчер трафика и Front Door можно использовать в параллельном режиме для обработки всего трафика вашего приложения. 

## <a name="building-with-azures-application-delivery-suite"></a>Сборка с помощью набора служб Azure для предоставления приложения 
Рекомендуется, чтобы все веб-сайты, API и службы были геоизбыточными и по мере возможности доставляли трафик пользователям из ближайшего (с минимальной задержкой) расположения.  Объединение служб диспетчера трафика, Front Door Service, Шлюза приложений и Load Balancer позволяет создавать географическую и зональную избыточность для обеспечения максимальной надежности, производительности и масштабирования.

На следующей схеме представлен пример службы, которая использует сочетание всех этих служб для создания глобальной веб-службы.   В этом случае архитектор использовал диспетчер трафика для маршрутизации на глобальные серверные части для доставки файлов и объектов, а Front Door — для глобальной маршрутизации URL-адресов, которые соответствуют шаблону /store/*, к службе, перенесенной в Службу приложений Azure, а все остальные запросы направляются к региональным Шлюзам приложений.

В регионе для службы IaaS разработчик приложения решил, что все URL-адреса, которые соответствуют шаблону /images/*, должны обслуживаться выделенным пулом виртуальных машин, отделенных от остальной части веб-фермы.

Кроме того, пул виртуальных машин по умолчанию, который предоставляет динамически генерируемый контент, должен взаимодействовать с серверной базой данных, размещенной в высокодоступном кластере. Все это развертывание подготовлено с использованием Azure Resource Manager.

На следующей схеме показана архитектура этой системы.

![Подробная архитектура набора для предоставления приложения][2] 

> [!NOTE]
> Этот пример демонстрирует лишь одну из многих возможных конфигураций, которые можно реализовать с использованием служб Azure для балансировки нагрузки. Диспетчер трафика, Front Door, Шлюз приложений и Load Balancer можно использовать совместно в зависимости от ваших потребностей. Например, если вам не требуется разгрузка SSL или обработка уровня 7, вместо шлюза приложений можно применить подсистему балансировки нагрузки.


## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения о [создании Front Door](quickstart-create-front-door.md).
- Дополнительные сведения о том, [как работает Front Door](front-door-routing-architecture.md).

<!--Image references-->
[1]: ./media/front-door-lb-with-azure-app-delivery-suite/application-delivery-figure1.png
[2]: ./media/front-door-lb-with-azure-app-delivery-suite/application-delivery-figure2.png