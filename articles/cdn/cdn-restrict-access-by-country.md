---
title: Ограничение доступности содержимого Azure CDN по странам | Документация Майкрософт
description: Узнайте, как ограничить доступ к содержимому Azure CDN для определенных стран, используя геофильтрацию.
services: cdn
documentationcenter: ''
author: dksimpson
manager: cfowler
editor: ''
ms.assetid: 12c17cc5-28ee-4b0b-ba22-2266be2e786a
ms.service: cdn
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/19/2018
ms.author: v-deasim
ms.openlocfilehash: 661356aeb2369bc1bbddd6caee57b256dd9e1212
ms.sourcegitcommit: d8ffb4a8cef3c6df8ab049a4540fc5e0fa7476ba
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/20/2018
ms.locfileid: "36285021"
---
# <a name="restrict-azure-cdn-content-by-country"></a>Ограничение доступности содержимого Azure CDN по странам

## <a name="overview"></a>Обзор
По умолчанию запрашиваемое содержимое возвращается пользователю независимо от расположения, из которого был сделан запрос. Но в некоторых случаях может потребоваться ограничить доступ к содержимому для определенной страны. Функция *геофильтрации* позволяет создавать правила на основе определенных путей в конечной точке CDN, чтобы разрешить или запретить доступ к содержимому в выбранных странах.

> [!IMPORTANT]
> Профили **Azure CDN уровня "Стандартный" от Майкрософт** не поддерживают геофильтрацию на основе пути.
> 

## <a name="standard-profiles"></a>Профили (цен. категория "Стандартный")
Процедуры, описанные в этом разделе, относятся только к профилям **Azure CDN (цен. категория "Стандартный") от Akamai** и **Azure CDN (цен. категория "Стандартный") от Verizon**. 

Чтобы активировать геофильтрацию для профилей **Azure CDN (цен. категория "Премиум") от Verizon**, используйте портал **управления**. Дополнительные сведения см. в разделе о профилях [Azure CDN (цен. категория "Премиум") от Verizon](#azure-cdn-premium-from-verizon-profiles).

### <a name="define-the-directory-path"></a>Определение пути к каталогу
Чтобы получить доступ к функции геофильтрации, выберите свою конечную точку CDN на портале, а затем щелкните **Геофильтрация** в разделе параметров в меню слева. 

![Геофильтрация (цен. категория "Стандартный")](./media/cdn-filtering/cdn-geo-filtering-standard.png)

В поле **Путь** укажите относительный путь к каталогу, доступ к которому будет разрешен или запрещен. 

Геофильтрацию можно применить ко всем файлам в корневом каталоге, указав косую черту (/), или к выбранным каталогам, указав к ним пути, например */pictures/*. Геофильтрацию также можно применить к одному файлу, например */pictures/city.png*. Можете указать несколько правил. Когда вы введете первое правило, рядом появится пустая строка для ввода следующего.

Например, все следующие фильтры путей каталогов являются допустимыми:   
*/*                                 
*/Photos/*   ;  
*/Photos/Strasbourg/*   ;  
*/Photos/Strasbourg/city.png*.

### <a name="define-the-type-of-action"></a>Определение типа действия

В списке **Действие** выберите **Разрешить** или **Запретить**: 

- **Разрешить**: доступ к ресурсам, запрашиваемым по указанному рекурсивному пути, разрешается только для пользователей из указанных стран.

- **Запретить**: пользователям из указанных стран запрещается доступ к ресурсам, запрашиваемым по указанному рекурсивному пути. Если для этого пути не было настроено другой фильтрации по стране, то доступ для всех остальных пользователей будет разрешен.

Например, правило геофильтрации для блокировки путей */фотографии/Strasbourg/* фильтрует следующие файлы:     
*http://<endpoint>.azureedge.net/Photos/Strasbourg/1000.jpg*
*http://<endpoint>.azureedge.net/Photos/Strasbourg/Cathedral/1000.jpg*

### <a name="define-the-countries"></a>Определение стран
В списке **Коды стран** выберите страны, доступ из которых для выбранного пути нужно разрешить или запретить. 

Выбрав страны, щелкните **Сохранить**, чтобы активировать новое правило геофильтрации. 

![Правила геофильтрации](./media/cdn-filtering/cdn-geo-filtering-rules.png)

### <a name="clean-up-resources"></a>Очистка ресурсов
Чтобы удалить правило, выберите его в списке на странице **Фильтрация по странам**, а затем щелкните **Удалить**.

## <a name="azure-cdn-premium-from-verizon-profiles"></a>Профили Azure CDN (цен. категория "Премиум") от Verizon
Пользовательский интерфейс для создания правила геофильтрации отличается для профилей **Azure CDN (цен. категория "Премиум") от Verizon**.

1. В меню профиля Azure CDN вверху выберите **Управление**.

2. На портале Verizon выберите **HTTP Large** (Большой HTTP-объект) и **Country Filtering** (Фильтрация по странам).

    ![Геофильтрация (цен. категория "Стандартный")](./media/cdn-filtering/cdn-geo-filtering-premium.png)

3. Нажмите кнопку **Add Country Filter** (Добавить фильтр по странам).

    Появится страница **Step One:** (Шаг 1).

4. Введите путь к каталогу, выберите **Block** (Блокировать) или **Add** (Добавить), а затем нажмите кнопку **Next** (Далее).

    Появится страница **Step Two:** (Шаг 2). 

5. Выберите одну или несколько стран в списке, а затем нажмите кнопку **Finish** (Готово), чтобы активировать правило. 
    
    Новое правило появится в таблице на странице **Country Filtering** (Фильтрация по странам).

    ![Правила геофильтрации](./media/cdn-filtering/cdn-geo-filtering-premium-rules.png)

### <a name="clean-up-resources"></a>Очистка ресурсов
В таблице правил фильтрации по странам щелкните значок удаления рядом с правилом, чтобы удалить правило, или значок изменения, чтобы изменить правило.

## <a name="considerations"></a>Рекомендации
* Изменения в конфигурации геофильтрации для страны вступают в силу не сразу:
   * Для профилей **Azure CDN категории "Стандартный" от Майкрософт** распространение обычно выполняется в течение 10 минут. 
   * Для профилей **Azure CDN уровня "Стандартный" от Akamai** распространение обычно завершается в течение одной минуты. 
   * Для профилей **Azure CDN уровня "Стандартный" от Verizon** и **Azure CDN уровня "Премиум" от Verizon** распространение обычно выполняется в течение 10 минут. 
 
* Эта функция не поддерживает подстановочные знаки (например, *).

* Конфигурация геофильтрации, связанная с относительным путем, применяется рекурсивно к этому пути.

* Только одно правило может применяться к тому же относительному пути. Поэтому нельзя создать несколько фильтров стран, которые указывают на тот же относительный путь. Но в папке может быть несколько фильтров стран из-за их рекурсивных особенностей. Другими словами, подкаталогу ранее настроенного каталога можно назначить другой фильтр страны.

* Функция геофильтрации использует коды стран, чтобы определить, из каких стран запрос к защищаемому каталогу будет разрешаться, а из каких — блокироваться. Хотя профили от Akamai и Verizon по большей части поддерживают одинаковые коды стран, существуют некоторые различия. Дополнительные сведения см. в статье о [кодах стран Azure CDN](https://msdn.microsoft.com/library/mt761717.aspx). 

