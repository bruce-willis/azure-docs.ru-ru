---
title: Включение автоматической настройки для базы данных SQL Azure | Документация Майкрософт
description: Вы можете легко включить автоматическую настройку для базы данных SQL Azure.
services: sql-database
author: danimir
manager: craigg
ms.service: sql-database
ms.custom: monitor & tune
ms.topic: conceptual
ms.date: 04/01/2018
ms.author: v-daljep
ms.reviewer: carlrab
ms.openlocfilehash: 9ebc3a8cb01d93fc6cec5d208c5a10020413cec2
ms.sourcegitcommit: 4de6a8671c445fae31f760385710f17d504228f8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/08/2018
ms.locfileid: "39631101"
---
# <a name="enable-automatic-tuning"></a>Включение автоматической настройки

База данных SQL Azure — это автоматически управляемая служба данных, которая постоянно отслеживает запросы и определяет действия, которые вы можете выполнять для повышения производительности рабочей нагрузки. Вы можете просматривать рекомендации и вручную применять их, или позволить базе данных SQL Azure автоматически применять действия по исправлению, что известно как **режим автоматической настройки**.

Автоматическую настройку можно включить на уровне сервера или базы данных с помощью [портала Azure](sql-database-automatic-tuning-enable.md#azure-portal), вызовов [REST API](sql-database-automatic-tuning-enable.md#rest-api) или команд [T-SQL](sql-database-automatic-tuning-enable.md#t-sql).

## <a name="enable-automatic-tuning-on-server"></a>Включение автоматической настройки на сервере
На уровне сервера можно выбрать или отключить наследование автоматической настройки конфигурации из значений Azure по умолчанию. Значения Azure по умолчанию: FORCE_LAST_GOOD_PLAN включено, CREATE_INDEX включено, а DROP_INDEX отключено.

### <a name="azure-portal"></a>Портал Azure
Чтобы включить автоматическую настройку на логическом **сервере** базы данных SQL Azure, перейдите на сервер на портале Azure, а затем выберите в меню **Автонастройка**.

![сервер;](./media/sql-database-automatic-tuning-enable/server.png)

> [!NOTE]
> Обратите внимание, что параметр **DROP_INDEX** сейчас не поддерживается в приложениях, использующих переключения секций и подсказки индекса. В этих случаях его следует отключить.
>

Выберите параметры автоматической настройки, которые необходимо включить, а затем выберите **Применить**.

Параметры автоматической настройки на сервере применяются ко всем базам данных на сервере. По умолчанию все базы данных наследуют конфигурацию из родительского сервера, но ее можно переопределить, а также указать отдельно для каждой базы данных.

### <a name="rest-api"></a>REST API

Дополнительные сведения о включении автоматической настройки на сервере с помощью REST API см. в разделе, посвященном [методам HTTP UPDATE и GET для автонастройки SQL Server](https://docs.microsoft.com/rest/api/sql/serverautomatictuning).


## <a name="enable-automatic-tuning-on-an-individual-database"></a>Включение автоматической настройки для отдельной базы данных

База данных SQL Azure позволяет отдельно указать конфигурацию автоматической настройки для каждой базы данных. На уровне базы данных можно включить наследование автоматической настройки конфигурации из родительского сервера, значений Azure по умолчанию либо отключить наследование конфигурации. Значения Azure по умолчанию: FORCE_LAST_GOOD_PLAN включено, CREATE_INDEX включено, а DROP_INDEX отключено.

> [!NOTE]
> Мы рекомендуем управлять конфигурацией автоматической настройки на **уровне сервера**, чтобы те же параметры конфигурации можно было автоматически применить в каждой базе данных. Настройте автоматические параметры для отдельной базы данных, если вам нужно, чтобы ее параметры отличались от параметров других баз на одном сервере.
>

### <a name="azure-portal"></a>Портал Azure

Чтобы включить автоматическую настройку для **отдельной базы данных**, перейдите в базу данных на портале Azure, а затем выберите **Автонастройка**.

Отдельные параметры автоматической настройки можно настроить отдельно для каждой базы данных. Можно вручную настроить отдельные параметры автоматической настройки или указать, что параметр наследует параметры с сервера.

![База данных](./media/sql-database-automatic-tuning-enable/database.png)

Обратите внимание, что параметр DROP_INDEX сейчас не поддерживается в приложениях, использующих переключения секций и подсказки индекса. В этих случаях его следует отключить.

После выбора соответствующей конфигурации щелкните **Применить**.

### <a name="rest-api"></a>Rest API

Дополнительные сведения о включении автоматической настройки в отдельной базе данных с помощью REST API см. в разделе, посвященном [методам HTTP UPDATE и GET для автонастройки базы данных SQL](https://docs.microsoft.com/rest/api/sql/databaseautomatictuning).

### <a name="t-sql"></a>T-SQL

Чтобы включить автоматическую настройку в одной базе данных через T-SQL, подключитесь к базе данных и выполните следующий запрос.

   ```T-SQL
   ALTER DATABASE current SET AUTOMATIC_TUNING = AUTO | INHERIT | CUSTOM
   ```
   
Если установить для автоматической настройки значение AUTO, будут применяться значения Azure по умолчанию. Если установить значение INHERIT, автоматическая настройка конфигурации будет унаследована от родительского сервера. Если установить значение CUSTOM, автоматическую настройку необходимо будет настраивать вручную.

Для настройки отдельных параметров автоматической настройки через T-SQL подключитесь к базе данных и выполните запрос, подобный следующему.

   ```T-SQL
   ALTER DATABASE current SET AUTOMATIC_TUNING (FORCE_LAST_GOOD_PLAN = ON, CREATE_INDEX = DEFAULT, DROP_INDEX = OFF)
   ```
   
Если задать для отдельного параметра настройки значение ON, это переопределит наследуемое значение базы данных и включит параметр настройки. Если задать значение OFF, это также переопределит наследуемое значение базы данных и отключит параметр настройки. Параметр автоматической настройки, для которого задано значение DEFAULT, будет наследовать конфигурацию от параметра автоматической настройки уровня базы данных.  

Дополнительные сведения о параметрах T-SQL для конфигурации автонастройки см. в разделе [Параметры ALTER DATABASE SET (Transact-SQL)](https://docs.microsoft.com/en-us/sql/t-sql/statements/alter-database-transact-sql-set-options?view=sql-server-2017&tabs=sqldbls#arguments-1).

## <a name="disabled-by-the-system"></a>Отключено системой
Автоматическая настройка контролирует все действия, которые она выполняет в базе данных, и в некоторых случаях может определить, что автоматическая настройка в базе данных работает не должным образом. В этом случае параметр настройки будет отключен системой. В большинстве случаев это происходит потому, что хранилище запросов отключено или доступно только для чтения в определенной базе данных.

## <a name="configure-automatic-tuning-e-mail-notifications"></a>Настройка уведомлений по электронной почте об автоматической настройке

Ознакомьтесь с руководством [Уведомления по электронной почте об автоматической настройке](sql-database-automatic-tuning-email-notifications.md).

## <a name="next-steps"></a>Дополнительная информация
* Дополнительные сведения об автоматической настройке и о том, как она повышает производительность, см. в [этой статье](sql-database-automatic-tuning.md).
* Общие сведения о рекомендациях по производительности базы данных SQL Azure см. в статье [Помощник по работе с базами данных SQL](sql-database-advisor.md).
* См. статью [Анализ производительности запросов базы данных Azure SQL](sql-database-query-performance.md), чтобы узнать о том, как просмотреть влияние на производительность основных запросов.
