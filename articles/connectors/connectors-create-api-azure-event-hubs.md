---
title: Подключение к концентраторам событий Azure с помощью Azure Logic Apps | Документация Майкрософт
description: Управление и мониторинг событий с помощью концентраторов событий Azure и Azure Logic Apps
author: ecfan
manager: jeconnoc
ms.author: estfan
ms.date: 05/21/2018
ms.topic: article
ms.service: logic-apps
services: logic-apps
ms.reviewer: klam, LADocs
ms.suite: integration
tags: connectors
ms.openlocfilehash: 86fc1c3542bea1be840041bb73df15631c066c7e
ms.sourcegitcommit: 6f6d073930203ec977f5c283358a19a2f39872af
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "35294978"
---
# <a name="monitor-receive-and-send-events-with-azure-event-hubs-and-azure-logic-apps"></a>Мониторинг, получение и отправка событий с помощью концентраторов событий Azure и Azure Logic Apps 

В этой статье показано, как можно отслеживать и управлять событиями, отправленными в [концентраторы событий Azure](../event-hubs/event-hubs-what-is-event-hubs.md) из внутреннего приложения логики при помощи соединителя концентраторов событий Azure. Таким образом, можно создать приложения логики, которые автоматизируют задачи и рабочие процессы для проверки, отправки и получения событий из концентратора событий. 

Если у вас еще нет подписки Azure, <a href="https://azure.microsoft.com/free/" target="_blank">зарегистрируйтесь для получения бесплатной учетной записи Azure</a>. Если вы не работали с приложениями логики, см. руководства по [Azure Logic Apps](../logic-apps/logic-apps-overview.md) и [созданию первого приложения логики](../logic-apps/quickstart-create-first-logic-app-workflow.md).
См. технические сведения о <a href="https://docs.microsoft.com/connectors/eventhubs/" target="blank">соединителях концентраторов событий Azure</a>.

## <a name="prerequisites"></a>предварительным требованиям

* [Пространство имен концентраторов событий и концентратор событий](../event-hubs/event-hubs-create.md).

* Приложение логики, из которого необходимо получить доступ к концентратору событий. Чтобы запустить приложение логики с помощью триггера концентраторов событий Azure, требуется [пустое приложение логики](../logic-apps/quickstart-create-first-logic-app-workflow.md). 

<a name="permissions-connection-string"></a>

## <a name="check-permissions-and-get-connection-string"></a>Проверка разрешений и получение строки подключения

Чтобы приложение логики могло использовать концентратор событий, проверьте свои разрешения и получите строку подключения для доступа к пространству имен концентраторов событий.

1. Войдите на <a href="https://portal.azure.com" target="_blank">портале Azure</a>. 

2. Перейдите к *пространству имен* концентраторов событий (но не к конкретному концентратору событий). На странице пространства имен в разделе **Параметры** выберите **Политики общего доступа**. В разделе **Утверждения** убедитесь, что у вас есть разрешения на **управление** для этого пространства имен.

   ![Управление разрешениями для пространства имен концентраторов событий](./media/connectors-create-api-azure-event-hubs/event-hubs-namespace.png)

3. Если вы хотите в дальнейшем вручную ввести сведения о подключении, получите строку подключения для пространства имен концентраторов событий. 

   1. В разделе **Политика** выберите **RootManageSharedAccessKey**. 

   2. Найдите строку подключения первичного ключа. Нажмите кнопку "Копировать" и сохраните строку подключения для последующего использования.

      ![Скопируйте строку подключения к пространству имен концентраторов событий](media/connectors-create-api-azure-event-hubs/find-event-hub-namespace-connection-string.png)

      > [!TIP]
      > Чтобы проверить, относится ли строка подключения к пространству имен концентраторов событий или к определенному концентратору событий, убедитесь, что она не содержит параметр `EntityPath`. Если в строке подключения есть этот параметр, значит она относится к определенной "сущности" концентратора событий и ее нельзя использовать в приложении логики.

4. Теперь продолжайте дальше, используя варианты [Add an Event Hubs trigger](#add-trigger) (Добавить триггер концентраторов событий) или [Add an Event Hubs action](#add-action) (Добавить действие концентраторов событий).

<a name="add-trigger"></a>

## <a name="add-an-event-hubs-trigger"></a>Добавка триггера концентраторов событий

В Azure Logic Apps каждое приложение логики должно запускаться по [триггеру](../logic-apps/logic-apps-overview.md#logic-app-concepts), который активируется, когда происходит определенное событие или если выполняются заданные условия. При каждом срабатывании триггера обработчик Logic Apps создает экземпляр приложения логики, запускающий рабочий процесс.

В этом примере показано, как запустить рабочий процесс приложения логики, когда новые события отправляются в концентратор событий. 

1. На портале Azure или в Visual Studio создайте пустое приложение логики. Откроется конструктор Logic Apps. В этом примере используется портал Azure.

2. В поле поиска в качестве фильтра введите "концентраторы событий". В списке триггеров выберите нужный триггер. 

   В этом примере используется триггер **Event Hubs — When events are available in Event Hub** (Концентраторы событий — при наличии событий в концентраторе событий)

   ![Выбор триггера](./media/connectors-create-api-azure-event-hubs/find-event-hubs-trigger.png)

3. Если вам будет предложено ввести сведения о подключении, [создайте подключение концентраторов событий сейчас](#create-connection). Или, если подключение уже существует, введите необходимые сведения для триггера.

   1. Из списка **Имя концентратора событий** выберите концентратор событий, который требуется отслеживать.

      ![Выбор концентратора событий или группы потребителей](./media/connectors-create-api-azure-event-hubs/select-event-hub.png)

   2. Укажите частоту и продолжительность, с которыми триггер будет проверять концентратор событий.
 
   3. Если вы хотите выбрать некоторые из расширенных параметров триггера, щелкните **Показать расширенные параметры**.
   
      ![Расширенные параметры триггера](./media/connectors-create-api-azure-event-hubs/event-hubs-trigger-advanced.png)

      | Свойство | Сведения | 
      |----------|---------| 
      | Тип содержимого  | Выберите тип содержимого события. По умолчанию "application/octet-stream". |
      | Схема содержимого | Введите схему содержимого в формате JSON для событий, которые считываются из концентратора событий. |
      | Имя группы потребителей | Для чтения событий введите [имя группы потребителей](../event-hubs/event-hubs-features.md#consumer-groups) концентратора событий. Если оно не задано, используется группа потребителей по умолчанию. |
      | Minimum partition key (Минимальное количество ключей секций) | Введите минимальное количество идентификаторов [секций](../event-hubs/event-hubs-features.md#partitions) для считывания. По умолчанию считываются все секции. |
      | Maximum partition key (Максимальное количество ключей секций) | Введите максимальное количество идентификаторов [секций](../event-hubs/event-hubs-features.md#partitions) для считывания. По умолчанию считываются все секции. |
      | Maximum events count (Счетчик максимального количества событий) | Введите максимальное количество событий. Триггер возвращает значение от 1 до количества событий, заданного в этом свойстве. |
      |||

4. Завершив работу, нажмите кнопку **Сохранить** на панели инструментов конструктора.

5. Теперь продолжайте добавлять действия в приложение логики для задач, которые необходимо выполнить с результатами триггера.

> [!NOTE]
> Все триггеры концентратора событий являются триггерами *длинного опроса*. Это значит, что при срабатывании триггер обрабатывает все события, а затем 30 секунд ожидает, пока в концентраторе событий не появятся дополнительные события.
> Запуск триггера пропускается, если на протяжении 30 секунд не будет получено ни одного события. В противном случае триггер продолжит считывать события до момента, пока концентратор событий не останется пустым.
> Следующий опрос триггера происходит на основе интервала повторения, указанного в свойствах триггера.

<a name="add-action"></a>

## <a name="add-an-event-hubs-action"></a>Добавление действия концентраторов событий

В Azure Logic Apps [действие](../logic-apps/logic-apps-overview.md#logic-app-concepts) — это шаг в рамках рабочего процесса, выполняемый после срабатывания триггера или другого действия. В этом примере приложение логики запускается с помощью триггера концентраторов событий, который проверяет наличие новых событий в концентраторе событий. 

1. На портале Azure или в Visual Studio откройте приложение логики в конструкторе Logic Apps. В этом примере используется портал Azure.

2. В разделе "Триггер" или "Действия" выберите **Новый шаг** > **Add an action** (Добавить действие).

   Чтобы добавить действие между существующими шагами, наведите указатель мыши на соединяющую стрелку. 
   Щелкните появившийся знак "плюс" (**+**), а затем выберите **Добавить действие**.

3. В поле поиска в качестве фильтра введите "концентраторы событий".
В списке действий выберите любое необходимое действие. 

   Для этого примера выберите это действие: **Концентраторы событий – отправка события**

   ![Выбор Event Hubs — Send event (Концентраторы событий — отправка события)](./media/connectors-create-api-azure-event-hubs/find-event-hubs-action.png)

4. Если вам будет предложено ввести сведения о подключении, [создайте подключение концентраторов событий сейчас](#create-connection). Или, если подключение уже существует, введите необходимые сведения для действия.

   | Свойство | Обязательно | ОПИСАНИЕ | 
   |----------|----------|-------------|
   | имя концентратора событий; | Yes | Выберите концентратор событий для отправки события | 
   | Содержимое события | Нет  | Содержимое для события, которое необходимо отправить | 
   | properties | Нет  | Свойства приложения и значения для отправки | 
   |||| 

   Например:  

   ![Выбор имени концентратора событий и указание содержимого события](./media/connectors-create-api-azure-event-hubs/event-hubs-send-event-action.png)

5. Завершив работу, нажмите кнопку **Сохранить** на панели инструментов конструктора.

<a name="create-connection"></a>

## <a name="connect-to-your-event-hub"></a>Подключение к концентратору событий

[!INCLUDE [Create connection general intro](../../includes/connectors-create-connection-general-intro.md)] 

1. Когда вам будет предложено ввести информацию о соединении, укажите следующие сведения.

   | Свойство | Обязательно | Значение | ОПИСАНИЕ | 
   |----------|----------|-------|-------------|
   | Имя подключения | Yes | <*имя_соединения*> | Имя создаваемого подключения |
   | Пространство имен концентраторов событий | Yes | <*пространство_имен_концентраторов_событий*> | Выберите пространство имен концентраторов событий, которые необходимо использовать. | 
   |||||  

   Например: 

   ![Создание подключения концентратора событий](./media/connectors-create-api-azure-event-hubs/create-event-hubs-connection-1.png)

   Чтобы ввести строку подключения вручную, выберите **Вручную введите сведения о подключении**. 
   Сведения о том, как найти строку подключения, см. в разделе [Проверка разрешений для пространства имен концентраторов событий и определение строки подключения](#permissions-connection-string).

2. Выберите нужную политику концентраторов событий, если она еще не выбрана. Выберите **Создать**.

   ![Создание подключения концентратора событий, часть 2](./media/connectors-create-api-azure-event-hubs/create-event-hubs-connection-2.png)

3. После создания подключения перейдите к [Add an Event Hubs trigger](#add-trigger) (Добавить триггер концентраторов событий) или [Add an Event Hubs action](#add-action) (Добавить действие концентраторов событий).

## <a name="connector-reference"></a>Справочник по соединителям

См. дополнительные технические сведения о [триггерах, действиях и ограничениях, описываемых файлом Swagger соединителя](/connectors/eventhubs/). 

## <a name="get-support"></a>Получение поддержки

* Если у вас возникли вопросы, то посетите [форум Azure Logic Apps](https://social.msdn.microsoft.com/Forums/en-US/home?forum=azurelogicapps).
* Отправить идею по поводу возможности или проголосовать за нее вы можете на [сайте отзывов пользователей Logic Apps](http://aka.ms/logicapps-wish).

## <a name="next-steps"></a>Дополнительная информация

* См. дополнительные сведения о других [соединителях Logic Apps](../connectors/apis-list.md).