---
title: Log Analytics для поставщиков служб | Документы Майкрософт
description: Log Analytics позволяет поставщикам управляемых служб (MSP), крупным предприятиям, независимым поставщикам программного обеспечения (ISV) и поставщикам услуг размещения управлять серверами, размещенными в локальной сети клиента или в облачной инфраструктуре, и осуществлять мониторинг таких серверов.
services: log-analytics
documentationcenter: ''
author: MeirMen
manager: jochan
editor: ''
ms.assetid: c07f0b9f-ec37-480d-91ec-d9bcf6786464
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 07/05/2018
ms.author: meirm
ms.component: na
ms.openlocfilehash: ad0a3b8e0ee5f1114ea1db95cfe2f4176b8e2ddb
ms.sourcegitcommit: aa988666476c05787afc84db94cfa50bc6852520
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/10/2018
ms.locfileid: "37931996"
---
# <a name="log-analytics-for-service-providers"></a>Log Analytics для поставщиков служб
Log Analytics позволяет поставщикам управляемых служб (MSP), крупным предприятиям, независимым поставщикам программного обеспечения (ISV) и поставщикам услуг размещения управлять серверами, размещенными в локальной сети клиента или в облачной инфраструктуре, и осуществлять мониторинг таких серверов. 

Крупные предприятия во многом сходны с поставщиками услуг, особенно те, которые используют единую ИТ-структуру для централизованного управления ИТ-системами в различных подразделениях. Для простоты в этом документе мы будем использовать термин *поставщик услуг*, но все описанные возможности доступны также для предприятий и других клиентов.

Log Analytics входит в число служб Azure, доступных в рамках подписки [CSP Azure](https://docs.microsoft.com/azure/cloud-solution-provider/overview/azure-csp-overview), для партнеров и поставщиков услуг, работающих по программе [поставщика облачных решений (CSP)](https://partner.microsoft.com/Solutions/cloud-reseller-overview). 

## <a name="architectures-for-service-providers"></a>Архитектуры для поставщиков служб

Рабочие области Log Analytics позволяют администраторам управлять потоком, изолировать журналы и разрабатывать архитектуру журналов в соответствии с потребностями организации. В [этой статье](https://docs.microsoft.com/en-us/azure/log-analytics/log-analytics-manage-access) приводятся общие рекомендации, связанные с управлением рабочими областями. Для поставщиков служб действуют дополнительные рекомендации.

Существует три возможных архитектуры для поставщиков служб, связанные с рабочими областями Log Analytics:

### <a name="1-distributed---logs-are-stored-in-workspaces-located-in-the-customers-tenant"></a>1. Распределенная архитектура — журналы хранятся в рабочих областях, которые находятся у арендатора клиента. 

В этой архитектуре рабочая область развертывается у арендатора клиента и используется для размещения всех журналов этого клиента. Администраторам поставщиков служб предоставляется доступ к этой рабочей области с помощью [гостевых пользователей Azure Active Directory (B2B)](https://docs.microsoft.com/en-us/azure/active-directory/b2b/what-is-b2b). Для доступа к этим рабочим областям администратору поставщика служб необходимо переключиться в каталог клиента на портале Azure.

Эта архитектура обладает следующими преимуществами:
* Клиент может управлять доступом к журналам с использованием собственного механизма [управления доступом на основе ролей](https://docs.microsoft.com/en-us/azure/role-based-access-control/overview).
* У каждого клиента могут быть собственные параметры рабочей области, такие как период хранения и ограничение на использование данных.
* Изоляция между клиентами для соблюдения нормативных требований и требований соответствия.
* Плата за каждую рабочую область будет включена в подписку клиента.
* Вы сможете собирать журналы для всех типов ресурсов, не только на основе агента. Например, аудит Azure.

Эта архитектура обладает следующими недостатками:
* Поставщику служб труднее одновременно управлять большим количеством арендаторов клиента.
* Администраторов поставщиков служб необходимо подготовить в каталоге клиента.
* Поставщик служб не может анализировать данные своих клиентов.

### <a name="2-central---logs-are-stored-in-workspace-located-in-the-service-provider-tenant"></a>2. Централизованная архитектура — журналы хранятся в рабочей области, расположенной в клиенте поставщика службы.

В этой архитектуре журналы хранятся не у арендаторов клиента, а в едином централизованном расположении в одной из подписок поставщика служб. Для агентов, установленных на виртуальных машинах клиента, настраивается отправка журналов в эту рабочую область с использованием идентификатора рабочей области и секретного ключа.

Эта архитектура обладает следующими преимуществами:
* Удобное управление большим числом клиентов и их интеграция в различные серверные системы.
* Поставщик служб является полным владельцем журналов и различных артефактов, таких как функции и сохраненные запросы.
* Поставщик служб может формировать аналитические сведения для всех клиентов.

Эта архитектура обладает следующими недостатками:
* Эта архитектура подходит только для данных виртуальных машин на основе агента. Она не распространяется на источники данных PaaS, SaaS и источники данных структуры Azure.
* С разделением данных, объединенных в одну рабочую область, между клиентами могут возникнуть трудности. Единственный эффективный способ сделать это — использовать полное доменное имя компьютера (FQDN) или идентификатор подписки Azure. 
* Данные всех клиентов будут храниться в одном регионе с единым счетом и с одинаковыми параметрами хранения и конфигурации.
* Для структуры Azure и служб PaaS, таких как система диагностики Azure и аудит Azure, требуется, чтобы рабочая область и ресурс находились в одном клиенте, поэтому эти службы не могут отправлять журналы в центральную рабочую область.
* Все агенты виртуальных машин для всех клиентов будут проходить проверку подлинности в центральной рабочей области с помощью одинаковых идентификаторов рабочей области и ключей. Невозможно заблокировать журналы от указанного клиента, не прерывая работу других клиентов.


### <a name="3-hybrid---logs-are-stored-in-workspace-located-in-the-customers-tenant-and-some-of-them-are-pulled-to-a-central-location"></a>3. Гибридная архитектура — журналы хранятся в рабочей области, расположенной у арендатора клиента, и некоторые из этих журналов извлекаются в центральное расположение.

Третий вариант архитектуры представляет собой сочетание первых двух вариантов. Он основан на первой распределенной архитектуре, в которой журналы являются локальными для каждого клиента, но использует определенный механизм для создания центрального репозитория журналов. Часть журналов извлекается в центральное расположение для создания отчетов и аналитики. Эта часть журналов может включать небольшое число типов данных или сводку действия, например ежедневную статистику.

Существует два варианта реализации центрального расположения в Log Analytics:

1. Центральная рабочая область: поставщик служб может создать рабочую область в клиенте и использовать сценарий, который переносит данные из различных рабочих областей в это центральное расположение с помощью [API запроса](https://dev.loganalytics.io/) в составе [API сбора данных](log-analytics-data-collector-api.md). Вместо сценария может использоваться [приложение логики Azure](https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-overview).

2. Power BI как центральное расположение: Power BI может выступать в качестве центрального расположения, если различные рабочие области экспортируют данные в это расположение с помощью интеграции между Log Analytics и [Power BI](log-analytics-powerbi.md). 


## <a name="next-steps"></a>Дальнейшие действия
* Автоматизация создания и настройки рабочих областей с помощью [шаблонов Resource Manager](log-analytics-template-workspace-configuration.md).
* Автоматизация создания рабочих областей с помощью [PowerShell](log-analytics-powershell-workspace-configuration.md). 
* Использование [оповещений](log-analytics-alerts.md) для интеграции с существующими системами.
* Создание сводных отчетов с помощью [Power BI](log-analytics-powerbi.md)

