---
title: Делегирование предложений в Azure Stack | Документация Майкрософт
description: Узнайте, как привлечь других людей к созданию предложений и регистрации пользователей.
services: azure-stack
documentationcenter: ''
author: brenduns
manager: femila
editor: ''
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/07/2018
ms.author: brenduns
ms.reviewer: alfredop
ms.openlocfilehash: 112586d3ee5f49eab9adb72d41a210e2dd9828d8
ms.sourcegitcommit: 387d7edd387a478db181ca639db8a8e43d0d75f7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/10/2018
ms.locfileid: "41954629"
---
# <a name="delegate-offers-in-azure-stack"></a>Делегирование предложений в Azure Stack

*Область применения: интегрированные системы Azure Stack и Пакет средств разработки Azure Stack*

Как оператору Azure Stack, вам часто необходимо привлекать других людей к регистрации пользователей и созданию подписок. Например, если вы являетесь поставщиком услуг, посредники должны регистрировать клиентов и управлять ими от вашего имени. Или, например, ваше подразделение является частью центральной ИТ-группы предприятия, и вам нужно делегировать обязанности по входу пользователей другому ИТ-специалисту.

Делегирование упрощает охват и администрирование большего числа пользователей по сравнению с самостоятельным выполнением, как показано на рисунке. 

![Уровни делегирования](media/azure-stack-delegated-provider/image1.png)

С помощью функции делегирования делегированный поставщик управляет предложением (делегированное предложение), а пользователи получают подписки в рамках этого предложения без участия системного администратора. 

## <a name="understand-delegation-roles-and-steps"></a>Сведения о ролях и действиях делегирования

### <a name="delegation-roles"></a>Роли делегирования

Следующие роли являются частью делегирования:

* *Оператор Azure Stack* управляет инфраструктурой Azure Stack, создает шаблон предложения и делегирует другим пользователям возможность предлагать его своим клиентам.

* Делегированные операторы Azure Stack c правами *владельца* или *участника* в подписках называются *делегированными поставщиками*. Они могут относиться к другим организациям (например, к другим клиентам Azure Active Directory).

* *Пользователи* регистрируются для получения предложений и используют их для управления своими рабочими нагрузками, создания виртуальных машин, хранения данных и т. д.

### <a name="delegation-steps"></a>Действия делегирования

Существуют два основных действия по настройке делегирования.

1. *Создайте подписку делегированного поставщика*, подписав пользователя на предложение, содержащее только службу подписок. Таким образом делегированный поставщик сможет расширить делегированные предложения на других пользователей путем их подписки на них.

2. *Делегирование предложения делегированному поставщику.* Это предложение позволяет делегированному поставщику создавать подписки или расширять предложение для пользователей. Теперь делегированный поставщик может принимать предложение и предлагать его другим пользователям.

На следующем рисунке показаны действия по настройке делегирования.

![Создание учетной записи делегированного поставщика и предоставление ему возможности регистрировать пользователей](media/azure-stack-delegated-provider/image2.png)

**Требования к делегированному поставщику**

Чтобы выступать в качестве делегированного поставщика, пользователю нужно установить связь с основным поставщиком путем создания подписки. Подписка позволяет делегированному поставщику предоставлять делегированные предложения от имени основного поставщика.

После установления этой связи оператор Azure Stack может делегировать предложение делегированному поставщику. Делегированный поставщик может принять предложение, переименовать его (но не изменять его содержание) и предложить своим клиентам.

## <a name="delegation-walkthrough"></a>Пошаговое руководство по делегированию

Следующие разделы содержат практическое руководство по настройке делегированного поставщика, делегированию предложения и проверке того, могут ли пользователи зарегистрироваться для получения делегированного предложения.

### <a name="set-up-roles"></a>Настройка ролей

Для использования этого пошагового руководства требуется две учетные записи Azure AD в дополнение к учетной записи оператора Azure Stack. Если их нет, необходимо создать две такие учетные записи. Учетные записи могут принадлежать любому пользователю Azure AD. Они называются учетными записями делегированного поставщика и пользователя.

| **Роль** | **Права в организации** |
| --- | --- |
| Делегированный поставщик |Пользователь |
| Пользователь |Пользователь |

### <a name="identify-the-delegated-provider"></a>Идентификация делегированного поставщика

1. Войдите на портал администратора с учетной записью оператора Azure Stack.

1. Чтобы создать предложение, которое позволяет пользователю стать делегированным поставщиком, выполните следующие действия.

   a.  [Создайте план](azure-stack-create-plan.md).
       Этот план должен содержать только службу подписки. В этой статье в качестве примера используется план с именем **PlanForDelegation**.

   b.  [Создайте предложение](azure-stack-create-offer.md) на основе этого плана. В этой статье в качестве примера используется предложение с именем **OfferToDP**.

   c.  Добавьте делегированного поставщика в качестве подписчика на это предложение, выбрав **Подписки** > **Добавить** > **Новая подписка клиента**.

   ![Добавление делегированного поставщика в качестве подписчика](media/azure-stack-delegated-provider/image3.png)

   > [!NOTE]
   > Как и для всех предложений Azure Stack, у вас есть два варианта действий. Можно сделать предложение общедоступным и разрешить пользователям регистрироваться в нем или оставить его частным и позволить оператору Azure Stack управлять регистрациями. Делегированные поставщики, как правило, представляют собой небольшую группу. Вам нужно будет контролировать допуск в эту группу. Поэтому в большинстве случаев целесообразнее вариант частного доступа.

### <a name="azure-stack-operator-creates-the-delegated-offer"></a>Создание делегированного предложения оператором Azure Stack

Следующим шагом является создание плана и предложения, которое необходимо делегировать и которое будут использовать клиенты. Рекомендуем определить это предложение так, как его должны видеть клиенты — делегированный поставщик не может изменить включаемые планы и квоты.

1. Как оператор Azure Stack [создайте план](azure-stack-create-plan.md) и [предложение](azure-stack-create-offer.md) на его основе. В этой статье в качестве примера используется предложение с именем **DelegatedOffer**.

   > [!NOTE]
   > Это предложение не должно быть общедоступным, но при желании его можно сделать таковым. Но в большинстве случаев вам понадобится ограничить к нему доступ, то есть разрешить его только делегированным поставщикам. После делегирования частного предложения, как описано в представленных ниже инструкциях, делегированный поставщик получит к нему доступ.

1. Делегируйте предложение. Выберите предложение **DelegatedOffer**. В разделе **Параметры** выберите **Делегированные поставщики** > **Добавить**.

1. Выберите подписку делегированного поставщика из раскрывающегося списка и нажмите кнопку **Делегировать**.

   ![Добавление делегированного поставщика](media/azure-stack-delegated-provider/image4.png)

### <a name="delegated-provider-customizes-the-offer"></a>Настройка предложения делегированным поставщиком

Войдите на портал пользователя в качестве делегированного поставщика и создайте предложение, используя делегированное предложение в качестве шаблона.

1. Выберите **Создать** > **Предложения и планы клиента** > **Предложение**.

    ![Создание нового предложения](media/azure-stack-delegated-provider/image5.png)

1. Присвойте имя предложению. В этой статье в качестве примера используется предложение **ResellerOffer**. Выберите делегированное предложение для использования в качестве основы и нажмите кнопку **Создать**.

   ![Присвоение имени](media/azure-stack-delegated-provider/image6.png)

   >[!IMPORTANT]
   >Важно понимать, что делегированные поставщики могут выбирать только предложения, делегированные им. Делегированные поставщики не могут вносить изменения в эти предложения. Только оператор Azure Stack может вносить в них изменения. Например, изменить их планы и квоты. Делегированный поставщик не создает предложение на основе базовых и дополнительных планов. 

3. Делегированный поставщик может сделать эти предложения общедоступными через собственный URL-адрес портала. Чтобы сделать предложение общедоступным, выберите **Обзор** и щелкните **Предложения**. Выберите предложение и нажмите **Изменить состояние**.

4. Теперь общедоступные делегированные предложения видимы только на делегированном портале. Чтобы найти и изменить этот URL-адрес:

    a.  Выберите **Обзор** > **Другие службы** > **Подписки**. Выберите подписку делегированного поставщика. Например, последовательно выберите **DPSubscription** > **Свойства**.

    b.  Скопируйте URL-адрес портала в отдельное расположение, например в Блокнот.

    ![Выбор подписки делегированного поставщика](media/azure-stack-delegated-provider/dpportaluri.png)  

   Вы создали делегированное предложение от имени делегированного поставщика. Выйдите из системы как делегированный поставщик и закройте окно используемого браузера.

### <a name="sign-up-for-the-offer"></a>Регистрация для получения предложения

1. В новом окне браузера перейдите по URL-адресу делегированного портала, сохраненному на предыдущем шаге. Войдите на портал в качестве пользователя.

   >[!NOTE]
   >Делегированные предложения отображаются только на делегированном портале.

1. На панели мониторинга выберите **Получить подписку**. Вы увидите, что для пользователя отображаются только делегированные предложения, созданные делегированным поставщиком.

   ![Просмотр и выбор предложений](media/azure-stack-delegated-provider/image8.png)

Процесс делегирования предложения завершен. Теперь пользователь может зарегистрироваться на это предложение, получив подписку на него.

## <a name="move-subscriptions-between-delegated-providers"></a>Перемещение подписок между делегированными поставщиками

При необходимости подписку можно перемещать между новыми или имеющимися подписками делегированного поставщика, которые принадлежат одному и тому же клиенту каталога. Для этого используйте командлет PowerShell [Move-AzsSubscription](https://docs.microsoft.com/powershell/module/azs.subscriptions.admin).

Это полезно, если:
- Нужно подключить нового члена команды, который получит роль делегированного поставщика, и этому члену нужно присвоить подписки пользователя, созданные ранее в рамках подписки поставщика по умолчанию.
- У вас несколько подписок делегированных поставщиков в одном клиенте каталога (Azure Active Directory) и необходимо переместить между ними подписки пользователей. Такое происходит, когда члена перемещают между командами и их подписки нужно разместить в новой команде.


## <a name="next-steps"></a>Дополнительная информация

[Создание тестовой виртуальной машины в Azure Stack](azure-stack-provision-vm.md)