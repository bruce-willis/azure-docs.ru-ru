---
title: API компьютерного зрения для Microsoft Cognitive Services | Документация Майкрософт
description: Используйте расширенные алгоритмы в API компьютерного зрения для обработки изображений и возврата данных в Microsoft Cognitive Services.
services: cognitive-services
author: KellyDF
manager: corncar
ms.service: cognitive-services
ms.component: computer-vision
ms.topic: article
ms.date: 08/10/2017
ms.author: kefre
ms.openlocfilehash: 86e0441c600162e479c678d3cb1dbeaad423ddb5
ms.sourcegitcommit: 95d9a6acf29405a533db943b1688612980374272
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/23/2018
ms.locfileid: "35382253"
---
# <a name="what-is-computer-vision-api-version-10"></a>Что собой представляет API компьютерного зрения версии 1.0?

> [!IMPORTANT]
> Теперь доступна новая версия API компьютерного зрения. Дополнительные сведения см. в этих статьях:
>- [Обзор](https://docs.microsoft.com/azure/cognitive-services/computer-vision/home)
>- [Computer Vision API — v2.0](https://westus.dev.cognitive.microsoft.com/docs/services/5adf991815e1060e6355ad44) (API компьютерного зрения версии 2.0)

Облачный API компьютерного зрения предоставляет разработчикам доступ к расширенным алгоритмам обработки изображений и возврата данных. После загрузки изображения или указания его URL-адреса алгоритмы компьютерного зрения от Майкрософт могут по-разному анализировать визуальное содержимое на основе входных данных и выбора пользователя. С помощью API компьютерного зрения пользователи могут анализировать изображения таким образом:
* [Помечать тегами изображения на основе содержимого.](#Tagging)
* [Классифицировать изображения.](#Categorizing)
* [Определять тип и качество изображений.](#Identifying)
* [Обнаруживать лица людей и возвращать их координаты. ](#Faces)
* [Распознавать содержимое, предназначенное для определенных сфер.](#Domain-Specific)
* [Создавать описания содержимого.](#Descriptions)
* [Использовать распознавание символов для идентификации напечатанного текста, найденного на изображениях.](#OCR)
* [Распознавать рукописный текст.](#RecognizeText)
* [Различать цветовые схемы.](#Color)
* [Помечать содержимое для взрослых.](#Adult)
* [Обрезать фотографии для использования в качестве эскизов.](#Thumbnails)

## <a name="requirements"></a>Требования
* Поддерживаемые методы ввода: двоичный файл изображения в формате RAW в форме приложения/потока октета или URL-адреса изображения.
* Поддерживаемые форматы изображений: JPEG, PNG, GIF, BMP.
* Размер файла изображения: меньше 4 КБ.
* Размер изображения: больше чем 50 x 50 пикселей.

## <a name="tagging-images"></a>Добавление тегов к изображениям
API компьютерного зрения возвращает теги на основе более чем 2000 распознаваемых объектов, живых существ, пейзажей и действий. В случаях, когда теги могут быть неоднозначными или необщеизвестными, в ответ API входят "подсказки", помогающие разъяснить смысл тега на основе известного параметра. Теги не упорядочены по таксономии и не существуют в иерархиях наследования. Коллекция тегов содержимого формирует основу для "описания" изображения, отображаемого на понятном для пользователя языке и отформатированного в полные предложения. Обратите внимание, что на данный момент английский является единственным поддерживаемым языком для описание изображения.

После загрузки изображения или указав его URL-адрес, алгоритмы API компьютерного зрения выводят теги, в зависимости от объектов, живых существ и действий, указанных на изображении. Добавление тегов не ограничивается основным предметом, например человеком на переднем плане, но также включает параметр (внутри помещения или снаружи), мебель, инструменты, растения, животных, аксессуары, гаджеты и т. д.

### <a name="example"></a>Пример
![House_Yard](./Images/house_yard.jpg) '

```json
Returned Json
{
   'tags':[
      {
         "name":"grass",
         "confidence":0.999999761581421
      },
      {
         "name":"outdoor",
         "confidence":0.999970674514771
      },
      {
         "name":"sky",
         "confidence":999289751052856
      },
      {
         "name":"building",
         "confidence":0.996463239192963
      },
      {
         "name":"house",
         "confidence":0.992798030376434
      },
      {
         "name":"lawn",
         "confidence":0.822680294513702
      },
      {
         "name":"green",
         "confidence":0.641222536563873
      },
      {
         "name":"residential",
         "confidence":0.314032256603241
      },
   ],
}
```
## <a name="categorizing-images"></a>Классификация изображений
В дополнение к добавлению тегов и описанию, API компьютерного зрения возвращает основанные на таксономии категории, определенные в предыдущих версиях. Эти категории организованы в виде таксономии с иерархиями родительских и дочерних наследований. Все категории указаны на английском языке. Они могут использоваться отдельно или совместно с нашими новыми моделями.

### <a name="the-86-category-concept"></a>Концепция из 86 категорий
На основе списка из 86 понятий, показанном на схеме ниже, визуальные компоненты, имеющиеся на изображении, можно классифицировать в диапазоне от общих к более конкретным. Полную таксономию в формате текста см. в статье [86-Categories Taxonomy](https://docs.microsoft.com/azure/cognitive-services/computer-vision/category-taxonomy) (Таксономия 86 категорий).

![Анализ категорий](./Images/analyze_categories.jpg)

Образ —                                                  | Ответ
------------------------------------------------------ | ----------------
![Женщина на крыше](./Images/woman_roof.jpg)                 | people
![Семейное фото](./Images/family_photo.jpg)             | people_crowd
![Милая собака](./Images/cute_dog.jpg)                     | animal_dog
![Гора](./Images/mountain_vista.jpg)       | outdoor_mountain
![Анализ изображения. Хлеб](./Images/bread.jpg)       | food_bread

## <a name="identifying-image-types"></a>Определение типов изображений
Классифицировать изображения можно несколькими способами. API компьютерного зрения может установить логический флаг, указывающий, является ли изображение черно-белым или цветным. Может также установить флаг, указывающий, является ли изображение графическим. Может также указать, является ли изображение картинкой, и какого качества по шкале от 0 до 3.

### <a name="clip-art-type"></a>Тип картинка
Определяет, является ли изображение картинкой.  

Значение | Значение
----- | --------------
0     | не картинка
1     | неоднозначно
2     | обычная картинка
3     | хорошая картинка

Образ —|Ответ
----|----
![Анализ изображения. Картинка с сыром](./Images/cheese_clipart.jpg)|3 хорошая картинка
![Анализ изображения. Двор дома](./Images/house_yard.jpg)|0 не картинка

### <a name="line-drawing-type"></a>Тип графического изображения
Определяет, является ли изображение графическим.

Образ —|Ответ
----|----
![Анализ изображения. Рисунок льва](./Images/lion_drawing.jpg)|Истина
![Анализ изображения. Цветок](./Images/flower.jpg)|Ложь

### <a name="faces"></a>Распознавание лиц
Обнаруживает на изображении лица людей и создает их координаты, прямоугольник для лица, пола и возраста. Эти визуальные компоненты представляют собой подмножество метаданных, созданных для лица. Для более расширенных метаданных, созданных для лица (идентификация по лицу, определение позы и многое другое) используйте API распознавания лиц.  

Образ —|Ответ
----|----
![Анализ изображения. Распознавание лица женщины на крыше](./Images/woman_roof_face.png) | [ { "age": 23, "gender": "Female", "faceRectangle": { "left": 1379, "top": 320, "width": 310, "height": 310 } } ]
![Анализ изображения. Распознавание лица мамы и дочки](./Images/mom_daughter_face.png) | [ { "age": 28, "gender": "Female", "faceRectangle": { "left": 447, "top": 195, "width": 162, "height": 162 } }, { "age": 10, "gender": "Male", "faceRectangle": { "left": 355, "top": 87, "width": 143, "height": 143 } } ]
![Анализ изображения. Распознавание лиц на семейном фото](./Images/family_photo_face.png) | [ { "age": 11, "gender": "Male", "faceRectangle": { "left": 113, "top": 314, "width": 222, "height": 222 } }, { "age": 11, "gender": "Female", "faceRectangle": { "left": 1200, "top": 632, "width": 215, "height": 215 } }, { "age": 41, "gender": "Male", "faceRectangle": { "left": 514, "top": 223, "width": 205, "height": 205 } }, { "age": 37, "gender": "Female", "faceRectangle": { "left": 1008, "top": 277, "width": 201, "height": 201 } } ]


## <a name="domain-specific-content"></a>Содержимое, предназначенное для определенных сфер

Кроме добавления тегов и классификации верхнего уровня, API компьютерного зрения также поддерживает специализированные сведения (или предназначенные для определенных сфер). Специализированные сведения могут быть реализованы изолированным методом либо с общей классификацией. Это работает как средство для дальнейшего уточнения 86 категорий таксономии путем добавления моделей, предназначенных для определенных сфер.

В настоящее время поддерживаются только специализированные сведения, ориентированные на распознавания знаменитостей и достопримечательностей. Они имеют усовершенствования для определенных сфер в категориях "Люди", "Группы лиц" и "Мировые достопримечательности".

Есть два варианта использования моделей, предназначенных для определенных сфер:

### <a name="option-one---scoped-analysis"></a>Вариант 1 — ограниченный анализ
Анализ только выбранной модели с помощью вызова HTTP POST. Для этого варианта укажите имя модели, если известно, какую модель нужно использовать, и вы получите сведения соответствующие только этой модели. Например, вы можете использовать этот вариант только для поиска, ориентированного на распознавания знаменитостей. Ответ содержит список потенциально совпадающих знаменитостей вместе с их оценками достоверности.

### <a name="option-two---enhanced-analysis"></a>Вариант 2 — расширенный анализ
Анализ дает дополнительные сведения, относящиеся к категориям из таксономии 86 категорий. Этот вариант доступен для использования в приложениях, где пользователи хотят получить анализ обычного изображения с дополнительными сведениями из одной или нескольких моделей, предназначенных для определенных сфер. При вызове этого метода сначала вызывается классификатор таксономии 86 категорий. Если какие-либо категории соответствуют известным или сопоставленным моделям, следует второй этап вызовов классификатора. Например, если 'details=all' или "details" включает 'celebrities', метод вызывает классификатор знаменитостей после вызова классификатора 86 категорий. Результат содержит теги, начинающиеся с 'people_'.

## <a name="generating-descriptions"></a>Создание описаний 
Алгоритмы API компьютерного зрения анализируют содержимое на изображении. Анализ формирует основу для 'описания', отображаемого на понятном для пользователя языке в полных предложениях. В описании приведена сводка того, что найдено на изображении. Алгоритмы API компьютерного зрения создают различные описания, в зависимости от объектов, определенных на изображении. Каждое описание оценивается и получает оценку достоверности. Затем возвращается список, упорядоченный от наибольшей оценки достоверности к наименьшей. Пример бота, использующего эту технологию для создания подписей к изображениям, можно найти [здесь](https://github.com/Microsoft/BotBuilder-Samples/tree/master/CSharp/intelligence-ImageCaption).  

### <a name="example-description-generation"></a>Пример создания описания
![Черно-белое фото зданий](./Images/bw_buildings.jpg) '
```json
 Returned Json

'description':{
   "captions":[
      {
         "type":"phrase",
         'text':'a black and white photo of a large city',
         'confidence':0.607638706850331
      }
   ]   
   "captions":[
      {
         "type":"phrase",
         'text':'a photo of a large city',
         'confidence':0.577256764264197
      }
   ]   
   "captions":[
      {
         "type":"phrase",
         'text':'a black and white photo of a city',
         'confidence':0.538493271791207
      }
   ]   
   'description':[
      "tags":{
         "outdoor",
         "city",
         "building",
         "photo",
         "large",
      }
   ]
}
```

## <a name="perceiving-color-schemes"></a>Восприятие цветовых схем
Алгоритм компьютерного зрения извлекает цвета с изображения. Затем цвета подвергаются анализу в трех различных контекстах: передний план, фон и общий план. Цвета объединяются в 12 групп, которые соответствуют доминирующим акцентным цветам. Акцентные цвета — черный, синий, коричневый, серый, зеленый, оранжевый, розовый, сиреневый, красный, сине-зеленый, белый и желтый. В зависимости от цвета на изображении, просто черно-белый или акцентные, цвета могут возвращаться в шестнадцатеричном цветовом коде.

Образ —                                                       | Передний план |Фоновый| Цвета
----------------------------------------------------------- | --------- | ------- | ------
![Гора](./Images/mountain_vista.jpg)            | Черный     | Черный   | Белый
![Анализ изображения. Цветок](./Images/flower.jpg)               | Черный     | Белый   | Белый, черный, зеленый
![Анализ изображения. Железнодорожный вокзал](./Images/train_station.jpg) | Черный     | Черный   | Черный

### <a name="accent-color"></a>Акцентный цвет
Цвет, извлеченный с изображения, предназначен для представления пользователям самого впечатляющего цвета через сочетание преобладающих и насыщенных цветов.

Образ —                                                       | Ответ
----------------------------------------------------------- | ----
![Гора](./Images/mountain_vista.jpg)            | #BC6F0F
![Анализ изображения. Цветок](./Images/flower.jpg)               | #CAA501
![Анализ изображения. Железнодорожный вокзал](./Images/train_station.jpg) | #484B83


### <a name="black--white"></a>Черно-белый
Логический флаг, который указывает, является ли изображение черно-белым.

Образ —                                                      | Ответ
---------------------------------------------------------- | ----
![Анализ изображения. Здание](./Images/bw_buildings.jpg)      | Истина
![Анализ изображения. Двор дома](./Images/house_yard.jpg)      | Ложь

## <a name="flagging-adult-content"></a>Обозначение содержимого для взрослых
Среди разных категорий визуальных элементов существует группа материалов для взрослых и носящих непристойный характер, которая способна обнаружить материалы для взрослых и ограничить вывод изображений сексуального характера. Фильтр, определяющий содержимое для взрослых и носящее непристойный характер, можно настроить в соответствии с предпочтением пользователя по степени принятия материалов данного характера.

## <a name="optical-character-recognition-ocr"></a>Оптическое распознавание текста (OCR)
Технология OCR позволяет выявлять текстовое содержимое на изображении и извлекать указанный текст в поток символов, пригодный для машинного чтения. Результат можно использовать для поиска и множества других целей, таких как медицинские записи, безопасность и банковские операции. Язык определяется автоматически. OCR экономит время и обеспечивает удобство для пользователей, позволяя им фотографировать текст, а не записывать его.

OCR поддерживает 25 языков. Вот они: арабский, китайский (упрощенное письмо), китайский (традиционное письмо), чешский, датский, голландский, английский, финский, французский, немецкий, греческий, венгерский, итальянский, японский, корейский, норвежский, польский, португальский, румынский, русский, сербский (кириллица и латиница), словацкий, испанский, шведский и турецкий.

При необходимости OCR исправляет поворот в градусах распознанного текста относительно горизонтальной оси изображения. OCR предоставляет координаты кадра каждого слова, как показано на иллюстрации ниже.

![Обзор OCR](./Images/vision-overview-ocr.png) Требования для OCR:
- Размер входного изображения должен быть от 40 x 40 и до 3200 x 3200 пикселей.
- Изображение не может быть больше, чем 10 мегапикселей.

Входное изображения можно многократно поворачивать на 90 градусов, а также на небольшой угол в пределах 40 градусов.

Точность распознавания текста зависит от качества изображения. Неточное прочтение может быть вызвано следующими ситуациями:
- Размытость изображения.
- Рукописный текст или курсив.
- Художественные стили шрифтов.
- Мелкий размер текста.
- Сложный фон, тени или отблеск поверх текста, или искажение перспективы.
- Слишком большой размер или отсутствие больших букв в начале слов
- Подстрочный, надстрочный или зачеркнутый текст.

Ограничения. На фотографиях, где преобладает текст, может быть ложное срабатывание частично распознанных слов. На некоторых фотографиях, особенно без текста, точность может во многом зависеть от типа изображения.

## <a name="recognize-handwritten-text"></a>Распознавание рукописного текста
Эта технология позволит вам обнаружить и извлечь рукописные тексты из заметок, писем, эссе, настенных досок, форм и т. д. Она используется при работе с различными поверхностями и фоном, например с техническими документами, желтыми записками и настенными досками.

Функция распознавания рукописного текста позволит сэкономить время и усилия, а также повысить продуктивность работы. Вы можете всего лишь сфотографировать изображения с текстом, а не переписывать их. Она дает возможность оцифровывать заметки. Такое цифровое решение позволит реализовать простой и быстрый поиск. Вы также сможете избавиться от ненужных печатных документов.

Требования к входным данным:
- Поддерживаемые форматы изображений: JPEG, PNG и BMP.
- Размер файла изображения должен быть меньше 4 МБ.
- Размеры изображения должно быть от 40 x 40 до 3200 x 3200 пикселей.

Примечание. Сейчас доступна предварительная версия этой технологии. Пока что она может распознавать тексты только на английском языке.

## <a name="generating-thumbnails"></a>Создание эскизов
Эскиз — уменьшенное представление полноразмерного изображения. Различным устройствам, таким как телефоны, планшеты и компьютеры, нужны разные макеты взаимодействия с пользователем (UX) и соответствующие размеры эскизов. Используя интеллектуальную обрезку, этот компонент API компьютерного зрения помогает решить такую проблему.

После загрузки изображения создается эскиз высокого качества и алгоритм API компьютерного зрения анализирует объекты на изображении. Затем он обрезает изображение для соответствия требованиям интересующей области (ROI). Выходные данный отображаются в специальные рамке, как показано на иллюстрации ниже. Для удовлетворения потребностей пользователя созданный эскиз можно пропорционально изменять в размерах.

Алгоритм создания эскиза работает следующим образом:

1. Удаляет ненужные элементы с изображения и распознает основной объект — интересующую область (ROI).
2. Обрезает изображение, исходя из определенной интересующей области.
3. Изменяет пропорции в соответствии с необходимыми размерами эскиза.

![Эскизы](./Images/thumbnail-demo.png)
