---
title: Автоматическое присваивание меток сущностям с помощью сущности списка, используя Node.js | Документация Майкрософт
description: Узнайте, как добавить сущность списка, чтобы помочь LUIS присвоить метки вариантам слов или фраз.
services: cognitive-services
author: diberry
titleSuffix: Azure
manager: cjgronlund
ms.service: cognitive-services
ms.component: language-understanding
ms.topic: article
ms.date: 02/21/2018
ms.author: diberry
ms.openlocfilehash: 12a6cfbe7267d3575fbb33978d7ea6e743802d12
ms.sourcegitcommit: 194789f8a678be2ddca5397137005c53b666e51e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/25/2018
ms.locfileid: "39237168"
---
# <a name="use-a-list-entity-to-increase-entity-detection"></a>Использование сущности списка, чтобы увеличить обнаружение сущностей 
В этом руководстве показано, как использовать [сущность списка](luis-concept-entity-types.md), чтобы увеличить обнаружение сущностей. Сущности списков не обязательно должны быть помечены как они точно соответствуют терминам.  

Из этого руководства вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
* Создавать сущности списка 
* Добавлять нормализованные значения и синонимы
* Проверять идентификацию улучшенной сущности

## <a name="prerequisites"></a>Предварительные требования

> [!div class="checklist"]
> * [Node.js](https://nodejs.org) последней версии
> * [Приложение LUIS HomeAutomation](luis-get-started-create-app.md). Если у вас нет созданного приложения Home Automation, создайте новое приложение и добавьте предварительно подготовленный домен **HomeAutomation**. Обучите и опубликуйте приложение. 
> * [Ключ авторинга](luis-concept-keys.md#authoring-key), [ключ конечной точки](luis-concept-keys.md#endpoint-key) (при многократном запросе), идентификатор приложения, идентификатор версии и [регион](luis-reference-regions.md) для приложения LUIS.

> [!Tip]
> Если у вас еще нет подписки, вы можете зарегистрироваться для получения [бесплатной учетной записи](https://azure.microsoft.com/free/).

Весь код из этого руководства можно найти в [примерах LUIS репозитория GitHub](https://github.com/Microsoft/LUIS-Samples/tree/master/documentation-samples/tutorial-list-entity). 

## <a name="use-homeautomation-app"></a>Использование приложения HomeAutomation
Приложение HomeAutomation позволяет управлять такими устройствами, как освещение, развлекательные системы и контроль параметров окружающей среды, например нагревание и охлаждение. Эти системы имеют несколько разных названий, которые могут включать имена производителей, псевдонимы, аббревиатуры и сленг. 

Одна из систем, которая имеет много названий в разных культурах и народах, — это терморегулятор. Терморегулятор может управлять как охлаждением, так и отоплением дома или здания.

В идеале следующие высказывания должны быть устранены для предварительно подготовленной сущности **HomeAutomation.Device**:

|#|высказывание|определенная сущность|приложения|
|--|--|--|--|
|1|включить кондиционер|HomeAutomation.Device — "кондиционер"|0.8748562|
|2|подать тепло|HomeAutomation.Device — "нагреватель"|0.784990132|
|3|охладить|||

Первые два высказывания относятся к разным устройствам. Третья фраза, "охладить", не относится к устройству, а вместо этого запрашивает результат. LUIS не знает, что термин "холоднее" означает, что терморегулятор является запрошенным устройством. В идеале LUIS должен разрешить все эти высказывания к одному устройству. 

## <a name="use-a-list-entity"></a>Использовать сущность списка
Сущность HomeAutomation.Device отлично подходит для небольшого количества устройств или с небольшим количеством вариантов названий. В офисном здании или кампусе названия устройств находятся за пределами пригодности сущности HomeAutomation.Device. 

**Сущность списка** лучше всего подойдет для этого сценария, потому что набор условий для устройства, которое находится в здании или кампусе, является известным набором, даже если это огромный набор. С помощью сущности списка LUIS может получить любое возможное значение в наборе для терморегулятора и разрешить его только для единственного устройства "терморегулятор". 

В этом руководстве будет создана сущность списка для терморегулятора. В этом руководстве используются следующие альтернативные названия терморегулятора. 

|альтернативные названия терморегулятора|
|--|
| кондиционер |
| система кондиционирования|
| кондиционирование воздуха|
|нагреватель|
|нагрев|
|нагревающее устройство|
|охладительное устройство|
|охладитель|

Если LUIS необходимо часто определять новую альтернативу, то [список фраз](luis-concept-feature.md#how-to-use-phrase-lists) будет лучшим решением.

## <a name="create-a-list-entity"></a>Создание сущности списка
Создайте файл Node.js и скопируйте туда следующий код. Измените значения ключа авторинга, идентификатор приложения, идентификатор версии и региона.

   [!code-javascript[Create DevicesList List Entity](~/samples-luis/documentation-samples/tutorial-list-entity/add-entity-list.js "Create DevicesList List Entity")]

Используйте следующую команду для установки зависимостей NPM и запуска кода для создания сущности списка.

```Javascript
npm install && node add-entity-list.js
```

Результат выполнения — это идентификатор сущности списка.

```Javascript
026e92b3-4834-484f-8608-6114a83b03a6
```
## <a name="train-the-model"></a>Обучение модели
Обучайте LUIS так, чтобы новый список влиял на результаты запроса. Обучение — это двухэтапный процесс: сначала обучение, а затем, если обучение закончено, проверка состояния. Обучение приложения со многими моделями займет несколько минут. Следующий код обучает приложение, а затем ждет, пока обучение завершится успешно. В коде используется стратегия ожидания и повтора, чтобы избежать ошибки 429 "Слишком много запросов". 

Создайте файл Node.js и скопируйте туда следующий код. Измените значения ключа авторинга, идентификатор приложения, идентификатор версии и региона.

   [!code-javascript[Train LUIS](~/samples-luis/documentation-samples/tutorial-list-entity/train.js "Train LUIS")]

Выполните следующую команду для запуска кода для обучения приложения.

```Javascript
node train.js
```

Результат выполнения — статус каждой итерации обучения моделей LUIS. Следующее выполнение требовало только одной проверки обучения.

```Javascript
1 trained = true
[ { modelId: '2c549f95-867a-4189-9c35-44b95c78b70f',
    details: { statusId: 2, status: 'UpToDate', exampleCount: 45 } },
  { modelId: '5530e900-571d-40ec-9c78-63e66b50c7d4',
    details: { statusId: 2, status: 'UpToDate', exampleCount: 45 } },
  { modelId: '519faa39-ae1a-4d98-965c-abff6f743fe6',
    details: { statusId: 2, status: 'UpToDate', exampleCount: 45 } },
  { modelId: '9671a485-36a9-46d5-aacd-b16d05115415',
    details: { statusId: 2, status: 'UpToDate', exampleCount: 45 } },
  { modelId: '9ef7d891-54ab-48bf-8112-c34dcd75d5e2',
    details: { statusId: 2, status: 'UpToDate', exampleCount: 45 } },
  { modelId: '8e16a660-8781-4abf-bf3d-f296ebe1bf2d',
    details: { statusId: 2, status: 'UpToDate', exampleCount: 45 } } ]

```
## <a name="publish-the-model"></a>Публикация модели
Опубликуйте так, чтобы сущность списка была доступна с конечной точки.

Создайте файл Node.js и скопируйте туда следующий код. Измените значения ключа конечной точки, ID приложения и региона. Вы можете использовать ключ авторинга, если не планируется вызывать этот файл за пределы вашей квоты.

   [!code-javascript[Publish LUIS](~/samples-luis/documentation-samples/tutorial-list-entity/publish.js "Publish LUIS")]

Чтобы запросить приложение, выполните следующую команду для запуска кода.

```Javascript
node publish.js
```

Следующий результат содержит URL-адрес конечной точки для любых запросов. Настоящие результаты JSON будут включать действительный идентификатор приложения. 

```JSON
{ 
  versionId: null,
  isStaging: false,
  endpointUrl: 'https://westus.api.cognitive.microsoft.com/luis/v2.0/apps/<appID>',
  region: null,
  assignedEndpointKey: null,
  endpointRegion: 'westus',
  publishedDateTime: '2018-01-29T22:17:38Z' }
}
```

## <a name="query-the-app"></a>Запрос приложения 
Запросите приложение из конечной точки, чтобы доказать, что сущность списка помогает LUIS определить тип устройства.

Создайте файл Node.js и скопируйте туда следующий код. Измените значения ключа конечной точки, ID приложения и региона. Вы можете использовать ключ авторинга, если не планируется вызывать этот файл за пределы вашей квоты.

   [!code-javascript[Query LUIS](~/samples-luis/documentation-samples/tutorial-list-entity/query.js "Query LUIS")]

Выполните следующую команду для запуска кода и запроса приложения.

```Javascript
node train.js
```

Выходные данные — это результаты запроса. Поскольку код добавил в строку запроса **подробную**пару имя/значение, то результат включает все их намерения и оценки.

```JSON
{
  "query": "turn up the heat",
  "topScoringIntent": {
    "intent": "HomeAutomation.TurnOn",
    "score": 0.139018849
  },
  "intents": [
    {
      "intent": "HomeAutomation.TurnOn",
      "score": 0.139018849
    },
    {
      "intent": "None",
      "score": 0.120624863
    },
    {
      "intent": "HomeAutomation.TurnOff",
      "score": 0.06746891
    }
  ],
  "entities": [
    {
      "entity": "heat",
      "type": "HomeAutomation.Device",
      "startIndex": 12,
      "endIndex": 15,
      "score": 0.784990132
    },
    {
      "entity": "heat",
      "type": "DevicesList",
      "startIndex": 12,
      "endIndex": 15,
      "resolution": {
        "values": [
          "Thermostat"
        ]
      }
    }
  ]
}
```

Устройство **терморегулятор** идентифицируется с ориентированным на результат запросом "подать тепло". Поскольку исходная сущность HomeAutomation.Device все еще находится в приложении, ее результаты тоже можно увидеть. 

Попробуйте два других высказывания, чтобы увидеть, что они также возвращаются в качестве терморегулятора. 

|#|высказывание|сущность|Тип|value|
|--|--|--|--|--|
|1|включить кондиционер| кондиционер | DevicesList | Терморегулятор|
|2|подать тепло|тепло| DevicesList |Терморегулятор|
|3|охладить|охладитель|DevicesList|Терморегулятор|

## <a name="next-steps"></a>Дополнительная информация

Можно создать другую сущность списка для расширения расположения устройств в комнатах, этажах или зданиях. 
