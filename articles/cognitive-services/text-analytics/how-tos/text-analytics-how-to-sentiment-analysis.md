---
title: Инструкции по анализу тональности в REST API анализа текста (Microsoft Cognitive Services в Azure) | Документация Майкрософт
description: Инструкции по обнаружению тональности с помощью REST API анализа текста в Microsoft Cognitive Services в Azure в этом пошаговом руководстве.
services: cognitive-services
author: HeidiSteen
manager: cgronlun
ms.service: cognitive-services
ms.component: text-analytics
ms.topic: article
ms.date: 12/11/2017
ms.author: heidist
ms.openlocfilehash: 7ffd8bbe47409b459fdd308cd8d670d32f56649b
ms.sourcegitcommit: 95d9a6acf29405a533db943b1688612980374272
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/23/2018
ms.locfileid: "35380581"
---
# <a name="how-to-detect-sentiment-in-text-analytics"></a>Как определить тональность в службе "Анализ текста"

[API анализа тональности](https://westus.dev.cognitive.microsoft.com/docs/services/TextAnalytics.V2.0/operations/56f30ceeeda5650db055a3c9) вычисляет ввод текста и возвращает оценку тональности для каждого документа в диапазоне от 0 (отрицательное значение) до 1 (положительное значение).

Эта возможность нужна для обнаружения положительных и отрицательных тональностей в социальных сетях, отзывах клиентов и на форумах. Содержимое предоставляете вы, а модели и данные для обучения — служба.

В настоящий момент анализ тональности поддерживает английский, немецкий, испанский и французский языки. Другие языки находятся на этапе предварительной версии. Дополнительные сведения см. в [списке поддерживаемых языков](../text-analytics-supported-languages.md).

## <a name="concepts"></a>Основные понятия

Анализ текста использует алгоритм классификации машинного обучения для создания оценки тональности от 0 до 1. Оценки, близкие к 1, указывают на позитивную тональность, а оценки, близкие к 0, — на негативную. Модель обучена с использованием обширного текста со связями тональности. В настоящее время нет возможности предоставления собственных данных для обучения. Модель использует сочетание техник во время анализа текста, включая обработку текста, анализа частей речи, размещения слов и связи между словами. Дополнительные сведения об алгоритме см. в статье [Introducing Text Analytics in the Azure ML Marketplace](https://blogs.technet.microsoft.com/machinelearning/2015/04/08/introducing-text-analytics-in-the-azure-ml-marketplace/) (Представление Анализа текста в Azure ML Marketplace).

Анализ тональности выполняется по всему документу, в отличие от извлечения тональностей для конкретного объекта в тексте. На практике имеется тенденция повышения оценки точности, когда документы содержат одно или два предложения, а не большой блок текста. На этапе оценки объективности модель определяет, является ли документ в целом объективным или содержит тональности. Документ, который в основном объективен, не продвигается к фразе обнаружения тональности, что приводит к оценке .50, без дальнейшей обработки. Для документов, продолжающих работу в конвейере, следующий этап формирует оценку выше или ниже .50, в зависимости от степени обнаружений тональности в документе.

## <a name="preparation"></a>Подготовка

Анализ тональности дает более качественный результат, когда ему передаются более мелкие блоки текста. Это является противоположностью извлечению ключевой фразы, которая выполняется лучше на более крупных блоках текста. Для получения наилучших результатов обеих операций советуем реструктуризировать входные данные соответствующим образом.

Необходимо иметь документы JSON в следующем формате: "идентификатор","текст","язык"

Документ должен содержать менее 5000 символов и иметь до 1 000 элементов (идентификаторов) в коллекции. Коллекция передается в тексте запроса. Ниже приведен пример содержимого, который вы можете представить для анализа тональности.

```
    {
        "documents": [
            {
                "language": "en",
                "id": "1",
                "text": "We love this trail and make the trip every year. The views are breathtaking and well worth the hike!"
            },
            {
                "language": "en",
                "id": "2",
                "text": "Poorly marked trails! I thought we were goners. Worst hike ever."
            },
            {
                "language": "en",
                "id": "3",
                "text": "Everyone in my family liked the trail but thought it was too challenging for the less athletic among us. Not necessarily recommended for small children."
            },
            {
                "language": "en",
                "id": "4",
                "text": "It was foggy so we missed the spectacular views, but the trail was ok. Worth checking out if you are in the area."
            },                
            {
                "language": "en",
                "id": "5",
                "text": "This is my favorite trail. It has beautiful views and many places to stop and rest"
            }
        ]
    }
```

## <a name="step-1-structure-the-request"></a>Шаг 1. Структурирование запроса

Сведения об определении запроса можно найти в статье [How to call the Text Analytics REST API](text-analytics-how-to-call-api.md) (Способ вызова REST API анализа текста). Для удобства повторим следующие моменты.

+ Создайте запрос **POST**. Изучите документацию по API для этого запроса: [API анализа тональности](https://westus.dev.cognitive.microsoft.com/docs/services/TextAnalytics.V2.0/operations/56f30ceeeda5650db055a3c9)

+ Создайте конечную точку HTTP для извлечения ключевых фраз. Она должна включать ресурс `/sentiment`: `https://westus.api.cognitive.microsoft.com/text/analytics/v2.0/sentiment`

+ Задайте заголовок запроса, чтобы включить ключ доступа для операций Анализа текста. Дополнительные сведения см. в статье [о поиске конечных точек и ключей доступа](text-analytics-how-to-access-key.md).

+ В тексте запроса укажите набор документов JSON, которые подготовлены для этого анализа.

> [!Tip]
> Используйте [Postman](text-analytics-how-to-call-api.md) или откройте **консоль тестирования API** в [документации](https://westus.dev.cognitive.microsoft.com/docs/services/TextAnalytics.V2.0/operations/56f30ceeeda5650db055a3c9), чтобы структурировать запрос и передать его (используя метод POST) в службу.

## <a name="step-2-post-the-request"></a>Шаг 2. Передача запроса

Анализ выполняется при получении запроса. Служба принимает до 100 запросов в минуту. Каждый запрос не должен превышать 1 МБ.

Не забывайте, что эта служба работает без отслеживания состояния. Данные не хранятся в учетной записи. Результаты возвращаются немедленно в ответе.


## <a name="step-3-view-results"></a>Шаг 3. Просмотр результатов

Анализатор тональности позволяет классифицировать текст как преимущественно положительный или отрицательный, назначая оценку в диапазоне от 0 до 1. Значения, близкие к 0,5 — нейтральные или неопределенные. Оценка 0,5 указывает нейтральность. Если строку невозможно проанализировать на определение тональности или у нее нет тональности, показатель всегда является именно 0,5. Например, если передать строку на испанском языке с кодом английского языка, оценка будет 0,5.

Вывод возвращается немедленно. Можно выполнить потоковую передачу результатов в приложение, которое принимает JSON, или сохранить выходные данные в файле локальной системы, а затем импортировать их в приложение, которое дает возможность сортировки, поиска данных и управления ими.

В следующем примере показан ответ для коллекции документов в этой статье.

```
{
    "documents": [
        {
            "score": 0.9999237060546875,
            "id": "1"
        },
        {
            "score": 0.0000540316104888916,
            "id": "2"
        },
        {
            "score": 0.99990355968475342,
            "id": "3"
        },
        {
            "score": 0.980544924736023,
            "id": "4"
        },
        {
            "score": 0.99996328353881836,
            "id": "5"
        }
    ],
    "errors": []
}
```

## <a name="summary"></a>Сводка

В этой статье рассматриваются основные понятия и рабочий процесс анализа тональности в службе Анализ текста Cognitive Services. В разделе "Сводка" сделайте следующее.

+ [API анализа тональности](https://westus.dev.cognitive.microsoft.com/docs/services/TextAnalytics.V2.0/operations/56f30ceeeda5650db055a3c9) доступен для некоторых языков.
+ В тексте запроса передаются документы JSON, которые содержат идентификатор, текст и код языка.
+ Запрос POST передается в конечную точку `/sentiment`, используя личный [ключ доступа и конечную точку](text-analytics-how-to-access-key.md), допустимые для вашей подписки.
+ Выходные данные ответа, состоящие из оценки тональности для каждого идентификатора документа, могут передаваться в любое приложение, принимающее JSON, включая Excel и Power BI (лишь некоторые из них).

## <a name="see-also"></a>См. также 

 [Text Analytics overview](../overview.md) (Общие сведения об анализе текста)  
 [Часто задаваемые вопросы](../text-analytics-resource-faq.md)</br>
 [Анализ текста](//go.microsoft.com/fwlink/?LinkID=759712) 

## <a name="next-steps"></a>Дополнительная информация

> [!div class="nextstepaction"]
> [Извлечение ключевых фраз](text-analytics-how-to-keyword-extraction.md)
