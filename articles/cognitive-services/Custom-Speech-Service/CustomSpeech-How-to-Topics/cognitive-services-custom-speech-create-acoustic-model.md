---
title: Руководство по созданию акустической модели с помощью Пользовательской службы распознавания речи в Microsoft Cognitive Services | Документация Майкрософт
description: Из этого руководства вы узнаете, как создать акустическую модель с помощью Пользовательской службы распознавания речи в Microsoft Cognitive Services.
services: cognitive-services
author: PanosPeriorellis
manager: onano
ms.service: cognitive-services
ms.component: custom-speech
ms.topic: tutorial
ms.date: 05/03/2017
ms.author: panosper
ROBOTS: NOINDEX
ms.openlocfilehash: 60fea175e8dffeefeb9cb3ecaadad5d8fc7caeb9
ms.sourcegitcommit: 32d218f5bd74f1cd106f4248115985df631d0a8c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2018
ms.locfileid: "46971549"
---
# <a name="tutorial-create-a-custom-acoustic-model"></a>Учебник. Создание пользовательской акустической модели

В рамках этого руководства вы создадите пользовательскую акустическую модель для данных речи, которые приложение должно распознать. Пользовательская акустическая модель полезна в тех случаях, когда ваше приложение разработано для особых условий применения, например на шумном производстве, или предназначено для определенной категории пользователей.

Из этого руководства вы узнаете, как выполнять следующие задачи:
> [!div class="checklist"]
> * Подготовка данных
> * Импорт набора акустических данных
> * Создание пользовательской акустической модели

Если у вас еще нет учетной записи Cognitive Services, создайте [бесплатную учетную запись](https://cris.ai), а затем приступайте к работе.

## <a name="prerequisites"></a>Предварительные требования

Подключите учетную запись Cognitive Services к подписке. Для этого откройте страницу [подписок Cognitive Services](https://cris.ai/Subscriptions).

Если подписки не указаны, вы можете создать учетную запись с помощью Cognitive Services, нажав кнопку **Get free subscription** (Получить бесплатную подписку). Можно также подключиться к подписке пользовательской службы поиска, созданной на портале Azure, нажав кнопку **Connect existing subscription** (Подключиться к имеющейся подписке).

Дополнительные сведения о создании подписки пользовательской службы поиска на портале Azure см. в статье о [создании учетной записи API Cognitive Services на портале Azure](../../cognitive-services-apis-create-account.md).

## <a name="prepare-the-data"></a>Подготовка данных

Чтобы настроить акустическую модель для определенной области, требуется получить коллекцию данных речи. Эта коллекция состоит из набора звуковых файлов с данными речи и текстового файла, который содержит расшифровку каждого звукового файла. Представленные звуковые данные должны соответствовать сценарию, в котором планируется использовать систему распознавания речи.

Например: 

*   Если вы хотите оптимизировать распознавание речи в шумных производственных условиях, звуковые файлы должны содержать речь людей, записанных на фоне соответствующего шума.
<a name="Preparing data to customize the acoustic model"></a>
*   Если вы хотите улучшить распознавание речи конкретного человека, например хотите транскрибировать запись цикла передач с одним ведущим, звуковые файлы должны содержать примеры речи только этого человека.

Набор акустических данных для настройки акустической модели состоит из двух частей: (1) набор звуковых файлов, содержащих данные для распознавания речи, и (2) файл с транскрипцией всех звуковых файлов.

### <a name="audio-data-recommendations"></a>Рекомендации по подготовке звуковых данных

*   Все звуковые файлы должны храниться в формате WAV (RIFF).
*   Файл должен иметь частоту дискретизации 8 кГц или 16 кГц. Значения сэмплов должны храниться в формате 16-разрядных целых чисел PCM со знаком без сжатия (короткие).
*   Поддерживаются только одноканальные (монофонические) звуковые файлы.
*   Звуковой файл должен иметь длину от 100 мс до 1 минуты. В идеале в начале и конце каждого звукового файла должен присутствовать период молчания длительностью около 100 мс, а длительность самого файла должна быть от 500 мс до 1 с.
*   Если данные содержат фоновый шум, также рекомендуется добавить в них несколько образцов с более продолжительными фрагментами тишины (например, несколько секунд) до и (или) после речи.
*   Каждый звуковой файл должен содержать одну фразу, например одно предложение из выступления, один вопрос или одно действие диалоговой системы.
*   Каждый звуковой файл в наборе данных должен иметь уникальное имя и расширение .wav.
*   Набор звуковых файлов должен располагаться в одной папке без подкаталогов. Весь набор должен быть упакован в один архивный ZIP-файл.

> [!NOTE]
> Максимальный размер набора акустических данных ограничен 2 ГБ (ограничение на импорт данных через веб-портал). Это соответствует примерно 17 часам звука при частоте дискретизации 16 кГц или 34 часам записи при частоте дискретизации 8 кГц. Основные требования к звуковым данным описываются в следующей таблице.
>

| Свойство | Значение |
|---------- |----------|
| Формат файла | RIFF (WAV) |
| Частота дискретизации | 8000 или 16 000 Гц |
| Каналы | 1 (моно) |
| Формат выборки | PCM, 16-разрядные целые числа |
| Продолжительность файла | От 0,1 с до 60 с |
| Период тишины | > 0,1 с |
| Формат архива | ZIP |
| Максимальный размер архива | 2 ГБ |

### <a name="transcriptions"></a>Расшифровки

Транскрипции всех WAV-файлов должны содержаться в одном текстовом файле. Каждая строка файла транскрипции должна содержать имя звукового файла и соответствующую ему транскрипцию. Для разделения имени файла и транскрипции необходимо использовать символ табуляции (\t).

  Например: 
```
  speech01.wav  speech recognition is awesome

  speech02.wav  the quick brown fox jumped all over the place

  speech03.wav  the lazy dog was not amused
```

Текст транскрипции нормализуется для эффективной обработки системой. Однако есть некоторые важные действия нормализации, которые пользователь должен выполнять _перед_ отправкой данных в пользовательскую службу распознавания речи. При подготовке транскрипций следуйте [руководству по транскрибированию](cognitive-services-custom-speech-transcription-guidelines.md) для соответствующего языка.

Дальнейшие действия выполняются на [портале Пользовательской службы распознавания речи](https://cris.ai). 

## <a name="import-the-acoustic-data-set"></a>Импорт набора акустических данных

После подготовки звуковых файлов и транскрипций их можно импортировать на веб-портал службы.

Сначала выполните вход на [портал Пользовательской службы распознавания речи](https://cris.ai). Затем щелкните вкладку раскрывающегося меню "Настраиваемое распознавание речи" в верхней ленте и выберите "Adaptation Data" (Данные адаптации). Если вы впервые передаете данные в пользовательскую службу распознавания речи, вы увидите пустую таблицу с именем "Наборы данных". 

Нажмите кнопку "Импорт" в строке акустических наборов данных, и на сайте появится страница для отправки нового набора данных.

![попробуйте выполнить следующее](../../../media/cognitive-services/custom-speech-service/custom-speech-acoustic-datasets-import.png)

Введите _имя_ и _описание_ в соответствующие текстовые поля. Это рекомендуется сделать, чтобы было удобно отслеживать передаваемые наборы данных. Затем с помощью кнопок "Choose File" (Выбрать файл) в разделах "Transcription File" (Файл транскрипции) и "WAV files" (WAV-файлы) выберите соответственно текстовый файл транскрипции и ZIP-файл архива или отдельные WAV-файлы. После завершения нажмите кнопку "Import" (Импорт), чтобы отправить данные. Данные будут отправлены на портал. Отправка крупных наборов данных может занимать несколько минут.

После завершения операции импорта вы вернетесь в таблицу наборов акустических данных и увидите запись, соответствующую вашему набору акустических данных. Обратите внимание, что ему был присвоен уникальный идентификатор (GUID). Данные также будут включать статус, отражающий их текущее состояние. Этим состоянием будет "Ожидание", если данные ставятся в очередь для обработки, "Идет обработка", если выполняется проверка, и "Выполнено", когда данные можно использовать.

При проверке данных проверяются формат, продолжительность и частота дискретизации звуковых файлов, а также формат файлов транскрипции. Кроме того, для транскрипции выполняются некоторые операции по нормализации текста.

Если отображается состояние "Выполнено", вы можете просмотреть отчет о проверке акустических данных, щелкнув "Сведения". Отобразится количество успешных и неудачных проверок, а также сведения о фразах, завершившихся сбоем. В приведенном ниже примере проверка двух WAV-файлов завершилась сбоем из-за неверного формата звуковых данных (в одном случае неправильная частота дискретизации, а в другом — неправильный формат файла).

![попробуйте выполнить следующее](../../../media/cognitive-services/custom-speech-service/custom-speech-acoustic-datasets-report.png)

Если вам необходимо изменить имя или описание набора данных, щелкните ссылку "Изменить" и внесите соответствующие изменения. Обратите внимание, что изменять звуковые файлы и транскрипцию нельзя.

## <a name="create-a-custom-acoustic-model"></a>Создание пользовательской акустической модели

Если набор акустических данных имеет состояние "Выполнено", его можно использовать для создания пользовательской акустической модели. Для этого щелкните "Акустические модели" в раскрывающемся меню "Настраиваемое распознавание речи". Появится таблица "Ваши модели" со списком всех пользовательских акустических моделей. При первом запуске эта таблица будет пустой. Текущий языковой стандарт отображается в заголовке таблицы. В настоящее время акустические модели можно создавать только для английского языка (США).

Чтобы создать новую модель, щелкните ссылку "Создать" под заголовком таблицы. Как и ранее, введите имя и описание, чтобы определить эту модель в будущем. Например, в поле "Описание" можно указать, на основе каких модели и набора акустических данных была создана эта модель. Затем в раскрывающемся меню выберите базовую акустическую модель. Базовая модель выступает в качестве отправной точки для настройки. Вы можете выбрать из двух базовых акустических моделей. _Акустическая модель поиска и диктовки Майкрософт_ подходит для речи, направленной в приложение, например команд, поисковых запросов или диктовки. _Разговорная акустическая модель_ Майкрософт подходит для распознавания речи при общении. Этот тип речи обычно направлен на другого человека и встречается в колл-центрах или на встречах. Обратите внимание, что разговорная модель характеризуется большей задержкой для частичных результатов по сравнению с моделями поиска и диктовки.

Далее в раскрывающемся списке выберите акустические данные, на основе которых будет выполняться настройка.

![попробуйте выполнить следующее](../../../media/cognitive-services/custom-speech-service/custom-speech-acoustic-models-create2.png)

После завершения обработки вы можете провести тестирование новой модели в автономном режиме. В этом случае будет выполнена оценка эффективности преобразования речи в текст для указанного набора акустических данных с использованием пользовательской акустической модели. По результатам оценки будет подготовлен отчет. Чтобы выполнить проверку, установите флажок "Accuracy Testing" (Тестирование на точность). Затем в раскрывающемся меню выберите языковую модель. Если пользовательская языковая модель не была создана, в раскрывающемся списке будут представлены только базовые языковые модели. Для выбора наиболее подходящей базовой языковой модели ознакомьтесь с их [описанием](cognitive-services-custom-speech-create-language-model.md) в руководстве.

Наконец, выберите набор акустических данных, который вы хотите использовать для оценки пользовательской модели. Если вы выполняете тестирование на точность, важно выбрать набор акустических данных, отличный от использованного при создании модели. Это позволит более реалистично оценить эффективность модели. Обратите внимание, что объем тестирования в автономном режиме ограничен 1000 фразами. Если набор акустических данных имеет больший размер, для оценки будут использоваться первые 1000 фраз.

Если все готово к запуску процесса настройки, щелкните "Create" (Создать).

В таблице акустических моделей появится новая запись, соответствующая этой модели. В таблице будет отражено состояние процесса. Возможны состояния "Ожидание", "Идет обработка" и "Выполнено".

![попробуйте выполнить следующее](../../../media/cognitive-services/custom-speech-service/custom-speech-acoustic-models-creating.png)

## <a name="next-steps"></a>Дополнительная информация

В рамках этого руководства вы разработали пользовательскую акустическую модель для использования с звуковыми файлами и расшифровками. Чтобы создать пользовательский языковой файл для использования с текстовыми файлами, перейдите к руководству по созданию пользовательской языковой модели.

> [!div class="nextstepaction"]
> [Руководство по созданию пользовательской акустической модели](cognitive-services-custom-speech-create-language-model.md)
