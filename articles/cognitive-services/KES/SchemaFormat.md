---
title: Формат схемы в API службы поиска и распознавания данных | Документация Майкрософт
description: Сведения о формате схемы в API службы поиска и распознавания данных (KES) в Cognitive Services.
services: cognitive-services
author: bojunehsu
manager: stesp
ms.service: cognitive-services
ms.component: knowledge-exploration
ms.topic: article
ms.date: 03/26/2016
ms.author: paulhsu
ms.openlocfilehash: 3009392a5acb12a8f4df3d30a2cbe5e74f2172fc
ms.sourcegitcommit: 95d9a6acf29405a533db943b1688612980374272
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/23/2018
ms.locfileid: "35380241"
---
# <a name="schema-format"></a>Формат схемы
Схема указывается в JSON-файле, описывающем структуру атрибутов объектов в файле данных, используемом для создания индекса.  Для каждого атрибута в схеме указываются имя, тип данных, дополнительные операции и дополнительный список синонимов.  У каждого атрибута объекта может иметь 0 или больше значений.  Ниже приведен упрощенный пример из области научных публикаций.

``` json
{
  "attributes":[
    {"name":"Title", "type":"String"},
    {"name":"Year", "type":"Int32"},
    {"name":"Author", "type":"Composite"},
    {"name":"Author.Id", "type":"Int64", "operations":["equals"]},
    {"name":"Author.Name", "type":"String"},
    {"name":"Author.Affiliation", "type":"String"},
    {"name":"Keyword", "type":"String", "synonyms":"Keyword.syn"}
  ]
}
```

Имена атрибутов — это идентификаторы с учетом регистра, которые начинаются с буквы и содержат только буквы (A-Z), цифры (0-9) и символ подчеркивания (\_).  Зарезервированный атрибут logprob используется для указания относительных вероятностей на основе натурального логарифма для объектов.

## <a name="attribute-type"></a>Тип атрибута
Ниже приведен список поддерживаемых типов данных атрибутов.

| type | ОПИСАНИЕ | Операции | Пример |
|------|-------------|------------|---------|
| Строка | Строка (1–1024 знака) | equals, starts_with | "hello world" |
| Int32 | 32-разрядное целое число со знаком | equals, starts_with, is_between | 2016 |
| Int64 | 64-разрядное целое число со знаком | equals, starts_with, is_between | 9 876 543 210 |
| Double | Значение двойной точности с плавающей запятой | equals, starts_with, is_between | 1,602e-19 |
| Дата | Дата (с 01.01.1400 до 31.12.9999) | equals, is_between | '2016-03-14' |
| Guid | Глобальный уникальный идентификатор | equals (равно) | "602DD052-CC47-4B23-A16A-26B52D30C05B" |
| BLOB-объект | Сжатые внутри службы неиндексированные данные | *None* | "Empower every person and every organization on the planet to achieve more" |
| Составной | Сочетание нескольких вложенных атрибутов| *Н/Д* | { "Name":"harry shum", "Affiliation":"microsoft" } |

Строковые атрибуты используются для представления строковых значений, которые могут входить в запрос пользователя.  Они поддерживают операцию точного соответствия *equals*, а также операцию *starts_with* для сценариев автозавершения запросов (например, "micros" соответствует "microsoft").  Возможности нечеткого соответствия и поиска без учета регистра для обработки орфографических ошибок будут поддерживаться в будущих выпусках.

Атрибуты типа Int32, Int64 и Double используются для представления числовых значений.  Операция *is_between* позволяет вычислять неравенства (lt, le, gt, ge) во время выполнения.  Операция *starts_with* позволяет использовать автозавершение при выполнении запроса (например, заменяя "20" на "2016" или "3," на "3,14").

Атрибуты даты используются для эффективного кодирования значений даты.  Операция *is_between* позволяет вычислять неравенства (lt, le, gt, ge) во время выполнения.
  
Атрибуты GUID используются для эффективного представления значений GUID и по умолчанию поддерживают операцию *equals*.

Атрибуты больших двоичных объектов используются для эффективного кодирования потенциально крупных больших двоичных объектов для осуществления поиска из соответствующего объекта во время выполнения, без поддержки каких-либо операций индексирования, на основе содержимого значений большого двоичного объекта.

### <a name="composite-attributes"></a>Составные атрибуты
Составные атрибуты используются для представления групп значений атрибутов.  Имя каждого вложенного атрибута начинается с имени составного атрибута, за которым следует точка ".".  Значения составных атрибутов задаются в виде объекта JSON, содержащего значения вложенных атрибутов.  Составные атрибуты могут иметь несколько значений объекта.  Однако составные атрибуты не могут содержать вложенные составные атрибуты.

В приведенном выше примере для научных публикаций это позволяет службе выполнить запрос для поиска документов Гарри Шама (Harry Shum) за период, когда он работал в корпорации Майкрософт.  Без составных атрибутов служба может запрашивать только документы, одним из авторов которых является Гарри Шам (Harry Shum) и при этом один из авторов работает в корпорации Майкрософт.  Дополнительные сведения см. в статье о [составных запросах](SemanticInterpretation.md#composite-function).

## <a name="attribute-operations"></a>Операции с атрибутами
По умолчанию каждый атрибут индексируется для поддержки всех операций, доступных для типа данных атрибута.  Если какая-либо конкретная операция не требуется, можно явно указать набор индексированных операций, чтобы уменьшить размер индекса.  В следующем фрагменте кода из примера схемы, приведенного выше, атрибут Author.Id индексируется для поддержки только операции *equals*, но не дополнительных операций *starts_with* и *is_between* для атрибутов Int32.
```json
{"name":"Author.Id", "type":"Int32", "operations":["equals"]}
```

Если атрибут указывается в грамматике, в схеме нужно указать операцию *starts_with*, чтобы служба смогла создать варианты завершения на основе частичных запросов.  

## <a name="attribute-synonyms"></a>Синонимы атрибутов
Часто требуется указать определенное значение строкового атрибута с помощью синонима.  Например, пользователи могут указывать "Microsoft" как "MSFT" или "MS".  В таких случаях в определении атрибута можно указать имя файла схемы, расположенного в том же каталоге, что и файл схемы.  Каждая строка в файле синонимов представляет запись синонима в следующем формате JSON: `["<canonical>", "<synonym>"]`.  В примере схемы AuthorName.syn — это JSON-файл, содержащий значения синонимов атрибута Author.Name.

`{"name":"Author.Name", "type":"String", "synonyms":"AuthorName.syn"}`


Каноническое значение может иметь несколько синонимов.  У нескольких канонических значений может быть общий синоним.  В таких случаях служба будет разрешать неоднозначность с помощью нескольких интерпретаций.  Ниже приведен пример файла синонимов AuthorName.syn, который соответствует приведенной выше схеме.
```json
["harry shum","heung-yeung shum"]
["harry shum","h shum"]
["henry shum","h shum"]
...
```
