---
title: Создание и просмотр оповещений метрик, а также управление ими с помощью Azure Monitor
description: Узнайте, как с помощью портала Azure или CLI создавать, просматривать оповещения метрик, а также управлять ими.
author: snehithm
ms.service: azure-monitor
ms.topic: conceptual
ms.date: 09/18/2018
ms.author: snmuvva
ms.component: alerts
ms.openlocfilehash: 6ac31818a68aa2b4624410b423b7559b84275777
ms.sourcegitcommit: b7e5bbbabc21df9fe93b4c18cc825920a0ab6fab
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2018
ms.locfileid: "47409377"
---
# <a name="create-view-and-manage-metric-alerts-using-azure-monitor"></a>Создание и просмотр оповещений метрик, а также управление ими с помощью Azure Monitor

Оповещения метрик в Azure Monitor позволяют получать уведомления, когда одна из ваших метрик достигает порогового значения. Оповещения метрик работают со множеством многомерных метрик платформы, пользовательских метрик, стандартных и пользовательских метрик Application Insights. В этой статье мы расскажем, как создавать, просматривать правила генерации оповещений метрик и управлять ими на портале Azure и с помощью Azure CLI. Вы также можете создавать правила генерации оповещений метрик с использованием шаблонов Azure Resource Manager, описанных в [отдельной статье](monitoring-enable-alerts-using-template.md).

Подробнее о том, как работают оповещения метрик, см. в [этом обзоре](alert-metric-overview.md).

## <a name="create-with-azure-portal"></a>Создание с помощью портала Azure

Следующая процедура описывает, как создать правило генерации оповещений метрики на портале Azure:

1. На [портале Azure](https://portal.azure.com) выберите **Монитор**. В колонке "Монитор" объединены все параметры мониторинга и данные в одном представлении.

2. Щелкните **Оповещения** и выберите **+ Новое правило генерации оповещений**.

    > [!TIP]
    > В большинстве колонок ресурсов в меню ресурсов также есть **оповещения** в разделе **Мониторинг**, и вы также можете создать оповещения там.

3. Щелкните **Выбор цели**, в загружаемой контекстной области выберите целевой ресурс, который вы хотите изменить. В раскрывающихся списках **Подписка** и **Тип ресурса** найдите ресурс, который вы хотите отслеживать. Вы также можете найти ресурс с помощью панели поиска.

4. Если выбранный ресурс имеет метрики, по которым можно создавать оповещения, эти метрики будут отображаться на вкладке **Available signals** (Доступные сигналы) в правом нижнем углу. Полный список типов ресурсов, поддерживаемых для оповещений метрик, см. в этой [статье](monitoring-near-real-time-metric-alerts.md#metrics-and-dimensions-supported).

5. После выбора целевого ресурса щелкните **Add criteria** (Добавить критерии).

6. Вы увидите список сигналов, поддерживаемых для ресурса, и сможете выбрать метрику, для которой хотите создать оповещение.

7. Вы увидите график метрики за последние 6 часов. Задайте **период**, **частоту**, **оператор** и **порог**. Это определит логику, которую будет оценивать правило генерации оповещений метрики.

8. Используя диаграмму метрик, вы можете определить, какой порог будет разумным.

9. Кроме того, если для метрики имеются измерения, вы увидите таблицу измерений. Выберите одно или несколько значений для каждого измерения. Оповещение метрики будет выполнять оценку условия для всех сочетаний выбранных значений. [Дополнительные сведения о том, как срабатывают оповещения на основе многомерных метрик](alert-metric-overview.md). Вы также можете **выбрать \*** для любого из измерений. Если **выбрать \***, выбор всех текущих и будущих значений измерений будет динамически масштабироваться.

10. Нажмите кнопку **Done** (Готово).

11. При необходимости добавьте еще один критерий, если вы хотите отслеживать сложное правило генерации оповещений.

12. Заполните **сведения об оповещении**, такие как **имя правила генерации оповещений**, **описание** и **серьезность**.

13. Добавьте группу действий в оповещение: выберите имеющуюся или создайте группу действий.

14. Нажмите кнопку **Готово** для сохранения правила генерации оповещений метрики.

> [!NOTE]
> Правила генерации оповещений метрики, созданные на портале, создаются в той же группе ресурсов, что и целевой ресурс.

## <a name="view-and-manage-with-azure-portal"></a>Просмотр и управление с помощью портала Azure

Вы можете просматривать правила генерации оповещений метрики и управлять ими, используя колонку "Управление правилами" в разделе "Оповещения". В приведенной ниже процедуре показано, как просмотреть свои правила генерации оповещений метрики и изменить одно из них.

1. На портале Azure выберите **Монитор**.

2. Щелкните **Оповещения**, а затем **Управление правилами**.

3. В колонке **Управление правилами** вы можете просмотреть все правила генерации оповещений по подпискам. Вы можете дополнительно фильтровать правила, используя **группу ресурсов**, **тип ресурса** и **ресурс**. Если вы хотите видеть только оповещения метрики, выберите метрику в качестве **типа сигнала**.

    > [!TIP]
    > В колонке **Управление правилами** вы можете выбрать несколько правил генерации оповещений и включить или отключить их. Это может быть полезно, когда необходимо выполнить обслуживание определенных целевых ресурсов.

4. Щелкните имя правила генерации оповещений метрики, которое вы хотите изменить.

5. На вкладке "Изменить правило" щелкните **критерии предупреждения**, которые вы хотите отредактировать. Вы можете изменить метрику, порог и другие поля по мере необходимости.

    > [!NOTE]
    > Нельзя изменить **целевой ресурс** и **имя правила генерации оповещений** после создания оповещения метрики.

6. Нажмите кнопку **Готово**, чтобы сохранить изменения.

## <a name="with-azure-cli"></a>С помощью Azure CLI

В предыдущих разделах описаны создание, просмотр правил генерации оповещений метрики и управление ими с помощью портала Azure. В этом разделе вы узнаете, как сделать то же самое с помощью кроссплатформенного [Azure CLI](https://docs.microsoft.com/en-us/cli/azure/get-started-with-azure-cli?view=azure-cli-latest). Самый быстрый способ начать использование Azure CLI — это [Azure Cloud Shell](https://docs.microsoft.com/en-us/azure/cloud-shell/overview?view=azure-cli-latest). В этой статье мы будем использовать Cloud Shell.

1. Перейдите на портал Azure и щелкните **Cloud Shell**.

2. В командной строке вы можете использовать команды с параметром ``--help``, чтобы узнать больше о команде и о том, как ее использовать. Например, следующая команда показывает вам список команд, доступных для создания, просмотра оповещений метрики и управления ими.

    ```azurecli
    az monitor metrics alert --help
    ```

3. Вы можете создать простое правило генерации оповещений метрики, которое срабатывает, если средняя загрузка ЦП на виртуальной машине превышает 70 %.

    ```azurecli
    az monitor metrics alert create -n {nameofthealert} -g {ResourceGroup} --scopes {VirtualMachineResourceID} --condition "avg Percentage CPU > 90"
    ```

4. Вы можете просмотреть все оповещения метрики в группе ресурсов, используя следующую команду.

    ```azurecli
    az monitor metrics alert list  -g {ResourceGroup}
    ```

5. Вы можете увидеть подробности определенного правила генерации оповещений метрики, используя имя или идентификатор ресурса правила.

    ```azurecli
    az monitor metrics alert show -g {ResourceGroup} -n {AlertRuleName}
    ```

    ```azurecli
    az monitor metrics alert show --ids {RuleResourceId}
    ```

6. Вы можете отключить правило генерации оповещений, используя следующую команду.

    ```azurecli
    az monitor metrics alert update -g {ResourceGroup} -n {AlertRuleName} -enabled false
    ```

7. Вы можете удалить правило генерации оповещений метрики, используя следующую команду.

    ```azurecli
    az monitor metrics alert update -g {ResourceGroup} -n {AlertRuleName} -enabled false
    ```

## <a name="next-steps"></a>Дополнительная информация

- [Создание классического оповещения метрики с помощью шаблона Resource Manager](monitoring-enable-alerts-using-template.md).
- [Сведения о работе оповещений метрики в Azure Monitor](alert-metric-overview.md).
- [Схема полезных данных](monitoring-near-real-time-metric-alerts.md#payload-schema)
