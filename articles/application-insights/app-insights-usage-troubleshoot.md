---
title: Устранение неполадок со средствами для анализа поведения пользователей в Azure Application Insights
description: Руководство по устранению неполадок. Анализ использования сайта и приложения с помощью Application Insights.
services: application-insights
documentationcenter: ''
author: mrbullwinkle
manager: carmonm
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: multiple
ms.topic: conceptual
ms.date: 07/11/2018
ms.reviewer: daviste
ms.author: mbullwin
ms.openlocfilehash: 725f67af8178c6c851999d18c771ebdd360d6d01
ms.sourcegitcommit: df50934d52b0b227d7d796e2522f1fd7c6393478
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/12/2018
ms.locfileid: "38992373"
---
# <a name="troubleshoot-user-behavior-analytics-tools-in-application-insights"></a>Устранение неполадок со средствами для анализа поведения пользователей в Application Insights
Возникли вопросы о [средствах для анализа поведения пользователей в Application Insights](app-insights-usage-overview.md), касающиеся [пользователей, сеансов, событий](app-insights-usage-segmentation.md), [воронок](usage-funnels.md), [маршрутов пользователей](app-insights-usage-flows.md), [периода удержания](app-insights-usage-retention.md) или когорт? Ниже приведен ряд ответов.

## <a name="counting-users"></a>Подсчет пользователей
**Средства для анализа поведения пользователей показывают, что в моем приложении есть один пользователь или сеанс, но я знаю, что в нем их множество. Как исправить неправильный подсчет?**

Все события телеметрии в Application Insights имеют уникальные [идентификатор анонимного пользователя](application-insights-data-model-context.md) и [идентификатор сеанса](application-insights-data-model-context.md) в качестве двух стандартных свойств. По умолчанию все инструменты аналитики потребления подсчитывают пользователей и сеансы на основе этих идентификаторов. Если стандартные свойства не были заполнены уникальными идентификаторами для каждого пользователя и сеанса приложения, в инструментах аналитики потребления отобразится неправильное количество пользователей и сеансов.

При мониторинге веб-приложения проще всего добавить [пакет SDK JavaScript Application Insights](app-insights-javascript.md) в приложение и убедиться, что фрагмент кода сценария загружен на каждую страницу, которую требуется отслеживать. Пакет SDK JavaScript автоматически создает идентификаторы для анонимного пользователя и сеанса, а затем заполняет события телеметрии этими идентификаторами, когда они отправляются из приложения.

При мониторинге веб-службы (без интерфейса пользователя) [создайте инициализатор телеметрии, который заполняет свойства идентификатора анонимного пользователя и идентификатора сеанса](app-insights-usage-send-user-context.md) согласно основным понятиям службы об уникальных пользователях и сеансах.

Если приложение отправляет [идентификаторы аутентифицированных пользователей](app-insights-api-custom-events-metrics.md#authenticated-users), подсчет можно выполнять в инструменте "Пользователи". В раскрывающемся списке "Показать" выберите Authenticated users (Аутентифицированные пользователи).

Средства для анализа поведения пользователей сейчас не поддерживают какой-либо подсчет пользователей или сеансов на основе свойств, кроме идентификатора анонимного пользователя, идентификатора аутентифицированного пользователя или идентификатора сеанса.

## <a name="naming-events"></a>Именование событий
**В моем приложении содержатся тысячи различных представлений страниц и пользовательских имен событий. Их трудно различать, и средства для анализа поведения пользователей часто перестают отвечать на запросы. Как устранить проблемы именования?**

Представления страниц и имена пользовательских событий используются с помощью средств для анализа поведения пользователей. Оптимальное именование событий имеет решающее значение при получении выгоды от этих инструментов. Целью является баланс между немногочисленными и слишком универсальными именами ("Щелчок кнопки") и многочисленными и очень специфичными ("На сайте http://www.contoso.com/index щелкнули кнопку «Изменить»").

Чтобы внести изменения в представление страницы и в имена пользовательских событий, которые отправляет приложение, необходимо изменить исходный код приложения и повторно развернуть его. **Все данные телеметрии в Application Insights хранятся в течение 90 дней и не могут быть удалены**, поэтому внесенные изменения в именах событий появятся через 90 дней. В течение 90 дней после внесения изменений имени в телеметрии отображаются как старые, так и новые имена событий, поэтому настраивайте запросы и взаимодействуйте внутри команд соответствующим образом.

Если приложение отправляет слишком много имен представлений страницы, проверьте, были ли эти имена указаны в коде вручную или отправлены автоматически пакетом SDK JavaScript Application Insights:

* Если имена представлений страницы определены в коде вручную с помощью [`trackPageView`API](https://github.com/Microsoft/ApplicationInsights-JS/blob/master/API-reference.md), измените имя на более общее. Избегайте распространенных ошибок, например, помещения URL-адреса в имя представления страницы. Вместо этого используйте параметр URL-адреса API `trackPageView`. Переместите другие данные из имени представления страницы в пользовательские свойства.

* Если пакет SDK JavaScript Application Insights автоматически отправляет имена представления страниц, вы можете изменить заголовки страниц или переключиться на отправку имен представлений страниц вручную. Пакет SDK отправляет [заголовок](https://developer.mozilla.org/docs/Web/HTML/Element/title) каждой страницы в качестве имени представления страницы по умолчанию. Вы можете изменить свои заголовки на более общие, но помните об оптимизации для поисковых систем и других изменениях, к которым это приведет. Вручную назначайте имена представления страниц с помощью API `trackPageView`, переопределяющего автоматически собранные имена, чтобы вы могли отправлять более универсальные имена в телеметрию без изменения заголовка.   

Если приложение отправляет слишком много имен пользовательских событий, измените имя в коде на более общее. Опять же, избегайте добавления URL-адресов и другой постраничной и динамической информации в имена настраиваемых событий напрямую. Вместо этого переместите эти данные в пользовательские свойства настраиваемого события с помощью API `trackEvent`. Например, вместо `appInsights.trackEvent("Edit button clicked on http://www.contoso.com/index")` можно использовать `appInsights.trackEvent("Edit button clicked", { "Source URL": "http://www.contoso.com/index" })`.

## <a name="next-steps"></a>Дополнительная информация

* [Обзор использования средств для анализа поведения пользователей](app-insights-usage-overview.md)

## <a name="get-help"></a>Получение справки
* [Переполнение стека](http://stackoverflow.com/questions/tagged/ms-application-insights)

